!STARTOFREGISTRYGENERATEDFILE './AeroDyn_Types.f90'
!
! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
! FAST Registry (v2.05.00, 14-Jan-2015)
!*********************************************************************************************************************************
! AeroDyn_Types
!.................................................................................................................................
! This file is part of AeroDyn.
!
! Copyright (C) 2012-2015 National Renewable Energy Laboratory
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE AeroDyn_Types
! This module contains all of the user-defined types needed in AeroDyn. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE IfW_FFWind_Types
USE IfW_HHWind_Types
USE Lidar_Types
USE InflowWind_Types
USE DWM_Types
USE NWTC_Library
IMPLICIT NONE
! =========  Marker  =======
  TYPE, PUBLIC :: Marker
    REAL(ReKi) , DIMENSION(1:3)  :: Position 
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orientation 
    REAL(ReKi) , DIMENSION(1:3)  :: TranslationVel 
    REAL(ReKi) , DIMENSION(1:3)  :: RotationVel 
  END TYPE Marker
! =======================
! =========  AeroConfig  =======
  TYPE, PUBLIC :: AeroConfig
    TYPE(Marker) , DIMENSION(:), ALLOCATABLE  :: Blade 
    TYPE(Marker)  :: Hub 
    TYPE(Marker)  :: RotorFurl 
    TYPE(Marker)  :: Nacelle 
    TYPE(Marker)  :: TailFin 
    TYPE(Marker)  :: Tower 
    TYPE(Marker)  :: SubStructure 
    TYPE(Marker)  :: Foundation 
    REAL(ReKi)  :: BladeLength 
  END TYPE AeroConfig
! =======================
! =========  AirFoil  =======
  TYPE, PUBLIC :: AirFoil
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CD 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CM 
    REAL(ReKi)  :: PMC 
    REAL(ReKi)  :: MulTabLoc 
  END TYPE AirFoil
! =======================
! =========  AirFoilParms  =======
  TYPE, PUBLIC :: AirFoilParms
    INTEGER(IntKi)  :: MaxTable = 20 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTables 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NLift 
    INTEGER(IntKi)  :: NumCL 
    INTEGER(IntKi)  :: NumFoil 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NFoil 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabMet 
    CHARACTER(1024) , DIMENSION(:), ALLOCATABLE  :: FoilNm 
  END TYPE AirFoilParms
! =======================
! =========  Beddoes  =======
  TYPE, PUBLIC :: Beddoes
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE1 
    REAL(ReKi)  :: AN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOL 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: BEDSEP 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: OLDSEP 
    REAL(ReKi)  :: CC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CDO 
    REAL(ReKi)  :: CMI 
    REAL(ReKi)  :: CMQ 
    REAL(ReKi)  :: CN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNA 
    REAL(ReKi)  :: CNCP 
    REAL(ReKi)  :: CNIQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNSL 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP1 
    REAL(ReKi)  :: DS 
    REAL(ReKi)  :: FK 
    REAL(ReKi)  :: FP 
    REAL(ReKi)  :: FPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTB 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTBC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDCNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDTAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDXN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDYN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: XN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: YN 
    LOGICAL  :: SHIFT 
    LOGICAL  :: VOR 
  END TYPE Beddoes
! =======================
! =========  BeddoesParms  =======
  TYPE, PUBLIC :: BeddoesParms
    REAL(ReKi)  :: AS      ! Speed of sound for mach num calc [-]
    REAL(ReKi)  :: TF      ! Time constant applied to loc of separation pt [-]
    REAL(ReKi)  :: TP      ! Time constant for pressure lag [-]
    REAL(ReKi)  :: TV      ! Time constant for strength and shed of vortex [-]
    REAL(ReKi)  :: TVL      ! Nondim time of transit of vort moving across airfoil surf [-]
  END TYPE BeddoesParms
! =======================
! =========  BladeParms  =======
  TYPE, PUBLIC :: BladeParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: C      ! Chord of each blade element from input file [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DR      ! Span-wise width of elem (len of elem ctred at RELM(i) [-]
    REAL(ReKi)  :: R      ! Rotor radius [-]
    REAL(ReKi)  :: BladeLength      ! Blade Length [-]
  END TYPE BladeParms
! =======================
! =========  DynInflow  =======
  TYPE, PUBLIC :: DynInflow
    REAL(ReKi) , DIMENSION(1:6,1:4)  :: dAlph_dt 
    REAL(ReKi) , DIMENSION(3:6,1:4)  :: dBeta_dt 
    REAL(ReKi)  :: DTO 
    REAL(ReKi) , DIMENSION(1:6)  :: old_Alph 
    REAL(ReKi) , DIMENSION(3:6)  :: old_Beta 
    REAL(ReKi)  :: old_LmdM 
    REAL(ReKi)  :: oldKai 
    REAL(ReKi) , DIMENSION(1:6)  :: PhiLqC 
    REAL(ReKi) , DIMENSION(3:6)  :: PhiLqS 
    REAL(ReKi)  :: Pzero 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMC_SAVE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMS_SAVE 
    REAL(ReKi)  :: TipSpeed 
    REAL(ReKi)  :: totalInf 
    REAL(ReKi)  :: Vparam 
    REAL(ReKi)  :: Vtotal 
    REAL(ReKi) , DIMENSION(1:6)  :: xAlpha 
    REAL(ReKi) , DIMENSION(3:6)  :: xBeta 
    REAL(ReKi)  :: xKai 
    REAL(ReKi)  :: XLAMBDA_M 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: xLcos 
    REAL(ReKi) , DIMENSION(3:6,3:6)  :: xLsin 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminusR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MplusR 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: GAMMA 
  END TYPE DynInflow
! =======================
! =========  DynInflowParms  =======
  TYPE, PUBLIC :: DynInflowParms
    INTEGER(IntKi)  :: MAXINFLO = 2 
    REAL(ReKi) , DIMENSION(1:6)  :: xMinv 
  END TYPE DynInflowParms
! =======================
! =========  Element  =======
  TYPE, PUBLIC :: Element
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: A 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ALPHA 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: W2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_A_NS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_AP_NS 
    REAL(ReKi)  :: PITNOW 
  END TYPE Element
! =======================
! =========  ElementParms  =======
  TYPE, PUBLIC :: ElementParms
    INTEGER(IntKi)  :: NELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TWIST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HLCNST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TLCNST 
  END TYPE ElementParms
! =======================
! =========  ElOutParms  =======
  TYPE, PUBLIC :: ElOutParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAP 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ALF 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CDD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CLL 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CNN 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CTT 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFNSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFTSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DynPres 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PITSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ReyNum 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVY 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVZ 
    REAL(ReKi)  :: VXSAV 
    REAL(ReKi)  :: VYSAV 
    REAL(ReKi)  :: VZSAV 
    INTEGER(IntKi)  :: NumWndElOut      ! Number of Blade Elements [-]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrNum 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    INTEGER(IntKi)  :: NumElOut      ! Number of Blade Elements [-]
  END TYPE ElOutParms
! =======================
! =========  InducedVel  =======
  TYPE, PUBLIC :: InducedVel
    REAL(ReKi)  :: SumInFl = 0 
  END TYPE InducedVel
! =======================
! =========  InducedVelParms  =======
  TYPE, PUBLIC :: InducedVelParms
    REAL(ReKi)  :: AToler      ! Convergence tolerance for induction factor [-]
    REAL(ReKi)  :: EqAIDmult      ! Multiplier for drag term in axial-induction equation. [-]
    LOGICAL  :: EquilDA      ! False unless DB or DA appended to EQUIL [-]
    LOGICAL  :: EquilDT      ! False unless DB or DT appended to EQUIL [-]
    LOGICAL  :: TLoss      ! Tip-loss model (EQUIL only) [PRANDtl, GTECH, or NONE] [-]
    LOGICAL  :: GTech      ! Tip-loss model (EQUIL only) [PRANDtl, GTECH, or NONE] [-]
    LOGICAL  :: HLoss      ! Hub-loss model (EQUIL only) [PRANDtl or NONE] [-]
  END TYPE InducedVelParms
! =======================
! =========  Rotor  =======
  TYPE, PUBLIC :: Rotor
    REAL(ReKi)  :: AVGINFL      ! average induced velocity at the previous time [-]
    REAL(ReKi)  :: CTILT 
    REAL(ReKi)  :: CYaw 
    REAL(ReKi)  :: REVS 
    REAL(ReKi)  :: STILT 
    REAL(ReKi)  :: SYaw 
    REAL(ReKi)  :: TILT 
    REAL(ReKi)  :: YawAng 
    REAL(ReKi)  :: YawVEL 
  END TYPE Rotor
! =======================
! =========  RotorParms  =======
  TYPE, PUBLIC :: RotorParms
    REAL(ReKi)  :: HH 
  END TYPE RotorParms
! =======================
! =========  TwrPropsParms  =======
  TYPE, PUBLIC :: TwrPropsParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrHtFr 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrWid 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrCD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrRe 
    REAL(ReKi) , DIMENSION(1:3)  :: VTwr 
    REAL(ReKi)  :: Tower_Wake_Constant 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTwrCDCol      ! The tower CD column that represents a particular twr ht [-]
    INTEGER(IntKi)  :: NTwrHT      ! The number of tower height rows in the table [-]
    INTEGER(IntKi)  :: NTwrRe      ! The number of tower Re entry rows in the table [-]
    INTEGER(IntKi)  :: NTwrCD      ! The number of tower CD columns in the table [-]
    LOGICAL  :: TwrPotent      ! Tower influence model [-]
    LOGICAL  :: TwrShadow      ! Tower shadow model [-]
    REAL(ReKi)  :: ShadHWid      ! Tower-shadow half width [m]
    REAL(ReKi)  :: TShadC1      ! Tower-shadow constant [-]
    REAL(ReKi)  :: TShadC2      ! Tower-shadow constant [-]
    REAL(ReKi)  :: TwrShad      ! Tower-shadow velocity deficit [-]
    LOGICAL  :: PJM_Version      ! Only true if new tower influence model, by PJM [-]
    CHARACTER(1024)  :: TwrFile      ! Tower data file name [-]
    REAL(ReKi)  :: T_Shad_Refpt      ! Tower-shadow reference point [m]
    LOGICAL  :: CalcTwrAero      ! Flag to tell AeroDyn to calculate drag on the tower [m]
    INTEGER(IntKi)  :: NumTwrNodes      ! Number of ElastoDyn tower nodes.  Tower drag will be computed at those points. [-]
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrNodeWidth      ! The width (diameter) of the tower at the ElastoDyn node locations. [-]
  END TYPE TwrPropsParms
! =======================
! =========  Wind  =======
  TYPE, PUBLIC :: Wind
    REAL(ReKi)  :: ANGFLW 
    REAL(ReKi)  :: CDEL 
    REAL(ReKi)  :: VROTORX 
    REAL(ReKi)  :: VROTORY 
    REAL(ReKi)  :: VROTORZ 
    REAL(ReKi)  :: SDEL 
  END TYPE Wind
! =======================
! =========  WindParms  =======
  TYPE, PUBLIC :: WindParms
    REAL(ReKi)  :: Rho      ! Air density [kg/m&3]
    REAL(ReKi)  :: KinVisc      ! Kinematic air viscosity [(m^2/sec)]
  END TYPE WindParms
! =======================
! =========  PositionType  =======
  TYPE, PUBLIC :: PositionType
    REAL(ReKi) , DIMENSION(1:3)  :: Pos      ! X,Y,Z coordinate of a point [-]
  END TYPE PositionType
! =======================
! =========  OrientationType  =======
  TYPE, PUBLIC :: OrientationType
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orient      ! Direction Cosine Matrix [-]
  END TYPE OrientationType
! =======================
! =========  AD_InitInputType  =======
  TYPE, PUBLIC :: AD_InitInputType
    CHARACTER(1024)  :: Title      ! Title [-]
    CHARACTER(1024)  :: OutRootName 
    CHARACTER(1024)  :: ADFileName      ! AeroDyn file name [-]
    CHARACTER(1024)  :: WindFileName      ! Inflow init file name [-]
    LOGICAL  :: WrSumFile      ! T/F: Write an AeroDyn summary [-]
    INTEGER(IntKi)  :: NumBl      ! Number of Blades [-]
    REAL(ReKi)  :: BladeLength      ! Blade Length [-]
    LOGICAL  :: LinearizeFlag 
    LOGICAL  :: UseDWM = .FALSE.      ! flag to determine if DWM module should be used [-]
    TYPE(AeroConfig)  :: TurbineComponents 
    INTEGER(IntKi)  :: NumTwrNodes      ! Number of ElastoDyn tower nodes.  Tower drag will be computed at those points. [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrNodeLocs      ! Location of ElastoDyn tower nodes with respect to the inertial origin. [-]
    TYPE(IfW_InitInputType)  :: IfW_InitInputs 
    TYPE(DWM_InitInputType)  :: DWM_InitInputs 
  END TYPE AD_InitInputType
! =======================
! =========  AD_InitOutputType  =======
  TYPE, PUBLIC :: AD_InitOutputType
    TYPE(ProgDesc)  :: Ver      ! version information [-]
    TYPE(IfW_InitOutputType)  :: IfW_InitOutput 
    TYPE(DWM_InitOutputType)  :: DWM_InitOutput 
  END TYPE AD_InitOutputType
! =======================
! =========  AD_ContinuousStateType  =======
  TYPE, PUBLIC :: AD_ContinuousStateType
    TYPE(IfW_ContinuousStateType)  :: IfW_ContStates 
    TYPE(DWM_ContinuousStateType)  :: DWM_ContStates 
  END TYPE AD_ContinuousStateType
! =======================
! =========  AD_DiscreteStateType  =======
  TYPE, PUBLIC :: AD_DiscreteStateType
    TYPE(IfW_DiscreteStateType)  :: IfW_DiscStates 
    TYPE(DWM_DiscreteStateType)  :: DWM_DiscStates 
  END TYPE AD_DiscreteStateType
! =======================
! =========  AD_ConstraintStateType  =======
  TYPE, PUBLIC :: AD_ConstraintStateType
    TYPE(IfW_ConstraintStateType)  :: IfW_ConstrStates 
    TYPE(DWM_ConstraintStateType)  :: DWM_ConstrStates 
  END TYPE AD_ConstraintStateType
! =======================
! =========  AD_OtherStateType  =======
  TYPE, PUBLIC :: AD_OtherStateType
    REAL(DbKi)  :: DT      ! Time step [seconds]
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    REAL(DbKi)  :: OldTime 
    REAL(ReKi)  :: HubLoss = 1 
    REAL(ReKi)  :: Loss = 1 
    REAL(ReKi)  :: TipLoss = 1 
    REAL(ReKi)  :: TLpt7 
    LOGICAL  :: FirstPassGTL = .TRUE. 
    LOGICAL  :: SuperSonic = .FALSE. 
    LOGICAL  :: AFLAGVinderr = .FALSE. 
    LOGICAL  :: AFLAGTwrInflu = .FALSE. 
    LOGICAL  :: OnePassDynDbg = .TRUE. 
    LOGICAL  :: NoLoadsCalculated = .TRUE. 
    INTEGER(IntKi)  :: NERRORS = 0 
    TYPE(IfW_OtherStateType)  :: IfW_OtherStates 
    TYPE(DWM_OtherStateType)  :: DWM_OtherStates 
    TYPE(AirFoil)  :: AirFoil 
    TYPE(Beddoes)  :: Beddoes 
    TYPE(DynInflow)  :: DynInflow 
    TYPE(Element)  :: Element 
    TYPE(Rotor)  :: Rotor 
    TYPE(Wind)  :: Wind 
    TYPE(InducedVel)  :: InducedVel 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredForces 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredMoments 
    LOGICAL  :: FirstWarn      ! If it's the first warning about AeroDyn not recalculating loads [-]
    TYPE(ElOutParms)  :: ElOut 
    LOGICAL  :: Skew 
    LOGICAL  :: DynInit      ! FALSE=EQUIL, TRUE=DYNIN [-]
    TYPE(IfW_InputType)  :: IfW_Inputs      ! inputs to IfW module; set here so we don't have to recreate it every time [-]
    TYPE(DWM_InputType)  :: DWM_Inputs 
  END TYPE AD_OtherStateType
! =======================
! =========  AD_ParameterType  =======
  TYPE, PUBLIC :: AD_ParameterType
    CHARACTER(1024)  :: Title      ! Title [-]
    CHARACTER(1024)  :: WindFileName      ! Inflow init file name [-]
    LOGICAL  :: SIUnit 
    LOGICAL  :: Echo = .FALSE. 
    LOGICAL  :: MultiTab 
    LOGICAL  :: LinearizeFlag 
    LOGICAL  :: OutputPlottingInfo = .FALSE. 
    LOGICAL  :: Initialized = .FALSE. 
    LOGICAL  :: UseDWM = .FALSE.      ! flag to determine if DWM module should be used [-]
    REAL(ReKi)  :: TwoPiNB      ! 2*pi/num of blades [-]
    INTEGER(IntKi)  :: NumBl      ! Number of Blades [-]
    INTEGER(IntKi)  :: NBlInpSt      ! Number of Blade Input Stations [-]
    LOGICAL  :: ElemPrn 
    LOGICAL  :: DStall      ! FALSE=Steady, TRUE=BEDDOES [-]
    LOGICAL  :: PMoment      ! FALSE=NO_CM, TRUE=USE_CM [-]
    LOGICAL  :: Reynolds 
    LOGICAL  :: DynInfl      ! FALSE=EQUIL, TRUE=DYNIN [-]
    LOGICAL  :: Wake      ! False unless WAKE or SWIRL [-]
    LOGICAL  :: Swirl      ! False unless WAKE or SWIRL [-]
    REAL(DbKi)  :: DtAero      ! Time interval for aerodynamic calculations [-]
    REAL(ReKi)  :: HubRad      ! Hub radius [m]
    INTEGER(IntKi)  :: UnEc = -1 
    INTEGER(IntKi)  :: UnElem = -1 
    INTEGER(IntKi)  :: UnWndOut = -1 
    INTEGER(IntKi)  :: MAXICOUNT = 1000 
    LOGICAL  :: WrOptFile = .TRUE.      ! T/F: Write an AeroDyn summary [-]
    INTEGER(IntKi)  :: DEFAULT_Wind = -1 
    TYPE(AirFoilParms)  :: AirFoil 
    TYPE(BladeParms)  :: Blade 
    TYPE(BeddoesParms)  :: Beddoes 
    TYPE(DynInflowParms)  :: DynInflow 
    TYPE(ElementParms)  :: Element 
    TYPE(TwrPropsParms)  :: TwrProps 
    TYPE(InducedVelParms)  :: InducedVel 
    TYPE(WindParms)  :: Wind 
    TYPE(RotorParms)  :: Rotor 
    TYPE(IfW_ParameterType)  :: IfW_Params 
    TYPE(DWM_ParameterType)  :: DWM_Params 
  END TYPE AD_ParameterType
! =======================
! =========  AD_InputType  =======
  TYPE, PUBLIC :: AD_InputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: InputMarkers      ! Input Forces and positions for the blades (mesh) for each blade [-]
    TYPE(MeshType)  :: Twr_InputMarkers      ! Input Forces and positions for the tower (mesh) [-]
    TYPE(AeroConfig)  :: TurbineComponents      ! Current locations of components [-]
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabLoc 
  END TYPE AD_InputType
! =======================
! =========  AD_OutputType  =======
  TYPE, PUBLIC :: AD_OutputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: OutputLoads      ! Output Loads (mesh) for each blade [-]
    TYPE(MeshType)  :: Twr_OutputLoads      ! Tower Output Loads (mesh) [-]
    TYPE(IfW_OutputType)  :: IfW_Outputs 
    TYPE(DWM_OutputType)  :: DWM_Outputs 
  END TYPE AD_OutputType
! =======================
CONTAINS
 SUBROUTINE AD_CopyMarker( SrcMarkerData, DstMarkerData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Marker), INTENT(IN) :: SrcMarkerData
   TYPE(Marker), INTENT(INOUT) :: DstMarkerData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstMarkerData%Position = SrcMarkerData%Position
   DstMarkerData%Orientation = SrcMarkerData%Orientation
   DstMarkerData%TranslationVel = SrcMarkerData%TranslationVel
   DstMarkerData%RotationVel = SrcMarkerData%RotationVel
 END SUBROUTINE AD_CopyMarker

 SUBROUTINE AD_DestroyMarker( MarkerData, ErrStat, ErrMsg )
  TYPE(Marker), INTENT(INOUT) :: MarkerData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyMarker

 SUBROUTINE AD_PackMarker( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Marker),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Position )  ! Position 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orientation )  ! Orientation 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TranslationVel )  ! TranslationVel 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RotationVel )  ! RotationVel 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Position))-1 ) =  PACK(InData%Position ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Position)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orientation))-1 ) =  PACK(InData%Orientation ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orientation)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TranslationVel))-1 ) =  PACK(InData%TranslationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TranslationVel)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RotationVel))-1 ) =  PACK(InData%RotationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RotationVel)
 END SUBROUTINE AD_PackMarker

 SUBROUTINE AD_UnPackMarker( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Marker), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Position,1)))
  mask1 = .TRUE.
  OutData%Position = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Position))-1 ),mask1,OutData%Position)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Position)
  ALLOCATE(mask2(SIZE(OutData%Orientation,1),SIZE(OutData%Orientation,2)))
  mask2 = .TRUE.
  OutData%Orientation = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orientation))-1 ),mask2,OutData%Orientation)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orientation)
  ALLOCATE(mask1(SIZE(OutData%TranslationVel,1)))
  mask1 = .TRUE.
  OutData%TranslationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TranslationVel))-1 ),mask1,OutData%TranslationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TranslationVel)
  ALLOCATE(mask1(SIZE(OutData%RotationVel,1)))
  mask1 = .TRUE.
  OutData%RotationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RotationVel))-1 ),mask1,OutData%RotationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RotationVel)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackMarker

 SUBROUTINE AD_CopyAeroConfig( SrcAeroConfigData, DstAeroConfigData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AeroConfig), INTENT(IN) :: SrcAeroConfigData
   TYPE(AeroConfig), INTENT(INOUT) :: DstAeroConfigData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcAeroConfigData%Blade)) THEN
   i1_l = LBOUND(SrcAeroConfigData%Blade,1)
   i1_u = UBOUND(SrcAeroConfigData%Blade,1)
   IF (.NOT. ALLOCATED(DstAeroConfigData%Blade)) THEN 
      ALLOCATE(DstAeroConfigData%Blade(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAeroConfigData%Blade.', ErrStat, ErrMsg,'AD_CopyAeroConfig')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcAeroConfigData%Blade,1), UBOUND(SrcAeroConfigData%Blade,1)
      CALL AD_Copymarker( SrcAeroConfigData%Blade(i1), DstAeroConfigData%Blade(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Blade(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
      CALL AD_Copymarker( SrcAeroConfigData%Hub, DstAeroConfigData%Hub, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Hub')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%RotorFurl, DstAeroConfigData%RotorFurl, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:RotorFurl')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Nacelle, DstAeroConfigData%Nacelle, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Nacelle')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%TailFin, DstAeroConfigData%TailFin, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:TailFin')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Tower, DstAeroConfigData%Tower, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Tower')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%SubStructure, DstAeroConfigData%SubStructure, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:SubStructure')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copymarker( SrcAeroConfigData%Foundation, DstAeroConfigData%Foundation, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyAeroConfig:Foundation')
         IF (ErrStat>=AbortErrLev) RETURN
   DstAeroConfigData%BladeLength = SrcAeroConfigData%BladeLength
 END SUBROUTINE AD_CopyAeroConfig

 SUBROUTINE AD_DestroyAeroConfig( AeroConfigData, ErrStat, ErrMsg )
  TYPE(AeroConfig), INTENT(INOUT) :: AeroConfigData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AeroConfigData%Blade)) THEN
DO i1 = LBOUND(AeroConfigData%Blade,1), UBOUND(AeroConfigData%Blade,1)
  CALL AD_Destroymarker( AeroConfigData%Blade(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(AeroConfigData%Blade)
ENDIF
  CALL AD_Destroymarker( AeroConfigData%Hub, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%RotorFurl, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Nacelle, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%TailFin, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Tower, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%SubStructure, ErrStat, ErrMsg )
  CALL AD_Destroymarker( AeroConfigData%Foundation, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyAeroConfig

 SUBROUTINE AD_PackAeroConfig( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AeroConfig),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Foundation_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Db_Hub_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Int_Hub_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Hub_Buf ) ! Hub
  IF(ALLOCATED(Re_Hub_Buf))  DEALLOCATE(Re_Hub_Buf)
  IF(ALLOCATED(Db_Hub_Buf))  DEALLOCATE(Db_Hub_Buf)
  IF(ALLOCATED(Int_Hub_Buf)) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Db_RotorFurl_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Int_RotorFurl_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RotorFurl_Buf ) ! RotorFurl
  IF(ALLOCATED(Re_RotorFurl_Buf))  DEALLOCATE(Re_RotorFurl_Buf)
  IF(ALLOCATED(Db_RotorFurl_Buf))  DEALLOCATE(Db_RotorFurl_Buf)
  IF(ALLOCATED(Int_RotorFurl_Buf)) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Db_Nacelle_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Int_Nacelle_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Nacelle_Buf ) ! Nacelle
  IF(ALLOCATED(Re_Nacelle_Buf))  DEALLOCATE(Re_Nacelle_Buf)
  IF(ALLOCATED(Db_Nacelle_Buf))  DEALLOCATE(Db_Nacelle_Buf)
  IF(ALLOCATED(Int_Nacelle_Buf)) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Db_TailFin_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Int_TailFin_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TailFin_Buf ) ! TailFin
  IF(ALLOCATED(Re_TailFin_Buf))  DEALLOCATE(Re_TailFin_Buf)
  IF(ALLOCATED(Db_TailFin_Buf))  DEALLOCATE(Db_TailFin_Buf)
  IF(ALLOCATED(Int_TailFin_Buf)) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Db_Tower_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Int_Tower_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Tower_Buf ) ! Tower
  IF(ALLOCATED(Re_Tower_Buf))  DEALLOCATE(Re_Tower_Buf)
  IF(ALLOCATED(Db_Tower_Buf))  DEALLOCATE(Db_Tower_Buf)
  IF(ALLOCATED(Int_Tower_Buf)) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Db_SubStructure_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Int_SubStructure_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SubStructure_Buf ) ! SubStructure
  IF(ALLOCATED(Re_SubStructure_Buf))  DEALLOCATE(Re_SubStructure_Buf)
  IF(ALLOCATED(Db_SubStructure_Buf))  DEALLOCATE(Db_SubStructure_Buf)
  IF(ALLOCATED(Int_SubStructure_Buf)) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Db_Foundation_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Int_Foundation_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Foundation_Buf ) ! Foundation
  IF(ALLOCATED(Re_Foundation_Buf))  DEALLOCATE(Re_Foundation_Buf)
  IF(ALLOCATED(Db_Foundation_Buf))  DEALLOCATE(Db_Foundation_Buf)
  IF(ALLOCATED(Int_Foundation_Buf)) DEALLOCATE(Int_Foundation_Buf)
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, OnlySize ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 ) = Re_Hub_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 ) = Db_Hub_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 ) = Int_Hub_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  IF( ALLOCATED(Re_Hub_Buf) )  DEALLOCATE(Re_Hub_Buf)
  IF( ALLOCATED(Db_Hub_Buf) )  DEALLOCATE(Db_Hub_Buf)
  IF( ALLOCATED(Int_Hub_Buf) ) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, OnlySize ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 ) = Re_RotorFurl_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 ) = Db_RotorFurl_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 ) = Int_RotorFurl_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  IF( ALLOCATED(Re_RotorFurl_Buf) )  DEALLOCATE(Re_RotorFurl_Buf)
  IF( ALLOCATED(Db_RotorFurl_Buf) )  DEALLOCATE(Db_RotorFurl_Buf)
  IF( ALLOCATED(Int_RotorFurl_Buf) ) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, OnlySize ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 ) = Re_Nacelle_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 ) = Db_Nacelle_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 ) = Int_Nacelle_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  IF( ALLOCATED(Re_Nacelle_Buf) )  DEALLOCATE(Re_Nacelle_Buf)
  IF( ALLOCATED(Db_Nacelle_Buf) )  DEALLOCATE(Db_Nacelle_Buf)
  IF( ALLOCATED(Int_Nacelle_Buf) ) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, OnlySize ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 ) = Re_TailFin_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 ) = Db_TailFin_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 ) = Int_TailFin_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  IF( ALLOCATED(Re_TailFin_Buf) )  DEALLOCATE(Re_TailFin_Buf)
  IF( ALLOCATED(Db_TailFin_Buf) )  DEALLOCATE(Db_TailFin_Buf)
  IF( ALLOCATED(Int_TailFin_Buf) ) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, OnlySize ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 ) = Re_Tower_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 ) = Db_Tower_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 ) = Int_Tower_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  IF( ALLOCATED(Re_Tower_Buf) )  DEALLOCATE(Re_Tower_Buf)
  IF( ALLOCATED(Db_Tower_Buf) )  DEALLOCATE(Db_Tower_Buf)
  IF( ALLOCATED(Int_Tower_Buf) ) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, OnlySize ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 ) = Re_SubStructure_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 ) = Db_SubStructure_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 ) = Int_SubStructure_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  IF( ALLOCATED(Re_SubStructure_Buf) )  DEALLOCATE(Re_SubStructure_Buf)
  IF( ALLOCATED(Db_SubStructure_Buf) )  DEALLOCATE(Db_SubStructure_Buf)
  IF( ALLOCATED(Int_SubStructure_Buf) ) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, OnlySize ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 ) = Re_Foundation_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 ) = Db_Foundation_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 ) = Int_Foundation_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  IF( ALLOCATED(Re_Foundation_Buf) )  DEALLOCATE(Re_Foundation_Buf)
  IF( ALLOCATED(Db_Foundation_Buf) )  DEALLOCATE(Db_Foundation_Buf)
  IF( ALLOCATED(Int_Foundation_Buf) ) DEALLOCATE(Int_Foundation_Buf)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackAeroConfig

 SUBROUTINE AD_UnPackAeroConfig( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AeroConfig), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Foundation_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%Blade,1), UBOUND(OutData%Blade,1)
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg ) ! Blade 
ENDDO
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    Re_Hub_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    Db_Hub_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    Int_Hub_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg ) ! Hub 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    Re_RotorFurl_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    Db_RotorFurl_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    Int_RotorFurl_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg ) ! RotorFurl 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    Re_Nacelle_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    Db_Nacelle_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    Int_Nacelle_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg ) ! Nacelle 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    Re_TailFin_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    Db_TailFin_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    Int_TailFin_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg ) ! TailFin 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    Re_Tower_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    Db_Tower_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    Int_Tower_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg ) ! Tower 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    Re_SubStructure_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    Db_SubStructure_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    Int_SubStructure_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg ) ! SubStructure 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    Re_Foundation_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    Db_Foundation_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    Int_Foundation_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg ) ! Foundation 
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAeroConfig

 SUBROUTINE AD_CopyAirFoil( SrcAirFoilData, DstAirFoilData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AirFoil), INTENT(IN) :: SrcAirFoilData
   TYPE(AirFoil), INTENT(INOUT) :: DstAirFoilData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcAirFoilData%AL)) THEN
   i1_l = LBOUND(SrcAirFoilData%AL,1)
   i1_u = UBOUND(SrcAirFoilData%AL,1)
   i2_l = LBOUND(SrcAirFoilData%AL,2)
   i2_u = UBOUND(SrcAirFoilData%AL,2)
   IF (.NOT. ALLOCATED(DstAirFoilData%AL)) THEN 
      ALLOCATE(DstAirFoilData%AL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%AL.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%AL = SrcAirFoilData%AL
ENDIF
IF (ALLOCATED(SrcAirFoilData%CD)) THEN
   i1_l = LBOUND(SrcAirFoilData%CD,1)
   i1_u = UBOUND(SrcAirFoilData%CD,1)
   i2_l = LBOUND(SrcAirFoilData%CD,2)
   i2_u = UBOUND(SrcAirFoilData%CD,2)
   i3_l = LBOUND(SrcAirFoilData%CD,3)
   i3_u = UBOUND(SrcAirFoilData%CD,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CD)) THEN 
      ALLOCATE(DstAirFoilData%CD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CD.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CD = SrcAirFoilData%CD
ENDIF
IF (ALLOCATED(SrcAirFoilData%CL)) THEN
   i1_l = LBOUND(SrcAirFoilData%CL,1)
   i1_u = UBOUND(SrcAirFoilData%CL,1)
   i2_l = LBOUND(SrcAirFoilData%CL,2)
   i2_u = UBOUND(SrcAirFoilData%CL,2)
   i3_l = LBOUND(SrcAirFoilData%CL,3)
   i3_u = UBOUND(SrcAirFoilData%CL,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CL)) THEN 
      ALLOCATE(DstAirFoilData%CL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CL.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CL = SrcAirFoilData%CL
ENDIF
IF (ALLOCATED(SrcAirFoilData%CM)) THEN
   i1_l = LBOUND(SrcAirFoilData%CM,1)
   i1_u = UBOUND(SrcAirFoilData%CM,1)
   i2_l = LBOUND(SrcAirFoilData%CM,2)
   i2_u = UBOUND(SrcAirFoilData%CM,2)
   i3_l = LBOUND(SrcAirFoilData%CM,3)
   i3_u = UBOUND(SrcAirFoilData%CM,3)
   IF (.NOT. ALLOCATED(DstAirFoilData%CM)) THEN 
      ALLOCATE(DstAirFoilData%CM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilData%CM.', ErrStat, ErrMsg,'AD_CopyAirFoil')
         RETURN
      END IF
   END IF
   DstAirFoilData%CM = SrcAirFoilData%CM
ENDIF
   DstAirFoilData%PMC = SrcAirFoilData%PMC
   DstAirFoilData%MulTabLoc = SrcAirFoilData%MulTabLoc
 END SUBROUTINE AD_CopyAirFoil

 SUBROUTINE AD_DestroyAirFoil( AirFoilData, ErrStat, ErrMsg )
  TYPE(AirFoil), INTENT(INOUT) :: AirFoilData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AirFoilData%AL)) THEN
   DEALLOCATE(AirFoilData%AL)
ENDIF
IF (ALLOCATED(AirFoilData%CD)) THEN
   DEALLOCATE(AirFoilData%CD)
ENDIF
IF (ALLOCATED(AirFoilData%CL)) THEN
   DEALLOCATE(AirFoilData%CL)
ENDIF
IF (ALLOCATED(AirFoilData%CM)) THEN
   DEALLOCATE(AirFoilData%CM)
ENDIF
 END SUBROUTINE AD_DestroyAirFoil

 SUBROUTINE AD_PackAirFoil( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AirFoil),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%AL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AL )  ! AL 
  IF ( ALLOCATED(InData%CD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CD )  ! CD 
  IF ( ALLOCATED(InData%CL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CL )  ! CL 
  IF ( ALLOCATED(InData%CM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CM )  ! CM 
  Re_BufSz   = Re_BufSz   + 1  ! PMC
  Re_BufSz   = Re_BufSz   + 1  ! MulTabLoc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AL))-1 ) =  PACK(InData%AL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AL)
  ENDIF
  IF ( ALLOCATED(InData%CD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CD))-1 ) =  PACK(InData%CD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CD)
  ENDIF
  IF ( ALLOCATED(InData%CL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CL))-1 ) =  PACK(InData%CL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CL)
  ENDIF
  IF ( ALLOCATED(InData%CM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CM))-1 ) =  PACK(InData%CM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CM)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PMC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%MulTabLoc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackAirFoil

 SUBROUTINE AD_UnPackAirFoil( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AirFoil), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AL,1),SIZE(OutData%AL,2)))
  mask2 = .TRUE.
    OutData%AL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AL))-1 ),mask2,OutData%AL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AL)
  ENDIF
  IF ( ALLOCATED(OutData%CD) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CD,1),SIZE(OutData%CD,2),SIZE(OutData%CD,3)))
  mask3 = .TRUE.
    OutData%CD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CD))-1 ),mask3,OutData%CD)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CD)
  ENDIF
  IF ( ALLOCATED(OutData%CL) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CL,1),SIZE(OutData%CL,2),SIZE(OutData%CL,3)))
  mask3 = .TRUE.
    OutData%CL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CL))-1 ),mask3,OutData%CL)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CL)
  ENDIF
  IF ( ALLOCATED(OutData%CM) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CM,1),SIZE(OutData%CM,2),SIZE(OutData%CM,3)))
  mask3 = .TRUE.
    OutData%CM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CM))-1 ),mask3,OutData%CM)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CM)
  ENDIF
  OutData%PMC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%MulTabLoc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAirFoil

 SUBROUTINE AD_CopyAirFoilParms( SrcAirFoilParmsData, DstAirFoilParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AirFoilParms), INTENT(IN) :: SrcAirFoilParmsData
   TYPE(AirFoilParms), INTENT(INOUT) :: DstAirFoilParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstAirFoilParmsData%MaxTable = SrcAirFoilParmsData%MaxTable
IF (ALLOCATED(SrcAirFoilParmsData%NTables)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NTables,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NTables,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NTables)) THEN 
      ALLOCATE(DstAirFoilParmsData%NTables(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NTables.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NTables = SrcAirFoilParmsData%NTables
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%NLift)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NLift,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NLift,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NLift)) THEN 
      ALLOCATE(DstAirFoilParmsData%NLift(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NLift.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NLift = SrcAirFoilParmsData%NLift
ENDIF
   DstAirFoilParmsData%NumCL = SrcAirFoilParmsData%NumCL
   DstAirFoilParmsData%NumFoil = SrcAirFoilParmsData%NumFoil
IF (ALLOCATED(SrcAirFoilParmsData%NFoil)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%NFoil,1)
   i1_u = UBOUND(SrcAirFoilParmsData%NFoil,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%NFoil)) THEN 
      ALLOCATE(DstAirFoilParmsData%NFoil(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%NFoil.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%NFoil = SrcAirFoilParmsData%NFoil
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%MulTabMet)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%MulTabMet,1)
   i1_u = UBOUND(SrcAirFoilParmsData%MulTabMet,1)
   i2_l = LBOUND(SrcAirFoilParmsData%MulTabMet,2)
   i2_u = UBOUND(SrcAirFoilParmsData%MulTabMet,2)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%MulTabMet)) THEN 
      ALLOCATE(DstAirFoilParmsData%MulTabMet(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%MulTabMet.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%MulTabMet = SrcAirFoilParmsData%MulTabMet
ENDIF
IF (ALLOCATED(SrcAirFoilParmsData%FoilNm)) THEN
   i1_l = LBOUND(SrcAirFoilParmsData%FoilNm,1)
   i1_u = UBOUND(SrcAirFoilParmsData%FoilNm,1)
   IF (.NOT. ALLOCATED(DstAirFoilParmsData%FoilNm)) THEN 
      ALLOCATE(DstAirFoilParmsData%FoilNm(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstAirFoilParmsData%FoilNm.', ErrStat, ErrMsg,'AD_CopyAirFoilParms')
         RETURN
      END IF
   END IF
   DstAirFoilParmsData%FoilNm = SrcAirFoilParmsData%FoilNm
ENDIF
 END SUBROUTINE AD_CopyAirFoilParms

 SUBROUTINE AD_DestroyAirFoilParms( AirFoilParmsData, ErrStat, ErrMsg )
  TYPE(AirFoilParms), INTENT(INOUT) :: AirFoilParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(AirFoilParmsData%NTables)) THEN
   DEALLOCATE(AirFoilParmsData%NTables)
ENDIF
IF (ALLOCATED(AirFoilParmsData%NLift)) THEN
   DEALLOCATE(AirFoilParmsData%NLift)
ENDIF
IF (ALLOCATED(AirFoilParmsData%NFoil)) THEN
   DEALLOCATE(AirFoilParmsData%NFoil)
ENDIF
IF (ALLOCATED(AirFoilParmsData%MulTabMet)) THEN
   DEALLOCATE(AirFoilParmsData%MulTabMet)
ENDIF
IF (ALLOCATED(AirFoilParmsData%FoilNm)) THEN
   DEALLOCATE(AirFoilParmsData%FoilNm)
ENDIF
 END SUBROUTINE AD_DestroyAirFoilParms

 SUBROUTINE AD_PackAirFoilParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AirFoilParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MaxTable
  IF ( ALLOCATED(InData%NTables) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NTables )  ! NTables 
  IF ( ALLOCATED(InData%NLift) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NLift )  ! NLift 
  Int_BufSz  = Int_BufSz  + 1  ! NumCL
  Int_BufSz  = Int_BufSz  + 1  ! NumFoil
  IF ( ALLOCATED(InData%NFoil) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NFoil )  ! NFoil 
  IF ( ALLOCATED(InData%MulTabMet) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabMet )  ! MulTabMet 
!  missing buffer for FoilNm
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MaxTable )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NTables) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTables))-1 ) = PACK(InData%NTables ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTables)
  ENDIF
  IF ( ALLOCATED(InData%NLift) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NLift))-1 ) = PACK(InData%NLift ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NLift)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumCL )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumFoil )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NFoil) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NFoil))-1 ) = PACK(InData%NFoil ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NFoil)
  ENDIF
  IF ( ALLOCATED(InData%MulTabMet) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabMet))-1 ) =  PACK(InData%MulTabMet ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabMet)
  ENDIF
 END SUBROUTINE AD_PackAirFoilParms

 SUBROUTINE AD_UnPackAirFoilParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AirFoilParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MaxTable = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NTables) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTables,1)))
  mask1 = .TRUE.
    OutData%NTables = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTables))-1 ),mask1,OutData%NTables)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTables)
  ENDIF
  IF ( ALLOCATED(OutData%NLift) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NLift,1)))
  mask1 = .TRUE.
    OutData%NLift = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NLift))-1 ),mask1,OutData%NLift)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NLift)
  ENDIF
  OutData%NumCL = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NumFoil = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NFoil) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NFoil,1)))
  mask1 = .TRUE.
    OutData%NFoil = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NFoil))-1 ),mask1,OutData%NFoil)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NFoil)
  ENDIF
  IF ( ALLOCATED(OutData%MulTabMet) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabMet,1),SIZE(OutData%MulTabMet,2)))
  mask2 = .TRUE.
    OutData%MulTabMet = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabMet))-1 ),mask2,OutData%MulTabMet)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabMet)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackAirFoilParms

 SUBROUTINE AD_CopyBeddoes( SrcBeddoesData, DstBeddoesData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Beddoes), INTENT(IN) :: SrcBeddoesData
   TYPE(Beddoes), INTENT(INOUT) :: DstBeddoesData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcBeddoesData%ADOT)) THEN
   i1_l = LBOUND(SrcBeddoesData%ADOT,1)
   i1_u = UBOUND(SrcBeddoesData%ADOT,1)
   i2_l = LBOUND(SrcBeddoesData%ADOT,2)
   i2_u = UBOUND(SrcBeddoesData%ADOT,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ADOT)) THEN 
      ALLOCATE(DstBeddoesData%ADOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ADOT.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ADOT = SrcBeddoesData%ADOT
ENDIF
IF (ALLOCATED(SrcBeddoesData%ADOT1)) THEN
   i1_l = LBOUND(SrcBeddoesData%ADOT1,1)
   i1_u = UBOUND(SrcBeddoesData%ADOT1,1)
   i2_l = LBOUND(SrcBeddoesData%ADOT1,2)
   i2_u = UBOUND(SrcBeddoesData%ADOT1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ADOT1)) THEN 
      ALLOCATE(DstBeddoesData%ADOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ADOT1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ADOT1 = SrcBeddoesData%ADOT1
ENDIF
IF (ALLOCATED(SrcBeddoesData%AFE)) THEN
   i1_l = LBOUND(SrcBeddoesData%AFE,1)
   i1_u = UBOUND(SrcBeddoesData%AFE,1)
   i2_l = LBOUND(SrcBeddoesData%AFE,2)
   i2_u = UBOUND(SrcBeddoesData%AFE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AFE)) THEN 
      ALLOCATE(DstBeddoesData%AFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AFE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AFE = SrcBeddoesData%AFE
ENDIF
IF (ALLOCATED(SrcBeddoesData%AFE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%AFE1,1)
   i1_u = UBOUND(SrcBeddoesData%AFE1,1)
   i2_l = LBOUND(SrcBeddoesData%AFE1,2)
   i2_u = UBOUND(SrcBeddoesData%AFE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AFE1)) THEN 
      ALLOCATE(DstBeddoesData%AFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AFE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AFE1 = SrcBeddoesData%AFE1
ENDIF
   DstBeddoesData%AN = SrcBeddoesData%AN
IF (ALLOCATED(SrcBeddoesData%ANE)) THEN
   i1_l = LBOUND(SrcBeddoesData%ANE,1)
   i1_u = UBOUND(SrcBeddoesData%ANE,1)
   i2_l = LBOUND(SrcBeddoesData%ANE,2)
   i2_u = UBOUND(SrcBeddoesData%ANE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ANE)) THEN 
      ALLOCATE(DstBeddoesData%ANE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ANE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ANE = SrcBeddoesData%ANE
ENDIF
IF (ALLOCATED(SrcBeddoesData%ANE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%ANE1,1)
   i1_u = UBOUND(SrcBeddoesData%ANE1,1)
   i2_l = LBOUND(SrcBeddoesData%ANE1,2)
   i2_u = UBOUND(SrcBeddoesData%ANE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%ANE1)) THEN 
      ALLOCATE(DstBeddoesData%ANE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%ANE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%ANE1 = SrcBeddoesData%ANE1
ENDIF
IF (ALLOCATED(SrcBeddoesData%AOD)) THEN
   i1_l = LBOUND(SrcBeddoesData%AOD,1)
   i1_u = UBOUND(SrcBeddoesData%AOD,1)
   i2_l = LBOUND(SrcBeddoesData%AOD,2)
   i2_u = UBOUND(SrcBeddoesData%AOD,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AOD)) THEN 
      ALLOCATE(DstBeddoesData%AOD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AOD.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AOD = SrcBeddoesData%AOD
ENDIF
IF (ALLOCATED(SrcBeddoesData%AOL)) THEN
   i1_l = LBOUND(SrcBeddoesData%AOL,1)
   i1_u = UBOUND(SrcBeddoesData%AOL,1)
   i2_l = LBOUND(SrcBeddoesData%AOL,2)
   i2_u = UBOUND(SrcBeddoesData%AOL,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%AOL)) THEN 
      ALLOCATE(DstBeddoesData%AOL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%AOL.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%AOL = SrcBeddoesData%AOL
ENDIF
IF (ALLOCATED(SrcBeddoesData%BEDSEP)) THEN
   i1_l = LBOUND(SrcBeddoesData%BEDSEP,1)
   i1_u = UBOUND(SrcBeddoesData%BEDSEP,1)
   i2_l = LBOUND(SrcBeddoesData%BEDSEP,2)
   i2_u = UBOUND(SrcBeddoesData%BEDSEP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%BEDSEP)) THEN 
      ALLOCATE(DstBeddoesData%BEDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%BEDSEP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%BEDSEP = SrcBeddoesData%BEDSEP
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDSEP)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDSEP,1)
   i1_u = UBOUND(SrcBeddoesData%OLDSEP,1)
   i2_l = LBOUND(SrcBeddoesData%OLDSEP,2)
   i2_u = UBOUND(SrcBeddoesData%OLDSEP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDSEP)) THEN 
      ALLOCATE(DstBeddoesData%OLDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDSEP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDSEP = SrcBeddoesData%OLDSEP
ENDIF
   DstBeddoesData%CC = SrcBeddoesData%CC
IF (ALLOCATED(SrcBeddoesData%CDO)) THEN
   i1_l = LBOUND(SrcBeddoesData%CDO,1)
   i1_u = UBOUND(SrcBeddoesData%CDO,1)
   i2_l = LBOUND(SrcBeddoesData%CDO,2)
   i2_u = UBOUND(SrcBeddoesData%CDO,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CDO)) THEN 
      ALLOCATE(DstBeddoesData%CDO(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CDO.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CDO = SrcBeddoesData%CDO
ENDIF
   DstBeddoesData%CMI = SrcBeddoesData%CMI
   DstBeddoesData%CMQ = SrcBeddoesData%CMQ
   DstBeddoesData%CN = SrcBeddoesData%CN
IF (ALLOCATED(SrcBeddoesData%CNA)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNA,1)
   i1_u = UBOUND(SrcBeddoesData%CNA,1)
   i2_l = LBOUND(SrcBeddoesData%CNA,2)
   i2_u = UBOUND(SrcBeddoesData%CNA,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNA)) THEN 
      ALLOCATE(DstBeddoesData%CNA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNA.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNA = SrcBeddoesData%CNA
ENDIF
   DstBeddoesData%CNCP = SrcBeddoesData%CNCP
   DstBeddoesData%CNIQ = SrcBeddoesData%CNIQ
IF (ALLOCATED(SrcBeddoesData%CNP)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNP,1)
   i1_u = UBOUND(SrcBeddoesData%CNP,1)
   i2_l = LBOUND(SrcBeddoesData%CNP,2)
   i2_u = UBOUND(SrcBeddoesData%CNP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNP)) THEN 
      ALLOCATE(DstBeddoesData%CNP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNP = SrcBeddoesData%CNP
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNP1,1)
   i1_u = UBOUND(SrcBeddoesData%CNP1,1)
   i2_l = LBOUND(SrcBeddoesData%CNP1,2)
   i2_u = UBOUND(SrcBeddoesData%CNP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNP1)) THEN 
      ALLOCATE(DstBeddoesData%CNP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNP1 = SrcBeddoesData%CNP1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPD)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPD,1)
   i1_u = UBOUND(SrcBeddoesData%CNPD,1)
   i2_l = LBOUND(SrcBeddoesData%CNPD,2)
   i2_u = UBOUND(SrcBeddoesData%CNPD,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPD)) THEN 
      ALLOCATE(DstBeddoesData%CNPD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPD.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPD = SrcBeddoesData%CNPD
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPD1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPD1,1)
   i1_u = UBOUND(SrcBeddoesData%CNPD1,1)
   i2_l = LBOUND(SrcBeddoesData%CNPD1,2)
   i2_u = UBOUND(SrcBeddoesData%CNPD1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPD1)) THEN 
      ALLOCATE(DstBeddoesData%CNPD1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPD1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPD1 = SrcBeddoesData%CNPD1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPOT)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPOT,1)
   i1_u = UBOUND(SrcBeddoesData%CNPOT,1)
   i2_l = LBOUND(SrcBeddoesData%CNPOT,2)
   i2_u = UBOUND(SrcBeddoesData%CNPOT,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPOT)) THEN 
      ALLOCATE(DstBeddoesData%CNPOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPOT.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPOT = SrcBeddoesData%CNPOT
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNPOT1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNPOT1,1)
   i1_u = UBOUND(SrcBeddoesData%CNPOT1,1)
   i2_l = LBOUND(SrcBeddoesData%CNPOT1,2)
   i2_u = UBOUND(SrcBeddoesData%CNPOT1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNPOT1)) THEN 
      ALLOCATE(DstBeddoesData%CNPOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNPOT1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNPOT1 = SrcBeddoesData%CNPOT1
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNS)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNS,1)
   i1_u = UBOUND(SrcBeddoesData%CNS,1)
   i2_l = LBOUND(SrcBeddoesData%CNS,2)
   i2_u = UBOUND(SrcBeddoesData%CNS,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNS)) THEN 
      ALLOCATE(DstBeddoesData%CNS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNS.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNS = SrcBeddoesData%CNS
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNSL)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNSL,1)
   i1_u = UBOUND(SrcBeddoesData%CNSL,1)
   i2_l = LBOUND(SrcBeddoesData%CNSL,2)
   i2_u = UBOUND(SrcBeddoesData%CNSL,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNSL)) THEN 
      ALLOCATE(DstBeddoesData%CNSL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNSL.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNSL = SrcBeddoesData%CNSL
ENDIF
IF (ALLOCATED(SrcBeddoesData%CNV)) THEN
   i1_l = LBOUND(SrcBeddoesData%CNV,1)
   i1_u = UBOUND(SrcBeddoesData%CNV,1)
   i2_l = LBOUND(SrcBeddoesData%CNV,2)
   i2_u = UBOUND(SrcBeddoesData%CNV,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CNV)) THEN 
      ALLOCATE(DstBeddoesData%CNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CNV.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CNV = SrcBeddoesData%CNV
ENDIF
IF (ALLOCATED(SrcBeddoesData%CVN)) THEN
   i1_l = LBOUND(SrcBeddoesData%CVN,1)
   i1_u = UBOUND(SrcBeddoesData%CVN,1)
   i2_l = LBOUND(SrcBeddoesData%CVN,2)
   i2_u = UBOUND(SrcBeddoesData%CVN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CVN)) THEN 
      ALLOCATE(DstBeddoesData%CVN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CVN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CVN = SrcBeddoesData%CVN
ENDIF
IF (ALLOCATED(SrcBeddoesData%CVN1)) THEN
   i1_l = LBOUND(SrcBeddoesData%CVN1,1)
   i1_u = UBOUND(SrcBeddoesData%CVN1,1)
   i2_l = LBOUND(SrcBeddoesData%CVN1,2)
   i2_u = UBOUND(SrcBeddoesData%CVN1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%CVN1)) THEN 
      ALLOCATE(DstBeddoesData%CVN1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%CVN1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%CVN1 = SrcBeddoesData%CVN1
ENDIF
IF (ALLOCATED(SrcBeddoesData%DF)) THEN
   i1_l = LBOUND(SrcBeddoesData%DF,1)
   i1_u = UBOUND(SrcBeddoesData%DF,1)
   i2_l = LBOUND(SrcBeddoesData%DF,2)
   i2_u = UBOUND(SrcBeddoesData%DF,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DF)) THEN 
      ALLOCATE(DstBeddoesData%DF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DF.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DF = SrcBeddoesData%DF
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFAFE)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFAFE,1)
   i1_u = UBOUND(SrcBeddoesData%DFAFE,1)
   i2_l = LBOUND(SrcBeddoesData%DFAFE,2)
   i2_u = UBOUND(SrcBeddoesData%DFAFE,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFAFE)) THEN 
      ALLOCATE(DstBeddoesData%DFAFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFAFE.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFAFE = SrcBeddoesData%DFAFE
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFAFE1)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFAFE1,1)
   i1_u = UBOUND(SrcBeddoesData%DFAFE1,1)
   i2_l = LBOUND(SrcBeddoesData%DFAFE1,2)
   i2_u = UBOUND(SrcBeddoesData%DFAFE1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFAFE1)) THEN 
      ALLOCATE(DstBeddoesData%DFAFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFAFE1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFAFE1 = SrcBeddoesData%DFAFE1
ENDIF
IF (ALLOCATED(SrcBeddoesData%DFC)) THEN
   i1_l = LBOUND(SrcBeddoesData%DFC,1)
   i1_u = UBOUND(SrcBeddoesData%DFC,1)
   i2_l = LBOUND(SrcBeddoesData%DFC,2)
   i2_u = UBOUND(SrcBeddoesData%DFC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DFC)) THEN 
      ALLOCATE(DstBeddoesData%DFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DFC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DFC = SrcBeddoesData%DFC
ENDIF
IF (ALLOCATED(SrcBeddoesData%DN)) THEN
   i1_l = LBOUND(SrcBeddoesData%DN,1)
   i1_u = UBOUND(SrcBeddoesData%DN,1)
   i2_l = LBOUND(SrcBeddoesData%DN,2)
   i2_u = UBOUND(SrcBeddoesData%DN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DN)) THEN 
      ALLOCATE(DstBeddoesData%DN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DN = SrcBeddoesData%DN
ENDIF
IF (ALLOCATED(SrcBeddoesData%DPP)) THEN
   i1_l = LBOUND(SrcBeddoesData%DPP,1)
   i1_u = UBOUND(SrcBeddoesData%DPP,1)
   i2_l = LBOUND(SrcBeddoesData%DPP,2)
   i2_u = UBOUND(SrcBeddoesData%DPP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DPP)) THEN 
      ALLOCATE(DstBeddoesData%DPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DPP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DPP = SrcBeddoesData%DPP
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQ)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQ,1)
   i1_u = UBOUND(SrcBeddoesData%DQ,1)
   i2_l = LBOUND(SrcBeddoesData%DQ,2)
   i2_u = UBOUND(SrcBeddoesData%DQ,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQ)) THEN 
      ALLOCATE(DstBeddoesData%DQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQ.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQ = SrcBeddoesData%DQ
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQP)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQP,1)
   i1_u = UBOUND(SrcBeddoesData%DQP,1)
   i2_l = LBOUND(SrcBeddoesData%DQP,2)
   i2_u = UBOUND(SrcBeddoesData%DQP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQP)) THEN 
      ALLOCATE(DstBeddoesData%DQP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQP = SrcBeddoesData%DQP
ENDIF
IF (ALLOCATED(SrcBeddoesData%DQP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%DQP1,1)
   i1_u = UBOUND(SrcBeddoesData%DQP1,1)
   i2_l = LBOUND(SrcBeddoesData%DQP1,2)
   i2_u = UBOUND(SrcBeddoesData%DQP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%DQP1)) THEN 
      ALLOCATE(DstBeddoesData%DQP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%DQP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%DQP1 = SrcBeddoesData%DQP1
ENDIF
   DstBeddoesData%DS = SrcBeddoesData%DS
   DstBeddoesData%FK = SrcBeddoesData%FK
   DstBeddoesData%FP = SrcBeddoesData%FP
   DstBeddoesData%FPC = SrcBeddoesData%FPC
IF (ALLOCATED(SrcBeddoesData%FSP)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSP,1)
   i1_u = UBOUND(SrcBeddoesData%FSP,1)
   i2_l = LBOUND(SrcBeddoesData%FSP,2)
   i2_u = UBOUND(SrcBeddoesData%FSP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSP)) THEN 
      ALLOCATE(DstBeddoesData%FSP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSP = SrcBeddoesData%FSP
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSP1)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSP1,1)
   i1_u = UBOUND(SrcBeddoesData%FSP1,1)
   i2_l = LBOUND(SrcBeddoesData%FSP1,2)
   i2_u = UBOUND(SrcBeddoesData%FSP1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSP1)) THEN 
      ALLOCATE(DstBeddoesData%FSP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSP1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSP1 = SrcBeddoesData%FSP1
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSPC)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSPC,1)
   i1_u = UBOUND(SrcBeddoesData%FSPC,1)
   i2_l = LBOUND(SrcBeddoesData%FSPC,2)
   i2_u = UBOUND(SrcBeddoesData%FSPC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSPC)) THEN 
      ALLOCATE(DstBeddoesData%FSPC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSPC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSPC = SrcBeddoesData%FSPC
ENDIF
IF (ALLOCATED(SrcBeddoesData%FSPC1)) THEN
   i1_l = LBOUND(SrcBeddoesData%FSPC1,1)
   i1_u = UBOUND(SrcBeddoesData%FSPC1,1)
   i2_l = LBOUND(SrcBeddoesData%FSPC1,2)
   i2_u = UBOUND(SrcBeddoesData%FSPC1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%FSPC1)) THEN 
      ALLOCATE(DstBeddoesData%FSPC1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FSPC1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FSPC1 = SrcBeddoesData%FSPC1
ENDIF
IF (ALLOCATED(SrcBeddoesData%FTB)) THEN
   i1_l = LBOUND(SrcBeddoesData%FTB,1)
   i1_u = UBOUND(SrcBeddoesData%FTB,1)
   i2_l = LBOUND(SrcBeddoesData%FTB,2)
   i2_u = UBOUND(SrcBeddoesData%FTB,2)
   i3_l = LBOUND(SrcBeddoesData%FTB,3)
   i3_u = UBOUND(SrcBeddoesData%FTB,3)
   IF (.NOT. ALLOCATED(DstBeddoesData%FTB)) THEN 
      ALLOCATE(DstBeddoesData%FTB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FTB.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FTB = SrcBeddoesData%FTB
ENDIF
IF (ALLOCATED(SrcBeddoesData%FTBC)) THEN
   i1_l = LBOUND(SrcBeddoesData%FTBC,1)
   i1_u = UBOUND(SrcBeddoesData%FTBC,1)
   i2_l = LBOUND(SrcBeddoesData%FTBC,2)
   i2_u = UBOUND(SrcBeddoesData%FTBC,2)
   i3_l = LBOUND(SrcBeddoesData%FTBC,3)
   i3_u = UBOUND(SrcBeddoesData%FTBC,3)
   IF (.NOT. ALLOCATED(DstBeddoesData%FTBC)) THEN 
      ALLOCATE(DstBeddoesData%FTBC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%FTBC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%FTBC = SrcBeddoesData%FTBC
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDCNV)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDCNV,1)
   i1_u = UBOUND(SrcBeddoesData%OLDCNV,1)
   i2_l = LBOUND(SrcBeddoesData%OLDCNV,2)
   i2_u = UBOUND(SrcBeddoesData%OLDCNV,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDCNV)) THEN 
      ALLOCATE(DstBeddoesData%OLDCNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDCNV.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDCNV = SrcBeddoesData%OLDCNV
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDF)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDF,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDF,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDF,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDF,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDF)) THEN 
      ALLOCATE(DstBeddoesData%OLDDF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDF.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDF = SrcBeddoesData%OLDDF
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDFC)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDFC,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDFC,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDFC,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDFC,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDFC)) THEN 
      ALLOCATE(DstBeddoesData%OLDDFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDFC.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDFC = SrcBeddoesData%OLDDFC
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDN)) THEN 
      ALLOCATE(DstBeddoesData%OLDDN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDN = SrcBeddoesData%OLDDN
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDPP)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDPP,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDPP,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDPP,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDPP,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDPP)) THEN 
      ALLOCATE(DstBeddoesData%OLDDPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDPP.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDPP = SrcBeddoesData%OLDDPP
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDDQ)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDDQ,1)
   i1_u = UBOUND(SrcBeddoesData%OLDDQ,1)
   i2_l = LBOUND(SrcBeddoesData%OLDDQ,2)
   i2_u = UBOUND(SrcBeddoesData%OLDDQ,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDDQ)) THEN 
      ALLOCATE(DstBeddoesData%OLDDQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDDQ.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDDQ = SrcBeddoesData%OLDDQ
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDTAU)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDTAU,1)
   i1_u = UBOUND(SrcBeddoesData%OLDTAU,1)
   i2_l = LBOUND(SrcBeddoesData%OLDTAU,2)
   i2_u = UBOUND(SrcBeddoesData%OLDTAU,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDTAU)) THEN 
      ALLOCATE(DstBeddoesData%OLDTAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDTAU.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDTAU = SrcBeddoesData%OLDTAU
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDXN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDXN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDXN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDXN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDXN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDXN)) THEN 
      ALLOCATE(DstBeddoesData%OLDXN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDXN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDXN = SrcBeddoesData%OLDXN
ENDIF
IF (ALLOCATED(SrcBeddoesData%OLDYN)) THEN
   i1_l = LBOUND(SrcBeddoesData%OLDYN,1)
   i1_u = UBOUND(SrcBeddoesData%OLDYN,1)
   i2_l = LBOUND(SrcBeddoesData%OLDYN,2)
   i2_u = UBOUND(SrcBeddoesData%OLDYN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%OLDYN)) THEN 
      ALLOCATE(DstBeddoesData%OLDYN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%OLDYN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%OLDYN = SrcBeddoesData%OLDYN
ENDIF
IF (ALLOCATED(SrcBeddoesData%QX)) THEN
   i1_l = LBOUND(SrcBeddoesData%QX,1)
   i1_u = UBOUND(SrcBeddoesData%QX,1)
   i2_l = LBOUND(SrcBeddoesData%QX,2)
   i2_u = UBOUND(SrcBeddoesData%QX,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%QX)) THEN 
      ALLOCATE(DstBeddoesData%QX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%QX.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%QX = SrcBeddoesData%QX
ENDIF
IF (ALLOCATED(SrcBeddoesData%QX1)) THEN
   i1_l = LBOUND(SrcBeddoesData%QX1,1)
   i1_u = UBOUND(SrcBeddoesData%QX1,1)
   i2_l = LBOUND(SrcBeddoesData%QX1,2)
   i2_u = UBOUND(SrcBeddoesData%QX1,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%QX1)) THEN 
      ALLOCATE(DstBeddoesData%QX1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%QX1.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%QX1 = SrcBeddoesData%QX1
ENDIF
IF (ALLOCATED(SrcBeddoesData%TAU)) THEN
   i1_l = LBOUND(SrcBeddoesData%TAU,1)
   i1_u = UBOUND(SrcBeddoesData%TAU,1)
   i2_l = LBOUND(SrcBeddoesData%TAU,2)
   i2_u = UBOUND(SrcBeddoesData%TAU,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%TAU)) THEN 
      ALLOCATE(DstBeddoesData%TAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%TAU.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%TAU = SrcBeddoesData%TAU
ENDIF
IF (ALLOCATED(SrcBeddoesData%XN)) THEN
   i1_l = LBOUND(SrcBeddoesData%XN,1)
   i1_u = UBOUND(SrcBeddoesData%XN,1)
   i2_l = LBOUND(SrcBeddoesData%XN,2)
   i2_u = UBOUND(SrcBeddoesData%XN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%XN)) THEN 
      ALLOCATE(DstBeddoesData%XN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%XN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%XN = SrcBeddoesData%XN
ENDIF
IF (ALLOCATED(SrcBeddoesData%YN)) THEN
   i1_l = LBOUND(SrcBeddoesData%YN,1)
   i1_u = UBOUND(SrcBeddoesData%YN,1)
   i2_l = LBOUND(SrcBeddoesData%YN,2)
   i2_u = UBOUND(SrcBeddoesData%YN,2)
   IF (.NOT. ALLOCATED(DstBeddoesData%YN)) THEN 
      ALLOCATE(DstBeddoesData%YN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBeddoesData%YN.', ErrStat, ErrMsg,'AD_CopyBeddoes')
         RETURN
      END IF
   END IF
   DstBeddoesData%YN = SrcBeddoesData%YN
ENDIF
   DstBeddoesData%SHIFT = SrcBeddoesData%SHIFT
   DstBeddoesData%VOR = SrcBeddoesData%VOR
 END SUBROUTINE AD_CopyBeddoes

 SUBROUTINE AD_DestroyBeddoes( BeddoesData, ErrStat, ErrMsg )
  TYPE(Beddoes), INTENT(INOUT) :: BeddoesData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BeddoesData%ADOT)) THEN
   DEALLOCATE(BeddoesData%ADOT)
ENDIF
IF (ALLOCATED(BeddoesData%ADOT1)) THEN
   DEALLOCATE(BeddoesData%ADOT1)
ENDIF
IF (ALLOCATED(BeddoesData%AFE)) THEN
   DEALLOCATE(BeddoesData%AFE)
ENDIF
IF (ALLOCATED(BeddoesData%AFE1)) THEN
   DEALLOCATE(BeddoesData%AFE1)
ENDIF
IF (ALLOCATED(BeddoesData%ANE)) THEN
   DEALLOCATE(BeddoesData%ANE)
ENDIF
IF (ALLOCATED(BeddoesData%ANE1)) THEN
   DEALLOCATE(BeddoesData%ANE1)
ENDIF
IF (ALLOCATED(BeddoesData%AOD)) THEN
   DEALLOCATE(BeddoesData%AOD)
ENDIF
IF (ALLOCATED(BeddoesData%AOL)) THEN
   DEALLOCATE(BeddoesData%AOL)
ENDIF
IF (ALLOCATED(BeddoesData%BEDSEP)) THEN
   DEALLOCATE(BeddoesData%BEDSEP)
ENDIF
IF (ALLOCATED(BeddoesData%OLDSEP)) THEN
   DEALLOCATE(BeddoesData%OLDSEP)
ENDIF
IF (ALLOCATED(BeddoesData%CDO)) THEN
   DEALLOCATE(BeddoesData%CDO)
ENDIF
IF (ALLOCATED(BeddoesData%CNA)) THEN
   DEALLOCATE(BeddoesData%CNA)
ENDIF
IF (ALLOCATED(BeddoesData%CNP)) THEN
   DEALLOCATE(BeddoesData%CNP)
ENDIF
IF (ALLOCATED(BeddoesData%CNP1)) THEN
   DEALLOCATE(BeddoesData%CNP1)
ENDIF
IF (ALLOCATED(BeddoesData%CNPD)) THEN
   DEALLOCATE(BeddoesData%CNPD)
ENDIF
IF (ALLOCATED(BeddoesData%CNPD1)) THEN
   DEALLOCATE(BeddoesData%CNPD1)
ENDIF
IF (ALLOCATED(BeddoesData%CNPOT)) THEN
   DEALLOCATE(BeddoesData%CNPOT)
ENDIF
IF (ALLOCATED(BeddoesData%CNPOT1)) THEN
   DEALLOCATE(BeddoesData%CNPOT1)
ENDIF
IF (ALLOCATED(BeddoesData%CNS)) THEN
   DEALLOCATE(BeddoesData%CNS)
ENDIF
IF (ALLOCATED(BeddoesData%CNSL)) THEN
   DEALLOCATE(BeddoesData%CNSL)
ENDIF
IF (ALLOCATED(BeddoesData%CNV)) THEN
   DEALLOCATE(BeddoesData%CNV)
ENDIF
IF (ALLOCATED(BeddoesData%CVN)) THEN
   DEALLOCATE(BeddoesData%CVN)
ENDIF
IF (ALLOCATED(BeddoesData%CVN1)) THEN
   DEALLOCATE(BeddoesData%CVN1)
ENDIF
IF (ALLOCATED(BeddoesData%DF)) THEN
   DEALLOCATE(BeddoesData%DF)
ENDIF
IF (ALLOCATED(BeddoesData%DFAFE)) THEN
   DEALLOCATE(BeddoesData%DFAFE)
ENDIF
IF (ALLOCATED(BeddoesData%DFAFE1)) THEN
   DEALLOCATE(BeddoesData%DFAFE1)
ENDIF
IF (ALLOCATED(BeddoesData%DFC)) THEN
   DEALLOCATE(BeddoesData%DFC)
ENDIF
IF (ALLOCATED(BeddoesData%DN)) THEN
   DEALLOCATE(BeddoesData%DN)
ENDIF
IF (ALLOCATED(BeddoesData%DPP)) THEN
   DEALLOCATE(BeddoesData%DPP)
ENDIF
IF (ALLOCATED(BeddoesData%DQ)) THEN
   DEALLOCATE(BeddoesData%DQ)
ENDIF
IF (ALLOCATED(BeddoesData%DQP)) THEN
   DEALLOCATE(BeddoesData%DQP)
ENDIF
IF (ALLOCATED(BeddoesData%DQP1)) THEN
   DEALLOCATE(BeddoesData%DQP1)
ENDIF
IF (ALLOCATED(BeddoesData%FSP)) THEN
   DEALLOCATE(BeddoesData%FSP)
ENDIF
IF (ALLOCATED(BeddoesData%FSP1)) THEN
   DEALLOCATE(BeddoesData%FSP1)
ENDIF
IF (ALLOCATED(BeddoesData%FSPC)) THEN
   DEALLOCATE(BeddoesData%FSPC)
ENDIF
IF (ALLOCATED(BeddoesData%FSPC1)) THEN
   DEALLOCATE(BeddoesData%FSPC1)
ENDIF
IF (ALLOCATED(BeddoesData%FTB)) THEN
   DEALLOCATE(BeddoesData%FTB)
ENDIF
IF (ALLOCATED(BeddoesData%FTBC)) THEN
   DEALLOCATE(BeddoesData%FTBC)
ENDIF
IF (ALLOCATED(BeddoesData%OLDCNV)) THEN
   DEALLOCATE(BeddoesData%OLDCNV)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDF)) THEN
   DEALLOCATE(BeddoesData%OLDDF)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDFC)) THEN
   DEALLOCATE(BeddoesData%OLDDFC)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDN)) THEN
   DEALLOCATE(BeddoesData%OLDDN)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDPP)) THEN
   DEALLOCATE(BeddoesData%OLDDPP)
ENDIF
IF (ALLOCATED(BeddoesData%OLDDQ)) THEN
   DEALLOCATE(BeddoesData%OLDDQ)
ENDIF
IF (ALLOCATED(BeddoesData%OLDTAU)) THEN
   DEALLOCATE(BeddoesData%OLDTAU)
ENDIF
IF (ALLOCATED(BeddoesData%OLDXN)) THEN
   DEALLOCATE(BeddoesData%OLDXN)
ENDIF
IF (ALLOCATED(BeddoesData%OLDYN)) THEN
   DEALLOCATE(BeddoesData%OLDYN)
ENDIF
IF (ALLOCATED(BeddoesData%QX)) THEN
   DEALLOCATE(BeddoesData%QX)
ENDIF
IF (ALLOCATED(BeddoesData%QX1)) THEN
   DEALLOCATE(BeddoesData%QX1)
ENDIF
IF (ALLOCATED(BeddoesData%TAU)) THEN
   DEALLOCATE(BeddoesData%TAU)
ENDIF
IF (ALLOCATED(BeddoesData%XN)) THEN
   DEALLOCATE(BeddoesData%XN)
ENDIF
IF (ALLOCATED(BeddoesData%YN)) THEN
   DEALLOCATE(BeddoesData%YN)
ENDIF
 END SUBROUTINE AD_DestroyBeddoes

 SUBROUTINE AD_PackBeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Beddoes),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%ADOT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT )  ! ADOT 
  IF ( ALLOCATED(InData%ADOT1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT1 )  ! ADOT1 
  IF ( ALLOCATED(InData%AFE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AFE )  ! AFE 
  IF ( ALLOCATED(InData%AFE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AFE1 )  ! AFE1 
  Re_BufSz   = Re_BufSz   + 1  ! AN
  IF ( ALLOCATED(InData%ANE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ANE )  ! ANE 
  IF ( ALLOCATED(InData%ANE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ANE1 )  ! ANE1 
  IF ( ALLOCATED(InData%AOD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AOD )  ! AOD 
  IF ( ALLOCATED(InData%AOL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AOL )  ! AOL 
  IF ( ALLOCATED(InData%BEDSEP) )   Int_BufSz   = Int_BufSz   + SIZE( InData%BEDSEP )  ! BEDSEP 
  IF ( ALLOCATED(InData%OLDSEP) )   Int_BufSz   = Int_BufSz   + SIZE( InData%OLDSEP )  ! OLDSEP 
  Re_BufSz   = Re_BufSz   + 1  ! CC
  IF ( ALLOCATED(InData%CDO) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CDO )  ! CDO 
  Re_BufSz   = Re_BufSz   + 1  ! CMI
  Re_BufSz   = Re_BufSz   + 1  ! CMQ
  Re_BufSz   = Re_BufSz   + 1  ! CN
  IF ( ALLOCATED(InData%CNA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNA )  ! CNA 
  Re_BufSz   = Re_BufSz   + 1  ! CNCP
  Re_BufSz   = Re_BufSz   + 1  ! CNIQ
  IF ( ALLOCATED(InData%CNP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNP )  ! CNP 
  IF ( ALLOCATED(InData%CNP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNP1 )  ! CNP1 
  IF ( ALLOCATED(InData%CNPD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD )  ! CNPD 
  IF ( ALLOCATED(InData%CNPD1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD1 )  ! CNPD1 
  IF ( ALLOCATED(InData%CNPOT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT )  ! CNPOT 
  IF ( ALLOCATED(InData%CNPOT1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT1 )  ! CNPOT1 
  IF ( ALLOCATED(InData%CNS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNS )  ! CNS 
  IF ( ALLOCATED(InData%CNSL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNSL )  ! CNSL 
  IF ( ALLOCATED(InData%CNV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNV )  ! CNV 
  IF ( ALLOCATED(InData%CVN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CVN )  ! CVN 
  IF ( ALLOCATED(InData%CVN1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CVN1 )  ! CVN1 
  IF ( ALLOCATED(InData%DF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DF )  ! DF 
  IF ( ALLOCATED(InData%DFAFE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE )  ! DFAFE 
  IF ( ALLOCATED(InData%DFAFE1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE1 )  ! DFAFE1 
  IF ( ALLOCATED(InData%DFC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFC )  ! DFC 
  IF ( ALLOCATED(InData%DN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DN )  ! DN 
  IF ( ALLOCATED(InData%DPP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DPP )  ! DPP 
  IF ( ALLOCATED(InData%DQ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQ )  ! DQ 
  IF ( ALLOCATED(InData%DQP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQP )  ! DQP 
  IF ( ALLOCATED(InData%DQP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DQP1 )  ! DQP1 
  Re_BufSz   = Re_BufSz   + 1  ! DS
  Re_BufSz   = Re_BufSz   + 1  ! FK
  Re_BufSz   = Re_BufSz   + 1  ! FP
  Re_BufSz   = Re_BufSz   + 1  ! FPC
  IF ( ALLOCATED(InData%FSP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSP )  ! FSP 
  IF ( ALLOCATED(InData%FSP1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSP1 )  ! FSP1 
  IF ( ALLOCATED(InData%FSPC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC )  ! FSPC 
  IF ( ALLOCATED(InData%FSPC1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC1 )  ! FSPC1 
  IF ( ALLOCATED(InData%FTB) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FTB )  ! FTB 
  IF ( ALLOCATED(InData%FTBC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%FTBC )  ! FTBC 
  IF ( ALLOCATED(InData%OLDCNV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDCNV )  ! OLDCNV 
  IF ( ALLOCATED(InData%OLDDF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDF )  ! OLDDF 
  IF ( ALLOCATED(InData%OLDDFC) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDFC )  ! OLDDFC 
  IF ( ALLOCATED(InData%OLDDN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDN )  ! OLDDN 
  IF ( ALLOCATED(InData%OLDDPP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDPP )  ! OLDDPP 
  IF ( ALLOCATED(InData%OLDDQ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDQ )  ! OLDDQ 
  IF ( ALLOCATED(InData%OLDTAU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDTAU )  ! OLDTAU 
  IF ( ALLOCATED(InData%OLDXN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDXN )  ! OLDXN 
  IF ( ALLOCATED(InData%OLDYN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLDYN )  ! OLDYN 
  IF ( ALLOCATED(InData%QX) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QX )  ! QX 
  IF ( ALLOCATED(InData%QX1) )   Re_BufSz    = Re_BufSz    + SIZE( InData%QX1 )  ! QX1 
  IF ( ALLOCATED(InData%TAU) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TAU )  ! TAU 
  IF ( ALLOCATED(InData%XN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%XN )  ! XN 
  IF ( ALLOCATED(InData%YN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%YN )  ! YN 
  Int_BufSz  = Int_BufSz  + 1  ! SHIFT
  Int_BufSz  = Int_BufSz  + 1  ! VOR
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%ADOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT))-1 ) =  PACK(InData%ADOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT)
  ENDIF
  IF ( ALLOCATED(InData%ADOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT1))-1 ) =  PACK(InData%ADOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT1)
  ENDIF
  IF ( ALLOCATED(InData%AFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE))-1 ) =  PACK(InData%AFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE)
  ENDIF
  IF ( ALLOCATED(InData%AFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE1))-1 ) =  PACK(InData%AFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%ANE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE))-1 ) =  PACK(InData%ANE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE)
  ENDIF
  IF ( ALLOCATED(InData%ANE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE1))-1 ) =  PACK(InData%ANE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE1)
  ENDIF
  IF ( ALLOCATED(InData%AOD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOD))-1 ) =  PACK(InData%AOD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOD)
  ENDIF
  IF ( ALLOCATED(InData%AOL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOL))-1 ) =  PACK(InData%AOL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOL)
  ENDIF
  IF ( ALLOCATED(InData%BEDSEP) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%BEDSEP))-1 ) = TRANSFER( PACK(InData%BEDSEP ,.TRUE.), IntKiBuf(1), 1)
    Int_Xferred   = Int_Xferred   + SIZE(InData%BEDSEP)
  ENDIF
  IF ( ALLOCATED(InData%OLDSEP) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%OLDSEP))-1 ) = TRANSFER( PACK(InData%OLDSEP ,.TRUE.), IntKiBuf(1), 1)
    Int_Xferred   = Int_Xferred   + SIZE(InData%OLDSEP)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CDO) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDO))-1 ) =  PACK(InData%CDO ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDO)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMI )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNA))-1 ) =  PACK(InData%CNA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNA)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNCP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNIQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP))-1 ) =  PACK(InData%CNP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP)
  ENDIF
  IF ( ALLOCATED(InData%CNP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP1))-1 ) =  PACK(InData%CNP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP1)
  ENDIF
  IF ( ALLOCATED(InData%CNPD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD))-1 ) =  PACK(InData%CNPD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD)
  ENDIF
  IF ( ALLOCATED(InData%CNPD1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD1))-1 ) =  PACK(InData%CNPD1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD1)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT))-1 ) =  PACK(InData%CNPOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT1))-1 ) =  PACK(InData%CNPOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(InData%CNS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNS))-1 ) =  PACK(InData%CNS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNS)
  ENDIF
  IF ( ALLOCATED(InData%CNSL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNSL))-1 ) =  PACK(InData%CNSL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNSL)
  ENDIF
  IF ( ALLOCATED(InData%CNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNV))-1 ) =  PACK(InData%CNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNV)
  ENDIF
  IF ( ALLOCATED(InData%CVN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN))-1 ) =  PACK(InData%CVN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN)
  ENDIF
  IF ( ALLOCATED(InData%CVN1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN1))-1 ) =  PACK(InData%CVN1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN1)
  ENDIF
  IF ( ALLOCATED(InData%DF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DF))-1 ) =  PACK(InData%DF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DF)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE))-1 ) =  PACK(InData%DFAFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE1))-1 ) =  PACK(InData%DFAFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(InData%DFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFC))-1 ) =  PACK(InData%DFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFC)
  ENDIF
  IF ( ALLOCATED(InData%DN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DN))-1 ) =  PACK(InData%DN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DN)
  ENDIF
  IF ( ALLOCATED(InData%DPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DPP))-1 ) =  PACK(InData%DPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DPP)
  ENDIF
  IF ( ALLOCATED(InData%DQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQ))-1 ) =  PACK(InData%DQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQ)
  ENDIF
  IF ( ALLOCATED(InData%DQP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP))-1 ) =  PACK(InData%DQP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP)
  ENDIF
  IF ( ALLOCATED(InData%DQP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP1))-1 ) =  PACK(InData%DQP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FK )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FPC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%FSP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP))-1 ) =  PACK(InData%FSP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP)
  ENDIF
  IF ( ALLOCATED(InData%FSP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP1))-1 ) =  PACK(InData%FSP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP1)
  ENDIF
  IF ( ALLOCATED(InData%FSPC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC))-1 ) =  PACK(InData%FSPC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC)
  ENDIF
  IF ( ALLOCATED(InData%FSPC1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC1))-1 ) =  PACK(InData%FSPC1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC1)
  ENDIF
  IF ( ALLOCATED(InData%FTB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTB))-1 ) =  PACK(InData%FTB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTB)
  ENDIF
  IF ( ALLOCATED(InData%FTBC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTBC))-1 ) =  PACK(InData%FTBC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTBC)
  ENDIF
  IF ( ALLOCATED(InData%OLDCNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDCNV))-1 ) =  PACK(InData%OLDCNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(InData%OLDDF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDF))-1 ) =  PACK(InData%OLDDF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDF)
  ENDIF
  IF ( ALLOCATED(InData%OLDDFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDFC))-1 ) =  PACK(InData%OLDDFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(InData%OLDDN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDN))-1 ) =  PACK(InData%OLDDN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDN)
  ENDIF
  IF ( ALLOCATED(InData%OLDDPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDPP))-1 ) =  PACK(InData%OLDDPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(InData%OLDDQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDQ))-1 ) =  PACK(InData%OLDDQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(InData%OLDTAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDTAU))-1 ) =  PACK(InData%OLDTAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(InData%OLDXN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDXN))-1 ) =  PACK(InData%OLDXN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDXN)
  ENDIF
  IF ( ALLOCATED(InData%OLDYN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDYN))-1 ) =  PACK(InData%OLDYN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDYN)
  ENDIF
  IF ( ALLOCATED(InData%QX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX))-1 ) =  PACK(InData%QX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX)
  ENDIF
  IF ( ALLOCATED(InData%QX1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX1))-1 ) =  PACK(InData%QX1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX1)
  ENDIF
  IF ( ALLOCATED(InData%TAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TAU))-1 ) =  PACK(InData%TAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TAU)
  ENDIF
  IF ( ALLOCATED(InData%XN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%XN))-1 ) =  PACK(InData%XN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%XN)
  ENDIF
  IF ( ALLOCATED(InData%YN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%YN))-1 ) =  PACK(InData%YN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%YN)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SHIFT ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%VOR ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackBeddoes

 SUBROUTINE AD_UnPackBeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Beddoes), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%ADOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT,1),SIZE(OutData%ADOT,2)))
  mask2 = .TRUE.
    OutData%ADOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT))-1 ),mask2,OutData%ADOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT)
  ENDIF
  IF ( ALLOCATED(OutData%ADOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT1,1),SIZE(OutData%ADOT1,2)))
  mask2 = .TRUE.
    OutData%ADOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT1))-1 ),mask2,OutData%ADOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT1)
  ENDIF
  IF ( ALLOCATED(OutData%AFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE,1),SIZE(OutData%AFE,2)))
  mask2 = .TRUE.
    OutData%AFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE))-1 ),mask2,OutData%AFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE)
  ENDIF
  IF ( ALLOCATED(OutData%AFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE1,1),SIZE(OutData%AFE1,2)))
  mask2 = .TRUE.
    OutData%AFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE1))-1 ),mask2,OutData%AFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE1)
  ENDIF
  OutData%AN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%ANE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE,1),SIZE(OutData%ANE,2)))
  mask2 = .TRUE.
    OutData%ANE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE))-1 ),mask2,OutData%ANE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE)
  ENDIF
  IF ( ALLOCATED(OutData%ANE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE1,1),SIZE(OutData%ANE1,2)))
  mask2 = .TRUE.
    OutData%ANE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE1))-1 ),mask2,OutData%ANE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE1)
  ENDIF
  IF ( ALLOCATED(OutData%AOD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOD,1),SIZE(OutData%AOD,2)))
  mask2 = .TRUE.
    OutData%AOD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOD))-1 ),mask2,OutData%AOD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOD)
  ENDIF
  IF ( ALLOCATED(OutData%AOL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOL,1),SIZE(OutData%AOL,2)))
  mask2 = .TRUE.
    OutData%AOL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOL))-1 ),mask2,OutData%AOL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOL)
  ENDIF
  IF ( ALLOCATED(OutData%BEDSEP) ) THEN
  ENDIF
  IF ( ALLOCATED(OutData%OLDSEP) ) THEN
  ENDIF
  OutData%CC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CDO) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CDO,1),SIZE(OutData%CDO,2)))
  mask2 = .TRUE.
    OutData%CDO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDO))-1 ),mask2,OutData%CDO)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDO)
  ENDIF
  OutData%CMI = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CMQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNA,1),SIZE(OutData%CNA,2)))
  mask2 = .TRUE.
    OutData%CNA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNA))-1 ),mask2,OutData%CNA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNA)
  ENDIF
  OutData%CNCP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CNIQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP,1),SIZE(OutData%CNP,2)))
  mask2 = .TRUE.
    OutData%CNP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP))-1 ),mask2,OutData%CNP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP)
  ENDIF
  IF ( ALLOCATED(OutData%CNP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP1,1),SIZE(OutData%CNP1,2)))
  mask2 = .TRUE.
    OutData%CNP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP1))-1 ),mask2,OutData%CNP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD,1),SIZE(OutData%CNPD,2)))
  mask2 = .TRUE.
    OutData%CNPD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD))-1 ),mask2,OutData%CNPD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD1,1),SIZE(OutData%CNPD1,2)))
  mask2 = .TRUE.
    OutData%CNPD1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD1))-1 ),mask2,OutData%CNPD1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT,1),SIZE(OutData%CNPOT,2)))
  mask2 = .TRUE.
    OutData%CNPOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT))-1 ),mask2,OutData%CNPOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT1,1),SIZE(OutData%CNPOT1,2)))
  mask2 = .TRUE.
    OutData%CNPOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT1))-1 ),mask2,OutData%CNPOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(OutData%CNS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNS,1),SIZE(OutData%CNS,2)))
  mask2 = .TRUE.
    OutData%CNS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNS))-1 ),mask2,OutData%CNS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNS)
  ENDIF
  IF ( ALLOCATED(OutData%CNSL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNSL,1),SIZE(OutData%CNSL,2)))
  mask2 = .TRUE.
    OutData%CNSL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNSL))-1 ),mask2,OutData%CNSL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNSL)
  ENDIF
  IF ( ALLOCATED(OutData%CNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNV,1),SIZE(OutData%CNV,2)))
  mask2 = .TRUE.
    OutData%CNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNV))-1 ),mask2,OutData%CNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNV)
  ENDIF
  IF ( ALLOCATED(OutData%CVN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN,1),SIZE(OutData%CVN,2)))
  mask2 = .TRUE.
    OutData%CVN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN))-1 ),mask2,OutData%CVN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN)
  ENDIF
  IF ( ALLOCATED(OutData%CVN1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN1,1),SIZE(OutData%CVN1,2)))
  mask2 = .TRUE.
    OutData%CVN1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN1))-1 ),mask2,OutData%CVN1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN1)
  ENDIF
  IF ( ALLOCATED(OutData%DF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DF,1),SIZE(OutData%DF,2)))
  mask2 = .TRUE.
    OutData%DF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DF))-1 ),mask2,OutData%DF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DF)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE,1),SIZE(OutData%DFAFE,2)))
  mask2 = .TRUE.
    OutData%DFAFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE))-1 ),mask2,OutData%DFAFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE1,1),SIZE(OutData%DFAFE1,2)))
  mask2 = .TRUE.
    OutData%DFAFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE1))-1 ),mask2,OutData%DFAFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(OutData%DFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFC,1),SIZE(OutData%DFC,2)))
  mask2 = .TRUE.
    OutData%DFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFC))-1 ),mask2,OutData%DFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFC)
  ENDIF
  IF ( ALLOCATED(OutData%DN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DN,1),SIZE(OutData%DN,2)))
  mask2 = .TRUE.
    OutData%DN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DN))-1 ),mask2,OutData%DN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DN)
  ENDIF
  IF ( ALLOCATED(OutData%DPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DPP,1),SIZE(OutData%DPP,2)))
  mask2 = .TRUE.
    OutData%DPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DPP))-1 ),mask2,OutData%DPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DPP)
  ENDIF
  IF ( ALLOCATED(OutData%DQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQ,1),SIZE(OutData%DQ,2)))
  mask2 = .TRUE.
    OutData%DQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQ))-1 ),mask2,OutData%DQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQ)
  ENDIF
  IF ( ALLOCATED(OutData%DQP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP,1),SIZE(OutData%DQP,2)))
  mask2 = .TRUE.
    OutData%DQP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP))-1 ),mask2,OutData%DQP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP)
  ENDIF
  IF ( ALLOCATED(OutData%DQP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP1,1),SIZE(OutData%DQP1,2)))
  mask2 = .TRUE.
    OutData%DQP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP1))-1 ),mask2,OutData%DQP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP1)
  ENDIF
  OutData%DS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FK = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FPC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%FSP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP,1),SIZE(OutData%FSP,2)))
  mask2 = .TRUE.
    OutData%FSP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP))-1 ),mask2,OutData%FSP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP)
  ENDIF
  IF ( ALLOCATED(OutData%FSP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP1,1),SIZE(OutData%FSP1,2)))
  mask2 = .TRUE.
    OutData%FSP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP1))-1 ),mask2,OutData%FSP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP1)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC,1),SIZE(OutData%FSPC,2)))
  mask2 = .TRUE.
    OutData%FSPC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC))-1 ),mask2,OutData%FSPC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC1,1),SIZE(OutData%FSPC1,2)))
  mask2 = .TRUE.
    OutData%FSPC1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC1))-1 ),mask2,OutData%FSPC1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC1)
  ENDIF
  IF ( ALLOCATED(OutData%FTB) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTB,1),SIZE(OutData%FTB,2),SIZE(OutData%FTB,3)))
  mask3 = .TRUE.
    OutData%FTB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTB))-1 ),mask3,OutData%FTB)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTB)
  ENDIF
  IF ( ALLOCATED(OutData%FTBC) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTBC,1),SIZE(OutData%FTBC,2),SIZE(OutData%FTBC,3)))
  mask3 = .TRUE.
    OutData%FTBC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTBC))-1 ),mask3,OutData%FTBC)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTBC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDCNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDCNV,1),SIZE(OutData%OLDCNV,2)))
  mask2 = .TRUE.
    OutData%OLDCNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDCNV))-1 ),mask2,OutData%OLDCNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDF,1),SIZE(OutData%OLDDF,2)))
  mask2 = .TRUE.
    OutData%OLDDF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDF))-1 ),mask2,OutData%OLDDF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDF)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDFC,1),SIZE(OutData%OLDDFC,2)))
  mask2 = .TRUE.
    OutData%OLDDFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDFC))-1 ),mask2,OutData%OLDDFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDN,1),SIZE(OutData%OLDDN,2)))
  mask2 = .TRUE.
    OutData%OLDDN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDN))-1 ),mask2,OutData%OLDDN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDPP,1),SIZE(OutData%OLDDPP,2)))
  mask2 = .TRUE.
    OutData%OLDDPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDPP))-1 ),mask2,OutData%OLDDPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDQ,1),SIZE(OutData%OLDDQ,2)))
  mask2 = .TRUE.
    OutData%OLDDQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDQ))-1 ),mask2,OutData%OLDDQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(OutData%OLDTAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDTAU,1),SIZE(OutData%OLDTAU,2)))
  mask2 = .TRUE.
    OutData%OLDTAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDTAU))-1 ),mask2,OutData%OLDTAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(OutData%OLDXN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDXN,1),SIZE(OutData%OLDXN,2)))
  mask2 = .TRUE.
    OutData%OLDXN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDXN))-1 ),mask2,OutData%OLDXN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDXN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDYN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDYN,1),SIZE(OutData%OLDYN,2)))
  mask2 = .TRUE.
    OutData%OLDYN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDYN))-1 ),mask2,OutData%OLDYN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDYN)
  ENDIF
  IF ( ALLOCATED(OutData%QX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX,1),SIZE(OutData%QX,2)))
  mask2 = .TRUE.
    OutData%QX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX))-1 ),mask2,OutData%QX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX)
  ENDIF
  IF ( ALLOCATED(OutData%QX1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX1,1),SIZE(OutData%QX1,2)))
  mask2 = .TRUE.
    OutData%QX1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX1))-1 ),mask2,OutData%QX1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX1)
  ENDIF
  IF ( ALLOCATED(OutData%TAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TAU,1),SIZE(OutData%TAU,2)))
  mask2 = .TRUE.
    OutData%TAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TAU))-1 ),mask2,OutData%TAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TAU)
  ENDIF
  IF ( ALLOCATED(OutData%XN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%XN,1),SIZE(OutData%XN,2)))
  mask2 = .TRUE.
    OutData%XN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%XN))-1 ),mask2,OutData%XN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%XN)
  ENDIF
  IF ( ALLOCATED(OutData%YN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%YN,1),SIZE(OutData%YN,2)))
  mask2 = .TRUE.
    OutData%YN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%YN))-1 ),mask2,OutData%YN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%YN)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBeddoes

 SUBROUTINE AD_CopyBeddoesParms( SrcBeddoesParmsData, DstBeddoesParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BeddoesParms), INTENT(IN) :: SrcBeddoesParmsData
   TYPE(BeddoesParms), INTENT(INOUT) :: DstBeddoesParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstBeddoesParmsData%AS = SrcBeddoesParmsData%AS
   DstBeddoesParmsData%TF = SrcBeddoesParmsData%TF
   DstBeddoesParmsData%TP = SrcBeddoesParmsData%TP
   DstBeddoesParmsData%TV = SrcBeddoesParmsData%TV
   DstBeddoesParmsData%TVL = SrcBeddoesParmsData%TVL
 END SUBROUTINE AD_CopyBeddoesParms

 SUBROUTINE AD_DestroyBeddoesParms( BeddoesParmsData, ErrStat, ErrMsg )
  TYPE(BeddoesParms), INTENT(INOUT) :: BeddoesParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyBeddoesParms

 SUBROUTINE AD_PackBeddoesParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BeddoesParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AS
  Re_BufSz   = Re_BufSz   + 1  ! TF
  Re_BufSz   = Re_BufSz   + 1  ! TP
  Re_BufSz   = Re_BufSz   + 1  ! TV
  Re_BufSz   = Re_BufSz   + 1  ! TVL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TF )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TVL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackBeddoesParms

 SUBROUTINE AD_UnPackBeddoesParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BeddoesParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TF = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TVL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBeddoesParms

 SUBROUTINE AD_CopyBladeParms( SrcBladeParmsData, DstBladeParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(BladeParms), INTENT(IN) :: SrcBladeParmsData
   TYPE(BladeParms), INTENT(INOUT) :: DstBladeParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcBladeParmsData%C)) THEN
   i1_l = LBOUND(SrcBladeParmsData%C,1)
   i1_u = UBOUND(SrcBladeParmsData%C,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%C)) THEN 
      ALLOCATE(DstBladeParmsData%C(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%C.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%C = SrcBladeParmsData%C
ENDIF
IF (ALLOCATED(SrcBladeParmsData%DR)) THEN
   i1_l = LBOUND(SrcBladeParmsData%DR,1)
   i1_u = UBOUND(SrcBladeParmsData%DR,1)
   IF (.NOT. ALLOCATED(DstBladeParmsData%DR)) THEN 
      ALLOCATE(DstBladeParmsData%DR(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstBladeParmsData%DR.', ErrStat, ErrMsg,'AD_CopyBladeParms')
         RETURN
      END IF
   END IF
   DstBladeParmsData%DR = SrcBladeParmsData%DR
ENDIF
   DstBladeParmsData%R = SrcBladeParmsData%R
   DstBladeParmsData%BladeLength = SrcBladeParmsData%BladeLength
 END SUBROUTINE AD_CopyBladeParms

 SUBROUTINE AD_DestroyBladeParms( BladeParmsData, ErrStat, ErrMsg )
  TYPE(BladeParms), INTENT(INOUT) :: BladeParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(BladeParmsData%C)) THEN
   DEALLOCATE(BladeParmsData%C)
ENDIF
IF (ALLOCATED(BladeParmsData%DR)) THEN
   DEALLOCATE(BladeParmsData%DR)
ENDIF
 END SUBROUTINE AD_DestroyBladeParms

 SUBROUTINE AD_PackBladeParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(BladeParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%C) )   Re_BufSz    = Re_BufSz    + SIZE( InData%C )  ! C 
  IF ( ALLOCATED(InData%DR) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DR )  ! DR 
  Re_BufSz   = Re_BufSz   + 1  ! R
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%C) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%C))-1 ) =  PACK(InData%C ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%C)
  ENDIF
  IF ( ALLOCATED(InData%DR) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DR))-1 ) =  PACK(InData%DR ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DR)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%R )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackBladeParms

 SUBROUTINE AD_UnPackBladeParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(BladeParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%C) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C,1)))
  mask1 = .TRUE.
    OutData%C = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%C))-1 ),mask1,OutData%C)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%C)
  ENDIF
  IF ( ALLOCATED(OutData%DR) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DR,1)))
  mask1 = .TRUE.
    OutData%DR = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DR))-1 ),mask1,OutData%DR)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DR)
  ENDIF
  OutData%R = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackBladeParms

 SUBROUTINE AD_CopyDynInflow( SrcDynInflowData, DstDynInflowData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DynInflow), INTENT(IN) :: SrcDynInflowData
   TYPE(DynInflow), INTENT(INOUT) :: DstDynInflowData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDynInflowData%dAlph_dt = SrcDynInflowData%dAlph_dt
   DstDynInflowData%dBeta_dt = SrcDynInflowData%dBeta_dt
   DstDynInflowData%DTO = SrcDynInflowData%DTO
   DstDynInflowData%old_Alph = SrcDynInflowData%old_Alph
   DstDynInflowData%old_Beta = SrcDynInflowData%old_Beta
   DstDynInflowData%old_LmdM = SrcDynInflowData%old_LmdM
   DstDynInflowData%oldKai = SrcDynInflowData%oldKai
   DstDynInflowData%PhiLqC = SrcDynInflowData%PhiLqC
   DstDynInflowData%PhiLqS = SrcDynInflowData%PhiLqS
   DstDynInflowData%Pzero = SrcDynInflowData%Pzero
IF (ALLOCATED(SrcDynInflowData%RMC_SAVE)) THEN
   i1_l = LBOUND(SrcDynInflowData%RMC_SAVE,1)
   i1_u = UBOUND(SrcDynInflowData%RMC_SAVE,1)
   i2_l = LBOUND(SrcDynInflowData%RMC_SAVE,2)
   i2_u = UBOUND(SrcDynInflowData%RMC_SAVE,2)
   i3_l = LBOUND(SrcDynInflowData%RMC_SAVE,3)
   i3_u = UBOUND(SrcDynInflowData%RMC_SAVE,3)
   IF (.NOT. ALLOCATED(DstDynInflowData%RMC_SAVE)) THEN 
      ALLOCATE(DstDynInflowData%RMC_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDynInflowData%RMC_SAVE.', ErrStat, ErrMsg,'AD_CopyDynInflow')
         RETURN
      END IF
   END IF
   DstDynInflowData%RMC_SAVE = SrcDynInflowData%RMC_SAVE
ENDIF
IF (ALLOCATED(SrcDynInflowData%RMS_SAVE)) THEN
   i1_l = LBOUND(SrcDynInflowData%RMS_SAVE,1)
   i1_u = UBOUND(SrcDynInflowData%RMS_SAVE,1)
   i2_l = LBOUND(SrcDynInflowData%RMS_SAVE,2)
   i2_u = UBOUND(SrcDynInflowData%RMS_SAVE,2)
   i3_l = LBOUND(SrcDynInflowData%RMS_SAVE,3)
   i3_u = UBOUND(SrcDynInflowData%RMS_SAVE,3)
   IF (.NOT. ALLOCATED(DstDynInflowData%RMS_SAVE)) THEN 
      ALLOCATE(DstDynInflowData%RMS_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstDynInflowData%RMS_SAVE.', ErrStat, ErrMsg,'AD_CopyDynInflow')
         RETURN
      END IF
   END IF
   DstDynInflowData%RMS_SAVE = SrcDynInflowData%RMS_SAVE
ENDIF
   DstDynInflowData%TipSpeed = SrcDynInflowData%TipSpeed
   DstDynInflowData%totalInf = SrcDynInflowData%totalInf
   DstDynInflowData%Vparam = SrcDynInflowData%Vparam
   DstDynInflowData%Vtotal = SrcDynInflowData%Vtotal
   DstDynInflowData%xAlpha = SrcDynInflowData%xAlpha
   DstDynInflowData%xBeta = SrcDynInflowData%xBeta
   DstDynInflowData%xKai = SrcDynInflowData%xKai
   DstDynInflowData%XLAMBDA_M = SrcDynInflowData%XLAMBDA_M
   DstDynInflowData%xLcos = SrcDynInflowData%xLcos
   DstDynInflowData%xLsin = SrcDynInflowData%xLsin
   DstDynInflowData%MminR = SrcDynInflowData%MminR
   DstDynInflowData%MminusR = SrcDynInflowData%MminusR
   DstDynInflowData%MplusR = SrcDynInflowData%MplusR
   DstDynInflowData%GAMMA = SrcDynInflowData%GAMMA
 END SUBROUTINE AD_CopyDynInflow

 SUBROUTINE AD_DestroyDynInflow( DynInflowData, ErrStat, ErrMsg )
  TYPE(DynInflow), INTENT(INOUT) :: DynInflowData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(DynInflowData%RMC_SAVE)) THEN
   DEALLOCATE(DynInflowData%RMC_SAVE)
ENDIF
IF (ALLOCATED(DynInflowData%RMS_SAVE)) THEN
   DEALLOCATE(DynInflowData%RMS_SAVE)
ENDIF
 END SUBROUTINE AD_DestroyDynInflow

 SUBROUTINE AD_PackDynInflow( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DynInflow),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%dAlph_dt )  ! dAlph_dt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%dBeta_dt )  ! dBeta_dt 
  Re_BufSz   = Re_BufSz   + 1  ! DTO
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Alph )  ! old_Alph 
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Beta )  ! old_Beta 
  Re_BufSz   = Re_BufSz   + 1  ! old_LmdM
  Re_BufSz   = Re_BufSz   + 1  ! oldKai
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqC )  ! PhiLqC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqS )  ! PhiLqS 
  Re_BufSz   = Re_BufSz   + 1  ! Pzero
  IF ( ALLOCATED(InData%RMC_SAVE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RMC_SAVE )  ! RMC_SAVE 
  IF ( ALLOCATED(InData%RMS_SAVE) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RMS_SAVE )  ! RMS_SAVE 
  Re_BufSz   = Re_BufSz   + 1  ! TipSpeed
  Re_BufSz   = Re_BufSz   + 1  ! totalInf
  Re_BufSz   = Re_BufSz   + 1  ! Vparam
  Re_BufSz   = Re_BufSz   + 1  ! Vtotal
  Re_BufSz    = Re_BufSz    + SIZE( InData%xAlpha )  ! xAlpha 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xBeta )  ! xBeta 
  Re_BufSz   = Re_BufSz   + 1  ! xKai
  Re_BufSz   = Re_BufSz   + 1  ! XLAMBDA_M
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLcos )  ! xLcos 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLsin )  ! xLsin 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminR )  ! MminR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminusR )  ! MminusR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MplusR )  ! MplusR 
  Re_BufSz    = Re_BufSz    + SIZE( InData%GAMMA )  ! GAMMA 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dAlph_dt))-1 ) =  PACK(InData%dAlph_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dAlph_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dBeta_dt))-1 ) =  PACK(InData%dBeta_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dBeta_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTO )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Alph))-1 ) =  PACK(InData%old_Alph ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Alph)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Beta))-1 ) =  PACK(InData%old_Beta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Beta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%old_LmdM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%oldKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqC))-1 ) =  PACK(InData%PhiLqC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqC)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqS))-1 ) =  PACK(InData%PhiLqS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqS)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Pzero )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%RMC_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMC_SAVE))-1 ) =  PACK(InData%RMC_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(InData%RMS_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMS_SAVE))-1 ) =  PACK(InData%RMS_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMS_SAVE)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%totalInf )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vparam )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vtotal )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xAlpha))-1 ) =  PACK(InData%xAlpha ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xAlpha)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xBeta))-1 ) =  PACK(InData%xBeta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xBeta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%xKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%XLAMBDA_M )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLcos))-1 ) =  PACK(InData%xLcos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLcos)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLsin))-1 ) =  PACK(InData%xLsin ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLsin)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminR))-1 ) = PACK(InData%MminR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminusR))-1 ) = PACK(InData%MminusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminusR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MplusR))-1 ) = PACK(InData%MplusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MplusR)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%GAMMA))-1 ) =  PACK(InData%GAMMA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%GAMMA)
 END SUBROUTINE AD_PackDynInflow

 SUBROUTINE AD_UnPackDynInflow( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DynInflow), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%dAlph_dt,1),SIZE(OutData%dAlph_dt,2)))
  mask2 = .TRUE.
  OutData%dAlph_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dAlph_dt))-1 ),mask2,OutData%dAlph_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dAlph_dt)
  ALLOCATE(mask2(SIZE(OutData%dBeta_dt,1),SIZE(OutData%dBeta_dt,2)))
  mask2 = .TRUE.
  OutData%dBeta_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dBeta_dt))-1 ),mask2,OutData%dBeta_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dBeta_dt)
  OutData%DTO = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%old_Alph,1)))
  mask1 = .TRUE.
  OutData%old_Alph = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Alph))-1 ),mask1,OutData%old_Alph)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Alph)
  ALLOCATE(mask1(SIZE(OutData%old_Beta,1)))
  mask1 = .TRUE.
  OutData%old_Beta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Beta))-1 ),mask1,OutData%old_Beta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Beta)
  OutData%old_LmdM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%oldKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%PhiLqC,1)))
  mask1 = .TRUE.
  OutData%PhiLqC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqC))-1 ),mask1,OutData%PhiLqC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqC)
  ALLOCATE(mask1(SIZE(OutData%PhiLqS,1)))
  mask1 = .TRUE.
  OutData%PhiLqS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqS))-1 ),mask1,OutData%PhiLqS)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqS)
  OutData%Pzero = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%RMC_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMC_SAVE,1),SIZE(OutData%RMC_SAVE,2),SIZE(OutData%RMC_SAVE,3)))
  mask3 = .TRUE.
    OutData%RMC_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMC_SAVE))-1 ),mask3,OutData%RMC_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(OutData%RMS_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMS_SAVE,1),SIZE(OutData%RMS_SAVE,2),SIZE(OutData%RMS_SAVE,3)))
  mask3 = .TRUE.
    OutData%RMS_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMS_SAVE))-1 ),mask3,OutData%RMS_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMS_SAVE)
  ENDIF
  OutData%TipSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%totalInf = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vparam = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vtotal = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xAlpha,1)))
  mask1 = .TRUE.
  OutData%xAlpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xAlpha))-1 ),mask1,OutData%xAlpha)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xAlpha)
  ALLOCATE(mask1(SIZE(OutData%xBeta,1)))
  mask1 = .TRUE.
  OutData%xBeta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xBeta))-1 ),mask1,OutData%xBeta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xBeta)
  OutData%xKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%XLAMBDA_M = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask2(SIZE(OutData%xLcos,1),SIZE(OutData%xLcos,2)))
  mask2 = .TRUE.
  OutData%xLcos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLcos))-1 ),mask2,OutData%xLcos)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLcos)
  ALLOCATE(mask2(SIZE(OutData%xLsin,1),SIZE(OutData%xLsin,2)))
  mask2 = .TRUE.
  OutData%xLsin = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLsin))-1 ),mask2,OutData%xLsin)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLsin)
  ALLOCATE(mask2(SIZE(OutData%MminR,1),SIZE(OutData%MminR,2)))
  mask2 = .TRUE.
  OutData%MminR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminR))-1 ),mask2,OutData%MminR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminR)
  ALLOCATE(mask2(SIZE(OutData%MminusR,1),SIZE(OutData%MminusR,2)))
  mask2 = .TRUE.
  OutData%MminusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminusR))-1 ),mask2,OutData%MminusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminusR)
  ALLOCATE(mask2(SIZE(OutData%MplusR,1),SIZE(OutData%MplusR,2)))
  mask2 = .TRUE.
  OutData%MplusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MplusR))-1 ),mask2,OutData%MplusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MplusR)
  ALLOCATE(mask2(SIZE(OutData%GAMMA,1),SIZE(OutData%GAMMA,2)))
  mask2 = .TRUE.
  OutData%GAMMA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%GAMMA))-1 ),mask2,OutData%GAMMA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%GAMMA)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDynInflow

 SUBROUTINE AD_CopyDynInflowParms( SrcDynInflowParmsData, DstDynInflowParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(DynInflowParms), INTENT(IN) :: SrcDynInflowParmsData
   TYPE(DynInflowParms), INTENT(INOUT) :: DstDynInflowParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDynInflowParmsData%MAXINFLO = SrcDynInflowParmsData%MAXINFLO
   DstDynInflowParmsData%xMinv = SrcDynInflowParmsData%xMinv
 END SUBROUTINE AD_CopyDynInflowParms

 SUBROUTINE AD_DestroyDynInflowParms( DynInflowParmsData, ErrStat, ErrMsg )
  TYPE(DynInflowParms), INTENT(INOUT) :: DynInflowParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyDynInflowParms

 SUBROUTINE AD_PackDynInflowParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(DynInflowParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MAXINFLO
  Re_BufSz    = Re_BufSz    + SIZE( InData%xMinv )  ! xMinv 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXINFLO )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xMinv))-1 ) =  PACK(InData%xMinv ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xMinv)
 END SUBROUTINE AD_PackDynInflowParms

 SUBROUTINE AD_UnPackDynInflowParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(DynInflowParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MAXINFLO = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xMinv,1)))
  mask1 = .TRUE.
  OutData%xMinv = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xMinv))-1 ),mask1,OutData%xMinv)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xMinv)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDynInflowParms

 SUBROUTINE AD_CopyElement( SrcElementData, DstElementData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Element), INTENT(IN) :: SrcElementData
   TYPE(Element), INTENT(INOUT) :: DstElementData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcElementData%A)) THEN
   i1_l = LBOUND(SrcElementData%A,1)
   i1_u = UBOUND(SrcElementData%A,1)
   i2_l = LBOUND(SrcElementData%A,2)
   i2_u = UBOUND(SrcElementData%A,2)
   IF (.NOT. ALLOCATED(DstElementData%A)) THEN 
      ALLOCATE(DstElementData%A(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%A.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%A = SrcElementData%A
ENDIF
IF (ALLOCATED(SrcElementData%AP)) THEN
   i1_l = LBOUND(SrcElementData%AP,1)
   i1_u = UBOUND(SrcElementData%AP,1)
   i2_l = LBOUND(SrcElementData%AP,2)
   i2_u = UBOUND(SrcElementData%AP,2)
   IF (.NOT. ALLOCATED(DstElementData%AP)) THEN 
      ALLOCATE(DstElementData%AP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%AP.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%AP = SrcElementData%AP
ENDIF
IF (ALLOCATED(SrcElementData%ALPHA)) THEN
   i1_l = LBOUND(SrcElementData%ALPHA,1)
   i1_u = UBOUND(SrcElementData%ALPHA,1)
   i2_l = LBOUND(SrcElementData%ALPHA,2)
   i2_u = UBOUND(SrcElementData%ALPHA,2)
   IF (.NOT. ALLOCATED(DstElementData%ALPHA)) THEN 
      ALLOCATE(DstElementData%ALPHA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%ALPHA.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%ALPHA = SrcElementData%ALPHA
ENDIF
IF (ALLOCATED(SrcElementData%W2)) THEN
   i1_l = LBOUND(SrcElementData%W2,1)
   i1_u = UBOUND(SrcElementData%W2,1)
   i2_l = LBOUND(SrcElementData%W2,2)
   i2_u = UBOUND(SrcElementData%W2,2)
   IF (.NOT. ALLOCATED(DstElementData%W2)) THEN 
      ALLOCATE(DstElementData%W2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%W2.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%W2 = SrcElementData%W2
ENDIF
IF (ALLOCATED(SrcElementData%OLD_A_NS)) THEN
   i1_l = LBOUND(SrcElementData%OLD_A_NS,1)
   i1_u = UBOUND(SrcElementData%OLD_A_NS,1)
   i2_l = LBOUND(SrcElementData%OLD_A_NS,2)
   i2_u = UBOUND(SrcElementData%OLD_A_NS,2)
   IF (.NOT. ALLOCATED(DstElementData%OLD_A_NS)) THEN 
      ALLOCATE(DstElementData%OLD_A_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%OLD_A_NS.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%OLD_A_NS = SrcElementData%OLD_A_NS
ENDIF
IF (ALLOCATED(SrcElementData%OLD_AP_NS)) THEN
   i1_l = LBOUND(SrcElementData%OLD_AP_NS,1)
   i1_u = UBOUND(SrcElementData%OLD_AP_NS,1)
   i2_l = LBOUND(SrcElementData%OLD_AP_NS,2)
   i2_u = UBOUND(SrcElementData%OLD_AP_NS,2)
   IF (.NOT. ALLOCATED(DstElementData%OLD_AP_NS)) THEN 
      ALLOCATE(DstElementData%OLD_AP_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementData%OLD_AP_NS.', ErrStat, ErrMsg,'AD_CopyElement')
         RETURN
      END IF
   END IF
   DstElementData%OLD_AP_NS = SrcElementData%OLD_AP_NS
ENDIF
   DstElementData%PITNOW = SrcElementData%PITNOW
 END SUBROUTINE AD_CopyElement

 SUBROUTINE AD_DestroyElement( ElementData, ErrStat, ErrMsg )
  TYPE(Element), INTENT(INOUT) :: ElementData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElementData%A)) THEN
   DEALLOCATE(ElementData%A)
ENDIF
IF (ALLOCATED(ElementData%AP)) THEN
   DEALLOCATE(ElementData%AP)
ENDIF
IF (ALLOCATED(ElementData%ALPHA)) THEN
   DEALLOCATE(ElementData%ALPHA)
ENDIF
IF (ALLOCATED(ElementData%W2)) THEN
   DEALLOCATE(ElementData%W2)
ENDIF
IF (ALLOCATED(ElementData%OLD_A_NS)) THEN
   DEALLOCATE(ElementData%OLD_A_NS)
ENDIF
IF (ALLOCATED(ElementData%OLD_AP_NS)) THEN
   DEALLOCATE(ElementData%OLD_AP_NS)
ENDIF
 END SUBROUTINE AD_DestroyElement

 SUBROUTINE AD_PackElement( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Element),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%A) )   Re_BufSz    = Re_BufSz    + SIZE( InData%A )  ! A 
  IF ( ALLOCATED(InData%AP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AP )  ! AP 
  IF ( ALLOCATED(InData%ALPHA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ALPHA )  ! ALPHA 
  IF ( ALLOCATED(InData%W2) )   Re_BufSz    = Re_BufSz    + SIZE( InData%W2 )  ! W2 
  IF ( ALLOCATED(InData%OLD_A_NS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_A_NS )  ! OLD_A_NS 
  IF ( ALLOCATED(InData%OLD_AP_NS) )   Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_AP_NS )  ! OLD_AP_NS 
  Re_BufSz   = Re_BufSz   + 1  ! PITNOW
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%A) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%A))-1 ) =  PACK(InData%A ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%A)
  ENDIF
  IF ( ALLOCATED(InData%AP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AP))-1 ) =  PACK(InData%AP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AP)
  ENDIF
  IF ( ALLOCATED(InData%ALPHA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALPHA))-1 ) =  PACK(InData%ALPHA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALPHA)
  ENDIF
  IF ( ALLOCATED(InData%W2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%W2))-1 ) =  PACK(InData%W2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%W2)
  ENDIF
  IF ( ALLOCATED(InData%OLD_A_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_A_NS))-1 ) =  PACK(InData%OLD_A_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(InData%OLD_AP_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_AP_NS))-1 ) =  PACK(InData%OLD_AP_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_AP_NS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PITNOW )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackElement

 SUBROUTINE AD_UnPackElement( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Element), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%A) ) THEN
  ALLOCATE(mask2(SIZE(OutData%A,1),SIZE(OutData%A,2)))
  mask2 = .TRUE.
    OutData%A = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%A))-1 ),mask2,OutData%A)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%A)
  ENDIF
  IF ( ALLOCATED(OutData%AP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AP,1),SIZE(OutData%AP,2)))
  mask2 = .TRUE.
    OutData%AP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AP))-1 ),mask2,OutData%AP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AP)
  ENDIF
  IF ( ALLOCATED(OutData%ALPHA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ALPHA,1),SIZE(OutData%ALPHA,2)))
  mask2 = .TRUE.
    OutData%ALPHA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALPHA))-1 ),mask2,OutData%ALPHA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALPHA)
  ENDIF
  IF ( ALLOCATED(OutData%W2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%W2,1),SIZE(OutData%W2,2)))
  mask2 = .TRUE.
    OutData%W2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%W2))-1 ),mask2,OutData%W2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%W2)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_A_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_A_NS,1),SIZE(OutData%OLD_A_NS,2)))
  mask2 = .TRUE.
    OutData%OLD_A_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_A_NS))-1 ),mask2,OutData%OLD_A_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_AP_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_AP_NS,1),SIZE(OutData%OLD_AP_NS,2)))
  mask2 = .TRUE.
    OutData%OLD_AP_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_AP_NS))-1 ),mask2,OutData%OLD_AP_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_AP_NS)
  ENDIF
  OutData%PITNOW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElement

 SUBROUTINE AD_CopyElementParms( SrcElementParmsData, DstElementParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ElementParms), INTENT(IN) :: SrcElementParmsData
   TYPE(ElementParms), INTENT(INOUT) :: DstElementParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstElementParmsData%NELM = SrcElementParmsData%NELM
IF (ALLOCATED(SrcElementParmsData%TWIST)) THEN
   i1_l = LBOUND(SrcElementParmsData%TWIST,1)
   i1_u = UBOUND(SrcElementParmsData%TWIST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%TWIST)) THEN 
      ALLOCATE(DstElementParmsData%TWIST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%TWIST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%TWIST = SrcElementParmsData%TWIST
ENDIF
IF (ALLOCATED(SrcElementParmsData%RELM)) THEN
   i1_l = LBOUND(SrcElementParmsData%RELM,1)
   i1_u = UBOUND(SrcElementParmsData%RELM,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%RELM)) THEN 
      ALLOCATE(DstElementParmsData%RELM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%RELM.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%RELM = SrcElementParmsData%RELM
ENDIF
IF (ALLOCATED(SrcElementParmsData%HLCNST)) THEN
   i1_l = LBOUND(SrcElementParmsData%HLCNST,1)
   i1_u = UBOUND(SrcElementParmsData%HLCNST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%HLCNST)) THEN 
      ALLOCATE(DstElementParmsData%HLCNST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%HLCNST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%HLCNST = SrcElementParmsData%HLCNST
ENDIF
IF (ALLOCATED(SrcElementParmsData%TLCNST)) THEN
   i1_l = LBOUND(SrcElementParmsData%TLCNST,1)
   i1_u = UBOUND(SrcElementParmsData%TLCNST,1)
   IF (.NOT. ALLOCATED(DstElementParmsData%TLCNST)) THEN 
      ALLOCATE(DstElementParmsData%TLCNST(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElementParmsData%TLCNST.', ErrStat, ErrMsg,'AD_CopyElementParms')
         RETURN
      END IF
   END IF
   DstElementParmsData%TLCNST = SrcElementParmsData%TLCNST
ENDIF
 END SUBROUTINE AD_CopyElementParms

 SUBROUTINE AD_DestroyElementParms( ElementParmsData, ErrStat, ErrMsg )
  TYPE(ElementParms), INTENT(INOUT) :: ElementParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElementParmsData%TWIST)) THEN
   DEALLOCATE(ElementParmsData%TWIST)
ENDIF
IF (ALLOCATED(ElementParmsData%RELM)) THEN
   DEALLOCATE(ElementParmsData%RELM)
ENDIF
IF (ALLOCATED(ElementParmsData%HLCNST)) THEN
   DEALLOCATE(ElementParmsData%HLCNST)
ENDIF
IF (ALLOCATED(ElementParmsData%TLCNST)) THEN
   DEALLOCATE(ElementParmsData%TLCNST)
ENDIF
 END SUBROUTINE AD_DestroyElementParms

 SUBROUTINE AD_PackElementParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ElementParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NELM
  IF ( ALLOCATED(InData%TWIST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TWIST )  ! TWIST 
  IF ( ALLOCATED(InData%RELM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%RELM )  ! RELM 
  IF ( ALLOCATED(InData%HLCNST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%HLCNST )  ! HLCNST 
  IF ( ALLOCATED(InData%TLCNST) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TLCNST )  ! TLCNST 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NELM )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TWIST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TWIST))-1 ) =  PACK(InData%TWIST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TWIST)
  ENDIF
  IF ( ALLOCATED(InData%RELM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RELM))-1 ) =  PACK(InData%RELM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RELM)
  ENDIF
  IF ( ALLOCATED(InData%HLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HLCNST))-1 ) =  PACK(InData%HLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HLCNST)
  ENDIF
  IF ( ALLOCATED(InData%TLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TLCNST))-1 ) =  PACK(InData%TLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TLCNST)
  ENDIF
 END SUBROUTINE AD_PackElementParms

 SUBROUTINE AD_UnPackElementParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ElementParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NELM = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TWIST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TWIST,1)))
  mask1 = .TRUE.
    OutData%TWIST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TWIST))-1 ),mask1,OutData%TWIST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TWIST)
  ENDIF
  IF ( ALLOCATED(OutData%RELM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RELM,1)))
  mask1 = .TRUE.
    OutData%RELM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RELM))-1 ),mask1,OutData%RELM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RELM)
  ENDIF
  IF ( ALLOCATED(OutData%HLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HLCNST,1)))
  mask1 = .TRUE.
    OutData%HLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HLCNST))-1 ),mask1,OutData%HLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HLCNST)
  ENDIF
  IF ( ALLOCATED(OutData%TLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TLCNST,1)))
  mask1 = .TRUE.
    OutData%TLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TLCNST))-1 ),mask1,OutData%TLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TLCNST)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElementParms

 SUBROUTINE AD_CopyElOutParms( SrcElOutParmsData, DstElOutParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(ElOutParms), INTENT(IN) :: SrcElOutParmsData
   TYPE(ElOutParms), INTENT(INOUT) :: DstElOutParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcElOutParmsData%AAA)) THEN
   i1_l = LBOUND(SrcElOutParmsData%AAA,1)
   i1_u = UBOUND(SrcElOutParmsData%AAA,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%AAA)) THEN 
      ALLOCATE(DstElOutParmsData%AAA(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%AAA.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%AAA = SrcElOutParmsData%AAA
ENDIF
IF (ALLOCATED(SrcElOutParmsData%AAP)) THEN
   i1_l = LBOUND(SrcElOutParmsData%AAP,1)
   i1_u = UBOUND(SrcElOutParmsData%AAP,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%AAP)) THEN 
      ALLOCATE(DstElOutParmsData%AAP(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%AAP.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%AAP = SrcElOutParmsData%AAP
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ALF)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ALF,1)
   i1_u = UBOUND(SrcElOutParmsData%ALF,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ALF)) THEN 
      ALLOCATE(DstElOutParmsData%ALF(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ALF.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ALF = SrcElOutParmsData%ALF
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CDD)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CDD,1)
   i1_u = UBOUND(SrcElOutParmsData%CDD,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CDD)) THEN 
      ALLOCATE(DstElOutParmsData%CDD(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CDD.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CDD = SrcElOutParmsData%CDD
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CLL)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CLL,1)
   i1_u = UBOUND(SrcElOutParmsData%CLL,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CLL)) THEN 
      ALLOCATE(DstElOutParmsData%CLL(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CLL.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CLL = SrcElOutParmsData%CLL
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CMM)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CMM,1)
   i1_u = UBOUND(SrcElOutParmsData%CMM,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CMM)) THEN 
      ALLOCATE(DstElOutParmsData%CMM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CMM.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CMM = SrcElOutParmsData%CMM
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CNN)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CNN,1)
   i1_u = UBOUND(SrcElOutParmsData%CNN,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CNN)) THEN 
      ALLOCATE(DstElOutParmsData%CNN(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CNN.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CNN = SrcElOutParmsData%CNN
ENDIF
IF (ALLOCATED(SrcElOutParmsData%CTT)) THEN
   i1_l = LBOUND(SrcElOutParmsData%CTT,1)
   i1_u = UBOUND(SrcElOutParmsData%CTT,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%CTT)) THEN 
      ALLOCATE(DstElOutParmsData%CTT(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%CTT.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%CTT = SrcElOutParmsData%CTT
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DFNSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DFNSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%DFNSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DFNSAV)) THEN 
      ALLOCATE(DstElOutParmsData%DFNSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DFNSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DFNSAV = SrcElOutParmsData%DFNSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DFTSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DFTSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%DFTSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DFTSAV)) THEN 
      ALLOCATE(DstElOutParmsData%DFTSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DFTSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DFTSAV = SrcElOutParmsData%DFTSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%DynPres)) THEN
   i1_l = LBOUND(SrcElOutParmsData%DynPres,1)
   i1_u = UBOUND(SrcElOutParmsData%DynPres,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%DynPres)) THEN 
      ALLOCATE(DstElOutParmsData%DynPres(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%DynPres.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%DynPres = SrcElOutParmsData%DynPres
ENDIF
IF (ALLOCATED(SrcElOutParmsData%PMM)) THEN
   i1_l = LBOUND(SrcElOutParmsData%PMM,1)
   i1_u = UBOUND(SrcElOutParmsData%PMM,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%PMM)) THEN 
      ALLOCATE(DstElOutParmsData%PMM(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%PMM.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%PMM = SrcElOutParmsData%PMM
ENDIF
IF (ALLOCATED(SrcElOutParmsData%PITSAV)) THEN
   i1_l = LBOUND(SrcElOutParmsData%PITSAV,1)
   i1_u = UBOUND(SrcElOutParmsData%PITSAV,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%PITSAV)) THEN 
      ALLOCATE(DstElOutParmsData%PITSAV(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%PITSAV.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%PITSAV = SrcElOutParmsData%PITSAV
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ReyNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ReyNum,1)
   i1_u = UBOUND(SrcElOutParmsData%ReyNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ReyNum)) THEN 
      ALLOCATE(DstElOutParmsData%ReyNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ReyNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ReyNum = SrcElOutParmsData%ReyNum
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVX)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVX,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVX,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVX,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVX,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVX)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVX.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVX = SrcElOutParmsData%SaveVX
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVY)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVY,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVY,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVY,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVY,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVY)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVY(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVY.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVY = SrcElOutParmsData%SaveVY
ENDIF
IF (ALLOCATED(SrcElOutParmsData%SaveVZ)) THEN
   i1_l = LBOUND(SrcElOutParmsData%SaveVZ,1)
   i1_u = UBOUND(SrcElOutParmsData%SaveVZ,1)
   i2_l = LBOUND(SrcElOutParmsData%SaveVZ,2)
   i2_u = UBOUND(SrcElOutParmsData%SaveVZ,2)
   IF (.NOT. ALLOCATED(DstElOutParmsData%SaveVZ)) THEN 
      ALLOCATE(DstElOutParmsData%SaveVZ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%SaveVZ.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%SaveVZ = SrcElOutParmsData%SaveVZ
ENDIF
   DstElOutParmsData%VXSAV = SrcElOutParmsData%VXSAV
   DstElOutParmsData%VYSAV = SrcElOutParmsData%VYSAV
   DstElOutParmsData%VZSAV = SrcElOutParmsData%VZSAV
   DstElOutParmsData%NumWndElOut = SrcElOutParmsData%NumWndElOut
IF (ALLOCATED(SrcElOutParmsData%WndElPrList)) THEN
   i1_l = LBOUND(SrcElOutParmsData%WndElPrList,1)
   i1_u = UBOUND(SrcElOutParmsData%WndElPrList,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%WndElPrList)) THEN 
      ALLOCATE(DstElOutParmsData%WndElPrList(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%WndElPrList.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%WndElPrList = SrcElOutParmsData%WndElPrList
ENDIF
IF (ALLOCATED(SrcElOutParmsData%WndElPrNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%WndElPrNum,1)
   i1_u = UBOUND(SrcElOutParmsData%WndElPrNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%WndElPrNum)) THEN 
      ALLOCATE(DstElOutParmsData%WndElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%WndElPrNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%WndElPrNum = SrcElOutParmsData%WndElPrNum
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ElPrList)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ElPrList,1)
   i1_u = UBOUND(SrcElOutParmsData%ElPrList,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ElPrList)) THEN 
      ALLOCATE(DstElOutParmsData%ElPrList(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ElPrList.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ElPrList = SrcElOutParmsData%ElPrList
ENDIF
IF (ALLOCATED(SrcElOutParmsData%ElPrNum)) THEN
   i1_l = LBOUND(SrcElOutParmsData%ElPrNum,1)
   i1_u = UBOUND(SrcElOutParmsData%ElPrNum,1)
   IF (.NOT. ALLOCATED(DstElOutParmsData%ElPrNum)) THEN 
      ALLOCATE(DstElOutParmsData%ElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstElOutParmsData%ElPrNum.', ErrStat, ErrMsg,'AD_CopyElOutParms')
         RETURN
      END IF
   END IF
   DstElOutParmsData%ElPrNum = SrcElOutParmsData%ElPrNum
ENDIF
   DstElOutParmsData%NumElOut = SrcElOutParmsData%NumElOut
 END SUBROUTINE AD_CopyElOutParms

 SUBROUTINE AD_DestroyElOutParms( ElOutParmsData, ErrStat, ErrMsg )
  TYPE(ElOutParms), INTENT(INOUT) :: ElOutParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(ElOutParmsData%AAA)) THEN
   DEALLOCATE(ElOutParmsData%AAA)
ENDIF
IF (ALLOCATED(ElOutParmsData%AAP)) THEN
   DEALLOCATE(ElOutParmsData%AAP)
ENDIF
IF (ALLOCATED(ElOutParmsData%ALF)) THEN
   DEALLOCATE(ElOutParmsData%ALF)
ENDIF
IF (ALLOCATED(ElOutParmsData%CDD)) THEN
   DEALLOCATE(ElOutParmsData%CDD)
ENDIF
IF (ALLOCATED(ElOutParmsData%CLL)) THEN
   DEALLOCATE(ElOutParmsData%CLL)
ENDIF
IF (ALLOCATED(ElOutParmsData%CMM)) THEN
   DEALLOCATE(ElOutParmsData%CMM)
ENDIF
IF (ALLOCATED(ElOutParmsData%CNN)) THEN
   DEALLOCATE(ElOutParmsData%CNN)
ENDIF
IF (ALLOCATED(ElOutParmsData%CTT)) THEN
   DEALLOCATE(ElOutParmsData%CTT)
ENDIF
IF (ALLOCATED(ElOutParmsData%DFNSAV)) THEN
   DEALLOCATE(ElOutParmsData%DFNSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%DFTSAV)) THEN
   DEALLOCATE(ElOutParmsData%DFTSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%DynPres)) THEN
   DEALLOCATE(ElOutParmsData%DynPres)
ENDIF
IF (ALLOCATED(ElOutParmsData%PMM)) THEN
   DEALLOCATE(ElOutParmsData%PMM)
ENDIF
IF (ALLOCATED(ElOutParmsData%PITSAV)) THEN
   DEALLOCATE(ElOutParmsData%PITSAV)
ENDIF
IF (ALLOCATED(ElOutParmsData%ReyNum)) THEN
   DEALLOCATE(ElOutParmsData%ReyNum)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVX)) THEN
   DEALLOCATE(ElOutParmsData%SaveVX)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVY)) THEN
   DEALLOCATE(ElOutParmsData%SaveVY)
ENDIF
IF (ALLOCATED(ElOutParmsData%SaveVZ)) THEN
   DEALLOCATE(ElOutParmsData%SaveVZ)
ENDIF
IF (ALLOCATED(ElOutParmsData%WndElPrList)) THEN
   DEALLOCATE(ElOutParmsData%WndElPrList)
ENDIF
IF (ALLOCATED(ElOutParmsData%WndElPrNum)) THEN
   DEALLOCATE(ElOutParmsData%WndElPrNum)
ENDIF
IF (ALLOCATED(ElOutParmsData%ElPrList)) THEN
   DEALLOCATE(ElOutParmsData%ElPrList)
ENDIF
IF (ALLOCATED(ElOutParmsData%ElPrNum)) THEN
   DEALLOCATE(ElOutParmsData%ElPrNum)
ENDIF
 END SUBROUTINE AD_DestroyElOutParms

 SUBROUTINE AD_PackElOutParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(ElOutParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%AAA) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AAA )  ! AAA 
  IF ( ALLOCATED(InData%AAP) )   Re_BufSz    = Re_BufSz    + SIZE( InData%AAP )  ! AAP 
  IF ( ALLOCATED(InData%ALF) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ALF )  ! ALF 
  IF ( ALLOCATED(InData%CDD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CDD )  ! CDD 
  IF ( ALLOCATED(InData%CLL) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CLL )  ! CLL 
  IF ( ALLOCATED(InData%CMM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CMM )  ! CMM 
  IF ( ALLOCATED(InData%CNN) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CNN )  ! CNN 
  IF ( ALLOCATED(InData%CTT) )   Re_BufSz    = Re_BufSz    + SIZE( InData%CTT )  ! CTT 
  IF ( ALLOCATED(InData%DFNSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFNSAV )  ! DFNSAV 
  IF ( ALLOCATED(InData%DFTSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DFTSAV )  ! DFTSAV 
  IF ( ALLOCATED(InData%DynPres) )   Re_BufSz    = Re_BufSz    + SIZE( InData%DynPres )  ! DynPres 
  IF ( ALLOCATED(InData%PMM) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PMM )  ! PMM 
  IF ( ALLOCATED(InData%PITSAV) )   Re_BufSz    = Re_BufSz    + SIZE( InData%PITSAV )  ! PITSAV 
  IF ( ALLOCATED(InData%ReyNum) )   Re_BufSz    = Re_BufSz    + SIZE( InData%ReyNum )  ! ReyNum 
  IF ( ALLOCATED(InData%SaveVX) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVX )  ! SaveVX 
  IF ( ALLOCATED(InData%SaveVY) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVY )  ! SaveVY 
  IF ( ALLOCATED(InData%SaveVZ) )   Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVZ )  ! SaveVZ 
  Re_BufSz   = Re_BufSz   + 1  ! VXSAV
  Re_BufSz   = Re_BufSz   + 1  ! VYSAV
  Re_BufSz   = Re_BufSz   + 1  ! VZSAV
  Int_BufSz  = Int_BufSz  + 1  ! NumWndElOut
  IF ( ALLOCATED(InData%WndElPrList) )   Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrList )  ! WndElPrList 
  IF ( ALLOCATED(InData%WndElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrNum )  ! WndElPrNum 
  IF ( ALLOCATED(InData%ElPrList) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrList )  ! ElPrList 
  IF ( ALLOCATED(InData%ElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Int_BufSz  = Int_BufSz  + 1  ! NumElOut
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AAA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAA))-1 ) =  PACK(InData%AAA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAA)
  ENDIF
  IF ( ALLOCATED(InData%AAP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAP))-1 ) =  PACK(InData%AAP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAP)
  ENDIF
  IF ( ALLOCATED(InData%ALF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALF))-1 ) =  PACK(InData%ALF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALF)
  ENDIF
  IF ( ALLOCATED(InData%CDD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDD))-1 ) =  PACK(InData%CDD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDD)
  ENDIF
  IF ( ALLOCATED(InData%CLL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CLL))-1 ) =  PACK(InData%CLL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CLL)
  ENDIF
  IF ( ALLOCATED(InData%CMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CMM))-1 ) =  PACK(InData%CMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CMM)
  ENDIF
  IF ( ALLOCATED(InData%CNN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNN))-1 ) =  PACK(InData%CNN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNN)
  ENDIF
  IF ( ALLOCATED(InData%CTT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTT))-1 ) =  PACK(InData%CTT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CTT)
  ENDIF
  IF ( ALLOCATED(InData%DFNSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFNSAV))-1 ) =  PACK(InData%DFNSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(InData%DFTSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFTSAV))-1 ) =  PACK(InData%DFTSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(InData%DynPres) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DynPres))-1 ) =  PACK(InData%DynPres ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DynPres)
  ENDIF
  IF ( ALLOCATED(InData%PMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMM))-1 ) =  PACK(InData%PMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMM)
  ENDIF
  IF ( ALLOCATED(InData%PITSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PITSAV))-1 ) =  PACK(InData%PITSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PITSAV)
  ENDIF
  IF ( ALLOCATED(InData%ReyNum) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ReyNum))-1 ) =  PACK(InData%ReyNum ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ReyNum)
  ENDIF
  IF ( ALLOCATED(InData%SaveVX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVX))-1 ) =  PACK(InData%SaveVX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVX)
  ENDIF
  IF ( ALLOCATED(InData%SaveVY) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVY))-1 ) =  PACK(InData%SaveVY ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVY)
  ENDIF
  IF ( ALLOCATED(InData%SaveVZ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVZ))-1 ) =  PACK(InData%SaveVZ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVZ)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VXSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VYSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VZSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumWndElOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%WndElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrList))-1 ) = PACK(InData%WndElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(InData%WndElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrNum))-1 ) = PACK(InData%WndElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(InData%ElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrList))-1 ) = PACK(InData%ElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrList)
  ENDIF
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumElOut )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackElOutParms

 SUBROUTINE AD_UnPackElOutParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(ElOutParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AAA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAA,1)))
  mask1 = .TRUE.
    OutData%AAA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAA))-1 ),mask1,OutData%AAA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAA)
  ENDIF
  IF ( ALLOCATED(OutData%AAP) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAP,1)))
  mask1 = .TRUE.
    OutData%AAP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAP))-1 ),mask1,OutData%AAP)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAP)
  ENDIF
  IF ( ALLOCATED(OutData%ALF) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ALF,1)))
  mask1 = .TRUE.
    OutData%ALF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALF))-1 ),mask1,OutData%ALF)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALF)
  ENDIF
  IF ( ALLOCATED(OutData%CDD) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CDD,1)))
  mask1 = .TRUE.
    OutData%CDD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDD))-1 ),mask1,OutData%CDD)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDD)
  ENDIF
  IF ( ALLOCATED(OutData%CLL) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CLL,1)))
  mask1 = .TRUE.
    OutData%CLL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CLL))-1 ),mask1,OutData%CLL)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CLL)
  ENDIF
  IF ( ALLOCATED(OutData%CMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CMM,1)))
  mask1 = .TRUE.
    OutData%CMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CMM))-1 ),mask1,OutData%CMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CMM)
  ENDIF
  IF ( ALLOCATED(OutData%CNN) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CNN,1)))
  mask1 = .TRUE.
    OutData%CNN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNN))-1 ),mask1,OutData%CNN)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNN)
  ENDIF
  IF ( ALLOCATED(OutData%CTT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CTT,1)))
  mask1 = .TRUE.
    OutData%CTT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTT))-1 ),mask1,OutData%CTT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CTT)
  ENDIF
  IF ( ALLOCATED(OutData%DFNSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFNSAV,1)))
  mask1 = .TRUE.
    OutData%DFNSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFNSAV))-1 ),mask1,OutData%DFNSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DFTSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFTSAV,1)))
  mask1 = .TRUE.
    OutData%DFTSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFTSAV))-1 ),mask1,OutData%DFTSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DynPres) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DynPres,1)))
  mask1 = .TRUE.
    OutData%DynPres = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DynPres))-1 ),mask1,OutData%DynPres)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DynPres)
  ENDIF
  IF ( ALLOCATED(OutData%PMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PMM,1)))
  mask1 = .TRUE.
    OutData%PMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMM))-1 ),mask1,OutData%PMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMM)
  ENDIF
  IF ( ALLOCATED(OutData%PITSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PITSAV,1)))
  mask1 = .TRUE.
    OutData%PITSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PITSAV))-1 ),mask1,OutData%PITSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PITSAV)
  ENDIF
  IF ( ALLOCATED(OutData%ReyNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ReyNum,1)))
  mask1 = .TRUE.
    OutData%ReyNum = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ReyNum))-1 ),mask1,OutData%ReyNum)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ReyNum)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVX,1),SIZE(OutData%SaveVX,2)))
  mask2 = .TRUE.
    OutData%SaveVX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVX))-1 ),mask2,OutData%SaveVX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVX)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVY) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVY,1),SIZE(OutData%SaveVY,2)))
  mask2 = .TRUE.
    OutData%SaveVY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVY))-1 ),mask2,OutData%SaveVY)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVY)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVZ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVZ,1),SIZE(OutData%SaveVZ,2)))
  mask2 = .TRUE.
    OutData%SaveVZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVZ))-1 ),mask2,OutData%SaveVZ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVZ)
  ENDIF
  OutData%VXSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VYSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VZSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumWndElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%WndElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrList,1)))
  mask1 = .TRUE.
    OutData%WndElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrList))-1 ),mask1,OutData%WndElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%WndElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrNum,1)))
  mask1 = .TRUE.
    OutData%WndElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrNum))-1 ),mask1,OutData%WndElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrList,1)))
  mask1 = .TRUE.
    OutData%ElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrList))-1 ),mask1,OutData%ElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1)))
  mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%NumElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackElOutParms

 SUBROUTINE AD_CopyInducedVel( SrcInducedVelData, DstInducedVelData, CtrlCode, ErrStat, ErrMsg )
   TYPE(InducedVel), INTENT(IN) :: SrcInducedVelData
   TYPE(InducedVel), INTENT(INOUT) :: DstInducedVelData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInducedVelData%SumInFl = SrcInducedVelData%SumInFl
 END SUBROUTINE AD_CopyInducedVel

 SUBROUTINE AD_DestroyInducedVel( InducedVelData, ErrStat, ErrMsg )
  TYPE(InducedVel), INTENT(INOUT) :: InducedVelData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyInducedVel

 SUBROUTINE AD_PackInducedVel( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(InducedVel),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! SumInFl
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SumInFl )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackInducedVel

 SUBROUTINE AD_UnPackInducedVel( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(InducedVel), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%SumInFl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInducedVel

 SUBROUTINE AD_CopyInducedVelParms( SrcInducedVelParmsData, DstInducedVelParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(InducedVelParms), INTENT(IN) :: SrcInducedVelParmsData
   TYPE(InducedVelParms), INTENT(INOUT) :: DstInducedVelParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInducedVelParmsData%AToler = SrcInducedVelParmsData%AToler
   DstInducedVelParmsData%EqAIDmult = SrcInducedVelParmsData%EqAIDmult
   DstInducedVelParmsData%EquilDA = SrcInducedVelParmsData%EquilDA
   DstInducedVelParmsData%EquilDT = SrcInducedVelParmsData%EquilDT
   DstInducedVelParmsData%TLoss = SrcInducedVelParmsData%TLoss
   DstInducedVelParmsData%GTech = SrcInducedVelParmsData%GTech
   DstInducedVelParmsData%HLoss = SrcInducedVelParmsData%HLoss
 END SUBROUTINE AD_CopyInducedVelParms

 SUBROUTINE AD_DestroyInducedVelParms( InducedVelParmsData, ErrStat, ErrMsg )
  TYPE(InducedVelParms), INTENT(INOUT) :: InducedVelParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyInducedVelParms

 SUBROUTINE AD_PackInducedVelParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(InducedVelParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AToler
  Re_BufSz   = Re_BufSz   + 1  ! EqAIDmult
  Int_BufSz  = Int_BufSz  + 1  ! EquilDA
  Int_BufSz  = Int_BufSz  + 1  ! EquilDT
  Int_BufSz  = Int_BufSz  + 1  ! TLoss
  Int_BufSz  = Int_BufSz  + 1  ! GTech
  Int_BufSz  = Int_BufSz  + 1  ! HLoss
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AToler )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%EqAIDmult )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%EquilDA ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%EquilDT ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TLoss ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%GTech ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%HLoss ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_PackInducedVelParms

 SUBROUTINE AD_UnPackInducedVelParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(InducedVelParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AToler = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%EqAIDmult = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInducedVelParms

 SUBROUTINE AD_CopyRotor( SrcRotorData, DstRotorData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Rotor), INTENT(IN) :: SrcRotorData
   TYPE(Rotor), INTENT(INOUT) :: DstRotorData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRotorData%AVGINFL = SrcRotorData%AVGINFL
   DstRotorData%CTILT = SrcRotorData%CTILT
   DstRotorData%CYaw = SrcRotorData%CYaw
   DstRotorData%REVS = SrcRotorData%REVS
   DstRotorData%STILT = SrcRotorData%STILT
   DstRotorData%SYaw = SrcRotorData%SYaw
   DstRotorData%TILT = SrcRotorData%TILT
   DstRotorData%YawAng = SrcRotorData%YawAng
   DstRotorData%YawVEL = SrcRotorData%YawVEL
 END SUBROUTINE AD_CopyRotor

 SUBROUTINE AD_DestroyRotor( RotorData, ErrStat, ErrMsg )
  TYPE(Rotor), INTENT(INOUT) :: RotorData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyRotor

 SUBROUTINE AD_PackRotor( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Rotor),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AVGINFL
  Re_BufSz   = Re_BufSz   + 1  ! CTILT
  Re_BufSz   = Re_BufSz   + 1  ! CYaw
  Re_BufSz   = Re_BufSz   + 1  ! REVS
  Re_BufSz   = Re_BufSz   + 1  ! STILT
  Re_BufSz   = Re_BufSz   + 1  ! SYaw
  Re_BufSz   = Re_BufSz   + 1  ! TILT
  Re_BufSz   = Re_BufSz   + 1  ! YawAng
  Re_BufSz   = Re_BufSz   + 1  ! YawVEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AVGINFL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%REVS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawAng )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawVEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackRotor

 SUBROUTINE AD_UnPackRotor( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Rotor), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AVGINFL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%REVS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawAng = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawVEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackRotor

 SUBROUTINE AD_CopyRotorParms( SrcRotorParmsData, DstRotorParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(RotorParms), INTENT(IN) :: SrcRotorParmsData
   TYPE(RotorParms), INTENT(INOUT) :: DstRotorParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstRotorParmsData%HH = SrcRotorParmsData%HH
 END SUBROUTINE AD_CopyRotorParms

 SUBROUTINE AD_DestroyRotorParms( RotorParmsData, ErrStat, ErrMsg )
  TYPE(RotorParms), INTENT(INOUT) :: RotorParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyRotorParms

 SUBROUTINE AD_PackRotorParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(RotorParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! HH
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HH )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackRotorParms

 SUBROUTINE AD_UnPackRotorParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(RotorParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%HH = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackRotorParms

 SUBROUTINE AD_CopyTwrPropsParms( SrcTwrPropsParmsData, DstTwrPropsParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(TwrPropsParms), INTENT(IN) :: SrcTwrPropsParmsData
   TYPE(TwrPropsParms), INTENT(INOUT) :: DstTwrPropsParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcTwrPropsParmsData%TwrHtFr)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrHtFr,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrHtFr,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrHtFr)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrHtFr(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrHtFr.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrHtFr = SrcTwrPropsParmsData%TwrHtFr
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrWid)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrWid,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrWid,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrWid)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrWid(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrWid.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrWid = SrcTwrPropsParmsData%TwrWid
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrCD)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrCD,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrCD,1)
   i2_l = LBOUND(SrcTwrPropsParmsData%TwrCD,2)
   i2_u = UBOUND(SrcTwrPropsParmsData%TwrCD,2)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrCD)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrCD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrCD.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrCD = SrcTwrPropsParmsData%TwrCD
ENDIF
IF (ALLOCATED(SrcTwrPropsParmsData%TwrRe)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrRe,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrRe,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrRe)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrRe(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrRe.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrRe = SrcTwrPropsParmsData%TwrRe
ENDIF
   DstTwrPropsParmsData%VTwr = SrcTwrPropsParmsData%VTwr
   DstTwrPropsParmsData%Tower_Wake_Constant = SrcTwrPropsParmsData%Tower_Wake_Constant
IF (ALLOCATED(SrcTwrPropsParmsData%NTwrCDCol)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%NTwrCDCol,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%NTwrCDCol,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%NTwrCDCol)) THEN 
      ALLOCATE(DstTwrPropsParmsData%NTwrCDCol(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%NTwrCDCol.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%NTwrCDCol = SrcTwrPropsParmsData%NTwrCDCol
ENDIF
   DstTwrPropsParmsData%NTwrHT = SrcTwrPropsParmsData%NTwrHT
   DstTwrPropsParmsData%NTwrRe = SrcTwrPropsParmsData%NTwrRe
   DstTwrPropsParmsData%NTwrCD = SrcTwrPropsParmsData%NTwrCD
   DstTwrPropsParmsData%TwrPotent = SrcTwrPropsParmsData%TwrPotent
   DstTwrPropsParmsData%TwrShadow = SrcTwrPropsParmsData%TwrShadow
   DstTwrPropsParmsData%ShadHWid = SrcTwrPropsParmsData%ShadHWid
   DstTwrPropsParmsData%TShadC1 = SrcTwrPropsParmsData%TShadC1
   DstTwrPropsParmsData%TShadC2 = SrcTwrPropsParmsData%TShadC2
   DstTwrPropsParmsData%TwrShad = SrcTwrPropsParmsData%TwrShad
   DstTwrPropsParmsData%PJM_Version = SrcTwrPropsParmsData%PJM_Version
   DstTwrPropsParmsData%TwrFile = SrcTwrPropsParmsData%TwrFile
   DstTwrPropsParmsData%T_Shad_Refpt = SrcTwrPropsParmsData%T_Shad_Refpt
   DstTwrPropsParmsData%CalcTwrAero = SrcTwrPropsParmsData%CalcTwrAero
   DstTwrPropsParmsData%NumTwrNodes = SrcTwrPropsParmsData%NumTwrNodes
IF (ALLOCATED(SrcTwrPropsParmsData%TwrNodeWidth)) THEN
   i1_l = LBOUND(SrcTwrPropsParmsData%TwrNodeWidth,1)
   i1_u = UBOUND(SrcTwrPropsParmsData%TwrNodeWidth,1)
   IF (.NOT. ALLOCATED(DstTwrPropsParmsData%TwrNodeWidth)) THEN 
      ALLOCATE(DstTwrPropsParmsData%TwrNodeWidth(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstTwrPropsParmsData%TwrNodeWidth.', ErrStat, ErrMsg,'AD_CopyTwrPropsParms')
         RETURN
      END IF
   END IF
   DstTwrPropsParmsData%TwrNodeWidth = SrcTwrPropsParmsData%TwrNodeWidth
ENDIF
 END SUBROUTINE AD_CopyTwrPropsParms

 SUBROUTINE AD_DestroyTwrPropsParms( TwrPropsParmsData, ErrStat, ErrMsg )
  TYPE(TwrPropsParms), INTENT(INOUT) :: TwrPropsParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(TwrPropsParmsData%TwrHtFr)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrHtFr)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrWid)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrWid)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrCD)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrCD)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrRe)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrRe)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%NTwrCDCol)) THEN
   DEALLOCATE(TwrPropsParmsData%NTwrCDCol)
ENDIF
IF (ALLOCATED(TwrPropsParmsData%TwrNodeWidth)) THEN
   DEALLOCATE(TwrPropsParmsData%TwrNodeWidth)
ENDIF
 END SUBROUTINE AD_DestroyTwrPropsParms

 SUBROUTINE AD_PackTwrPropsParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(TwrPropsParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(InData%TwrHtFr) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrHtFr )  ! TwrHtFr 
  IF ( ALLOCATED(InData%TwrWid) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrWid )  ! TwrWid 
  IF ( ALLOCATED(InData%TwrCD) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrCD )  ! TwrCD 
  IF ( ALLOCATED(InData%TwrRe) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrRe )  ! TwrRe 
  Re_BufSz    = Re_BufSz    + SIZE( InData%VTwr )  ! VTwr 
  Re_BufSz   = Re_BufSz   + 1  ! Tower_Wake_Constant
  IF ( ALLOCATED(InData%NTwrCDCol) )   Int_BufSz   = Int_BufSz   + SIZE( InData%NTwrCDCol )  ! NTwrCDCol 
  Int_BufSz  = Int_BufSz  + 1  ! NTwrHT
  Int_BufSz  = Int_BufSz  + 1  ! NTwrRe
  Int_BufSz  = Int_BufSz  + 1  ! NTwrCD
  Int_BufSz  = Int_BufSz  + 1  ! TwrPotent
  Int_BufSz  = Int_BufSz  + 1  ! TwrShadow
  Re_BufSz   = Re_BufSz   + 1  ! ShadHWid
  Re_BufSz   = Re_BufSz   + 1  ! TShadC1
  Re_BufSz   = Re_BufSz   + 1  ! TShadC2
  Re_BufSz   = Re_BufSz   + 1  ! TwrShad
  Int_BufSz  = Int_BufSz  + 1  ! PJM_Version
!  missing buffer for TwrFile
  Re_BufSz   = Re_BufSz   + 1  ! T_Shad_Refpt
  Int_BufSz  = Int_BufSz  + 1  ! CalcTwrAero
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  IF ( ALLOCATED(InData%TwrNodeWidth) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeWidth )  ! TwrNodeWidth 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%TwrHtFr) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrHtFr))-1 ) =  PACK(InData%TwrHtFr ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(InData%TwrWid) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrWid))-1 ) =  PACK(InData%TwrWid ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrWid)
  ENDIF
  IF ( ALLOCATED(InData%TwrCD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrCD))-1 ) =  PACK(InData%TwrCD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrCD)
  ENDIF
  IF ( ALLOCATED(InData%TwrRe) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrRe))-1 ) =  PACK(InData%TwrRe ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrRe)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%VTwr))-1 ) =  PACK(InData%VTwr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%VTwr)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Tower_Wake_Constant )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%NTwrCDCol) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTwrCDCol))-1 ) = PACK(InData%NTwrCDCol ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTwrCDCol)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrHT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrRe )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrCD )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwrPotent ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%TwrShadow ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShadHWid )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC1 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrShad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PJM_Version ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%T_Shad_Refpt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%CalcTwrAero ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeWidth) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeWidth))-1 ) =  PACK(InData%TwrNodeWidth ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeWidth)
  ENDIF
 END SUBROUTINE AD_PackTwrPropsParms

 SUBROUTINE AD_UnPackTwrPropsParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(TwrPropsParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%TwrHtFr) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrHtFr,1)))
  mask1 = .TRUE.
    OutData%TwrHtFr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrHtFr))-1 ),mask1,OutData%TwrHtFr)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(OutData%TwrWid) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrWid,1)))
  mask1 = .TRUE.
    OutData%TwrWid = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrWid))-1 ),mask1,OutData%TwrWid)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrWid)
  ENDIF
  IF ( ALLOCATED(OutData%TwrCD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrCD,1),SIZE(OutData%TwrCD,2)))
  mask2 = .TRUE.
    OutData%TwrCD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrCD))-1 ),mask2,OutData%TwrCD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrCD)
  ENDIF
  IF ( ALLOCATED(OutData%TwrRe) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrRe,1)))
  mask1 = .TRUE.
    OutData%TwrRe = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrRe))-1 ),mask1,OutData%TwrRe)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrRe)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%VTwr,1)))
  mask1 = .TRUE.
  OutData%VTwr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%VTwr))-1 ),mask1,OutData%VTwr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%VTwr)
  OutData%Tower_Wake_Constant = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%NTwrCDCol) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTwrCDCol,1)))
  mask1 = .TRUE.
    OutData%NTwrCDCol = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTwrCDCol))-1 ),mask1,OutData%NTwrCDCol)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTwrCDCol)
  ENDIF
  OutData%NTwrHT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrRe = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrCD = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ShadHWid = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC1 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrShad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%T_Shad_Refpt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeWidth) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrNodeWidth,1)))
  mask1 = .TRUE.
    OutData%TwrNodeWidth = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeWidth))-1 ),mask1,OutData%TwrNodeWidth)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeWidth)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackTwrPropsParms

 SUBROUTINE AD_CopyWind( SrcWindData, DstWindData, CtrlCode, ErrStat, ErrMsg )
   TYPE(Wind), INTENT(IN) :: SrcWindData
   TYPE(Wind), INTENT(INOUT) :: DstWindData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstWindData%ANGFLW = SrcWindData%ANGFLW
   DstWindData%CDEL = SrcWindData%CDEL
   DstWindData%VROTORX = SrcWindData%VROTORX
   DstWindData%VROTORY = SrcWindData%VROTORY
   DstWindData%VROTORZ = SrcWindData%VROTORZ
   DstWindData%SDEL = SrcWindData%SDEL
 END SUBROUTINE AD_CopyWind

 SUBROUTINE AD_DestroyWind( WindData, ErrStat, ErrMsg )
  TYPE(Wind), INTENT(INOUT) :: WindData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyWind

 SUBROUTINE AD_PackWind( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(Wind),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! ANGFLW
  Re_BufSz   = Re_BufSz   + 1  ! CDEL
  Re_BufSz   = Re_BufSz   + 1  ! VROTORX
  Re_BufSz   = Re_BufSz   + 1  ! VROTORY
  Re_BufSz   = Re_BufSz   + 1  ! VROTORZ
  Re_BufSz   = Re_BufSz   + 1  ! SDEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ANGFLW )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CDEL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORX )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORY )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORZ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SDEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackWind

 SUBROUTINE AD_UnPackWind( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(Wind), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%ANGFLW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORX = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORY = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORZ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackWind

 SUBROUTINE AD_CopyWindParms( SrcWindParmsData, DstWindParmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(WindParms), INTENT(IN) :: SrcWindParmsData
   TYPE(WindParms), INTENT(INOUT) :: DstWindParmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstWindParmsData%Rho = SrcWindParmsData%Rho
   DstWindParmsData%KinVisc = SrcWindParmsData%KinVisc
 END SUBROUTINE AD_CopyWindParms

 SUBROUTINE AD_DestroyWindParms( WindParmsData, ErrStat, ErrMsg )
  TYPE(WindParms), INTENT(INOUT) :: WindParmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyWindParms

 SUBROUTINE AD_PackWindParms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(WindParms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! Rho
  Re_BufSz   = Re_BufSz   + 1  ! KinVisc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Rho )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%KinVisc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_PackWindParms

 SUBROUTINE AD_UnPackWindParms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(WindParms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Rho = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%KinVisc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackWindParms

 SUBROUTINE AD_CopyPositionType( SrcPositionTypeData, DstPositionTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(PositionType), INTENT(IN) :: SrcPositionTypeData
   TYPE(PositionType), INTENT(INOUT) :: DstPositionTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstPositionTypeData%Pos = SrcPositionTypeData%Pos
 END SUBROUTINE AD_CopyPositionType

 SUBROUTINE AD_DestroyPositionType( PositionTypeData, ErrStat, ErrMsg )
  TYPE(PositionType), INTENT(INOUT) :: PositionTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyPositionType

 SUBROUTINE AD_PackPositionType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(PositionType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Pos )  ! Pos 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Pos))-1 ) =  PACK(InData%Pos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Pos)
 END SUBROUTINE AD_PackPositionType

 SUBROUTINE AD_UnPackPositionType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(PositionType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Pos,1)))
  mask1 = .TRUE.
  OutData%Pos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Pos))-1 ),mask1,OutData%Pos)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Pos)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackPositionType

 SUBROUTINE AD_CopyOrientationType( SrcOrientationTypeData, DstOrientationTypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(OrientationType), INTENT(IN) :: SrcOrientationTypeData
   TYPE(OrientationType), INTENT(INOUT) :: DstOrientationTypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOrientationTypeData%Orient = SrcOrientationTypeData%Orient
 END SUBROUTINE AD_CopyOrientationType

 SUBROUTINE AD_DestroyOrientationType( OrientationTypeData, ErrStat, ErrMsg )
  TYPE(OrientationType), INTENT(INOUT) :: OrientationTypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_DestroyOrientationType

 SUBROUTINE AD_PackOrientationType( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(OrientationType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orient )  ! Orient 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orient))-1 ) =  PACK(InData%Orient ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orient)
 END SUBROUTINE AD_PackOrientationType

 SUBROUTINE AD_UnPackOrientationType( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(OrientationType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%Orient,1),SIZE(OutData%Orient,2)))
  mask2 = .TRUE.
  OutData%Orient = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orient))-1 ),mask2,OutData%Orient)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orient)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOrientationType

 SUBROUTINE AD_CopyInitInput( SrcInitInputData, DstInitInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InitInputType), INTENT(IN) :: SrcInitInputData
   TYPE(AD_InitInputType), INTENT(INOUT) :: DstInitInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInitInputData%Title = SrcInitInputData%Title
   DstInitInputData%OutRootName = SrcInitInputData%OutRootName
   DstInitInputData%ADFileName = SrcInitInputData%ADFileName
   DstInitInputData%WindFileName = SrcInitInputData%WindFileName
   DstInitInputData%WrSumFile = SrcInitInputData%WrSumFile
   DstInitInputData%NumBl = SrcInitInputData%NumBl
   DstInitInputData%BladeLength = SrcInitInputData%BladeLength
   DstInitInputData%LinearizeFlag = SrcInitInputData%LinearizeFlag
   DstInitInputData%UseDWM = SrcInitInputData%UseDWM
      CALL AD_Copyaeroconfig( SrcInitInputData%TurbineComponents, DstInitInputData%TurbineComponents, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:TurbineComponents')
         IF (ErrStat>=AbortErrLev) RETURN
   DstInitInputData%NumTwrNodes = SrcInitInputData%NumTwrNodes
IF (ALLOCATED(SrcInitInputData%TwrNodeLocs)) THEN
   i1_l = LBOUND(SrcInitInputData%TwrNodeLocs,1)
   i1_u = UBOUND(SrcInitInputData%TwrNodeLocs,1)
   i2_l = LBOUND(SrcInitInputData%TwrNodeLocs,2)
   i2_u = UBOUND(SrcInitInputData%TwrNodeLocs,2)
   IF (.NOT. ALLOCATED(DstInitInputData%TwrNodeLocs)) THEN 
      ALLOCATE(DstInitInputData%TwrNodeLocs(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInitInputData%TwrNodeLocs.', ErrStat, ErrMsg,'AD_CopyInitInput')
         RETURN
      END IF
   END IF
   DstInitInputData%TwrNodeLocs = SrcInitInputData%TwrNodeLocs
ENDIF
      CALL IfW_CopyInitInput( SrcInitInputData%IfW_InitInputs, DstInitInputData%IfW_InitInputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:IfW_InitInputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInitInput( SrcInitInputData%DWM_InitInputs, DstInitInputData%DWM_InitInputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitInput:DWM_InitInputs')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyInitInput

 SUBROUTINE AD_DestroyInitInput( InitInputData, ErrStat, ErrMsg )
  TYPE(AD_InitInputType), INTENT(INOUT) :: InitInputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyaeroconfig( InitInputData%TurbineComponents, ErrStat, ErrMsg )
IF (ALLOCATED(InitInputData%TwrNodeLocs)) THEN
   DEALLOCATE(InitInputData%TwrNodeLocs)
ENDIF
  CALL IfW_DestroyInitInput( InitInputData%IfW_InitInputs, ErrStat, ErrMsg )
  CALL DWM_DestroyInitInput( InitInputData%DWM_InitInputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitInput

 SUBROUTINE AD_PackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InitInputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_InitInputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_InitInputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_InitInputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for Title
!  missing buffer for OutRootName
!  missing buffer for ADFileName
!  missing buffer for WindFileName
  Int_BufSz  = Int_BufSz  + 1  ! WrSumFile
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  Int_BufSz  = Int_BufSz  + 1  ! LinearizeFlag
  Int_BufSz  = Int_BufSz  + 1  ! UseDWM
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  IF ( ALLOCATED(InData%TwrNodeLocs) )   Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeLocs )  ! TwrNodeLocs 
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Int_IfW_InitInputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitInputs_Buf ) ! IfW_InitInputs
  IF(ALLOCATED(Re_IfW_InitInputs_Buf))  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF(ALLOCATED(Db_IfW_InitInputs_Buf))  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) DEALLOCATE(Int_IfW_InitInputs_Buf)
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, InData%DWM_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_InitInputs_Buf  ) ! DWM_InitInputs
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_InitInputs_Buf  ) ! DWM_InitInputs
  IF(ALLOCATED(Int_DWM_InitInputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_InitInputs_Buf ) ! DWM_InitInputs
  IF(ALLOCATED(Re_DWM_InitInputs_Buf))  DEALLOCATE(Re_DWM_InitInputs_Buf)
  IF(ALLOCATED(Db_DWM_InitInputs_Buf))  DEALLOCATE(Db_DWM_InitInputs_Buf)
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) DEALLOCATE(Int_DWM_InitInputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrSumFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%LinearizeFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseDWM ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeLocs) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeLocs))-1 ) =  PACK(InData%TwrNodeLocs ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeLocs)
  ENDIF
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, OnlySize ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 ) = Re_IfW_InitInputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 ) = Db_IfW_InitInputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 ) = Int_IfW_InitInputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitInputs_Buf) )  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF( ALLOCATED(Db_IfW_InitInputs_Buf) )  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF( ALLOCATED(Int_IfW_InitInputs_Buf) ) DEALLOCATE(Int_IfW_InitInputs_Buf)
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, InData%DWM_InitInputs, ErrStat, ErrMsg, OnlySize ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitInputs_Buf)-1 ) = Re_DWM_InitInputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitInputs_Buf)-1 ) = Db_DWM_InitInputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitInputs_Buf)-1 ) = Int_DWM_InitInputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitInputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_InitInputs_Buf) )  DEALLOCATE(Re_DWM_InitInputs_Buf)
  IF( ALLOCATED(Db_DWM_InitInputs_Buf) )  DEALLOCATE(Db_DWM_InitInputs_Buf)
  IF( ALLOCATED(Int_DWM_InitInputs_Buf) ) DEALLOCATE(Int_DWM_InitInputs_Buf)
 END SUBROUTINE AD_PackInitInput

 SUBROUTINE AD_UnPackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InitInputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_InitInputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_InitInputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_InitInputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeLocs) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrNodeLocs,1),SIZE(OutData%TwrNodeLocs,2)))
  mask2 = .TRUE.
    OutData%TwrNodeLocs = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeLocs))-1 ),mask2,OutData%TwrNodeLocs)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeLocs)
  ENDIF
 ! first call IfW_PackInitInput to get correctly sized buffers for unpacking
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    Re_IfW_InitInputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    Db_IfW_InitInputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    Int_IfW_InitInputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  CALL IfW_UnPackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg ) ! IfW_InitInputs 
 ! first call DWM_PackInitInput to get correctly sized buffers for unpacking
  CALL DWM_PackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, OutData%DWM_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitInputs 
  IF(ALLOCATED(Re_DWM_InitInputs_Buf)) THEN
    Re_DWM_InitInputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitInputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitInputs_Buf)) THEN
    Db_DWM_InitInputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitInputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitInputs_Buf)) THEN
    Int_DWM_InitInputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitInputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitInputs_Buf)
  ENDIF
  CALL DWM_UnPackInitInput( Re_DWM_InitInputs_Buf, Db_DWM_InitInputs_Buf, Int_DWM_InitInputs_Buf, OutData%DWM_InitInputs, ErrStat, ErrMsg ) ! DWM_InitInputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitInput

 SUBROUTINE AD_CopyInitOutput( SrcInitOutputData, DstInitOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InitOutputType), INTENT(IN) :: SrcInitOutputData
   TYPE(AD_InitOutputType), INTENT(INOUT) :: DstInitOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL NWTC_Library_Copyprogdesc( SrcInitOutputData%Ver, DstInitOutputData%Ver, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:Ver')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyInitOutput( SrcInitOutputData%IfW_InitOutput, DstInitOutputData%IfW_InitOutput, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:IfW_InitOutput')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInitOutput( SrcInitOutputData%DWM_InitOutput, DstInitOutputData%DWM_InitOutput, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInitOutput:DWM_InitOutput')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyInitOutput

 SUBROUTINE AD_DestroyInitOutput( InitOutputData, ErrStat, ErrMsg )
  TYPE(AD_InitOutputType), INTENT(INOUT) :: InitOutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL NWTC_Library_Destroyprogdesc( InitOutputData%Ver, ErrStat, ErrMsg )
  CALL IfW_DestroyInitOutput( InitOutputData%IfW_InitOutput, ErrStat, ErrMsg )
  CALL DWM_DestroyInitOutput( InitOutputData%DWM_InitOutput, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitOutput

 SUBROUTINE AD_PackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InitOutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_InitOutput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_InitOutput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_InitOutput_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Db_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Int_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ver_Buf ) ! Ver
  IF(ALLOCATED(Re_Ver_Buf))  DEALLOCATE(Re_Ver_Buf)
  IF(ALLOCATED(Db_Ver_Buf))  DEALLOCATE(Db_Ver_Buf)
  IF(ALLOCATED(Int_Ver_Buf)) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Int_IfW_InitOutput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitOutput_Buf ) ! IfW_InitOutput
  IF(ALLOCATED(Re_IfW_InitOutput_Buf))  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF(ALLOCATED(Db_IfW_InitOutput_Buf))  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) DEALLOCATE(Int_IfW_InitOutput_Buf)
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, InData%DWM_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_InitOutput_Buf  ) ! DWM_InitOutput
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_InitOutput_Buf  ) ! DWM_InitOutput
  IF(ALLOCATED(Int_DWM_InitOutput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_InitOutput_Buf ) ! DWM_InitOutput
  IF(ALLOCATED(Re_DWM_InitOutput_Buf))  DEALLOCATE(Re_DWM_InitOutput_Buf)
  IF(ALLOCATED(Db_DWM_InitOutput_Buf))  DEALLOCATE(Db_DWM_InitOutput_Buf)
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) DEALLOCATE(Int_DWM_InitOutput_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, OnlySize ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 ) = Re_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 ) = Db_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 ) = Int_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ver_Buf) )  DEALLOCATE(Re_Ver_Buf)
  IF( ALLOCATED(Db_Ver_Buf) )  DEALLOCATE(Db_Ver_Buf)
  IF( ALLOCATED(Int_Ver_Buf) ) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, OnlySize ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 ) = Re_IfW_InitOutput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 ) = Db_IfW_InitOutput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 ) = Int_IfW_InitOutput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitOutput_Buf) )  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF( ALLOCATED(Db_IfW_InitOutput_Buf) )  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF( ALLOCATED(Int_IfW_InitOutput_Buf) ) DEALLOCATE(Int_IfW_InitOutput_Buf)
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, InData%DWM_InitOutput, ErrStat, ErrMsg, OnlySize ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitOutput_Buf)-1 ) = Re_DWM_InitOutput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitOutput_Buf)-1 ) = Db_DWM_InitOutput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitOutput_Buf)-1 ) = Int_DWM_InitOutput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitOutput_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_InitOutput_Buf) )  DEALLOCATE(Re_DWM_InitOutput_Buf)
  IF( ALLOCATED(Db_DWM_InitOutput_Buf) )  DEALLOCATE(Db_DWM_InitOutput_Buf)
  IF( ALLOCATED(Int_DWM_InitOutput_Buf) ) DEALLOCATE(Int_DWM_InitOutput_Buf)
 END SUBROUTINE AD_PackInitOutput

 SUBROUTINE AD_UnPackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InitOutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_InitOutput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_InitOutput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_InitOutput_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    Re_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    Db_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    Int_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg ) ! Ver 
 ! first call IfW_PackInitOutput to get correctly sized buffers for unpacking
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    Re_IfW_InitOutput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    Db_IfW_InitOutput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    Int_IfW_InitOutput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  CALL IfW_UnPackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg ) ! IfW_InitOutput 
 ! first call DWM_PackInitOutput to get correctly sized buffers for unpacking
  CALL DWM_PackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, OutData%DWM_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! DWM_InitOutput 
  IF(ALLOCATED(Re_DWM_InitOutput_Buf)) THEN
    Re_DWM_InitOutput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_InitOutput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_InitOutput_Buf)) THEN
    Db_DWM_InitOutput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_InitOutput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_InitOutput_Buf)) THEN
    Int_DWM_InitOutput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_InitOutput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_InitOutput_Buf)
  ENDIF
  CALL DWM_UnPackInitOutput( Re_DWM_InitOutput_Buf, Db_DWM_InitOutput_Buf, Int_DWM_InitOutput_Buf, OutData%DWM_InitOutput, ErrStat, ErrMsg ) ! DWM_InitOutput 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitOutput

 SUBROUTINE AD_CopyContState( SrcContStateData, DstContStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ContinuousStateType), INTENT(IN) :: SrcContStateData
   TYPE(AD_ContinuousStateType), INTENT(INOUT) :: DstContStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyContState( SrcContStateData%IfW_ContStates, DstContStateData%IfW_ContStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyContState:IfW_ContStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyContState( SrcContStateData%DWM_ContStates, DstContStateData%DWM_ContStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyContState:DWM_ContStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyContState

 SUBROUTINE AD_DestroyContState( ContStateData, ErrStat, ErrMsg )
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: ContStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyContState( ContStateData%IfW_ContStates, ErrStat, ErrMsg )
  CALL DWM_DestroyContState( ContStateData%DWM_ContStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyContState

 SUBROUTINE AD_PackContState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ContinuousStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_ContStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_ContStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_ContStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Int_IfW_ContStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ContStates_Buf ) ! IfW_ContStates
  IF(ALLOCATED(Re_IfW_ContStates_Buf))  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF(ALLOCATED(Db_IfW_ContStates_Buf))  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) DEALLOCATE(Int_IfW_ContStates_Buf)
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, InData%DWM_ContStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_ContStates_Buf  ) ! DWM_ContStates
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_ContStates_Buf  ) ! DWM_ContStates
  IF(ALLOCATED(Int_DWM_ContStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_ContStates_Buf ) ! DWM_ContStates
  IF(ALLOCATED(Re_DWM_ContStates_Buf))  DEALLOCATE(Re_DWM_ContStates_Buf)
  IF(ALLOCATED(Db_DWM_ContStates_Buf))  DEALLOCATE(Db_DWM_ContStates_Buf)
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) DEALLOCATE(Int_DWM_ContStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 ) = Re_IfW_ContStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 ) = Db_IfW_ContStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 ) = Int_IfW_ContStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ContStates_Buf) )  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF( ALLOCATED(Db_IfW_ContStates_Buf) )  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF( ALLOCATED(Int_IfW_ContStates_Buf) ) DEALLOCATE(Int_IfW_ContStates_Buf)
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, InData%DWM_ContStates, ErrStat, ErrMsg, OnlySize ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ContStates_Buf)-1 ) = Re_DWM_ContStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ContStates_Buf)-1 ) = Db_DWM_ContStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ContStates_Buf)-1 ) = Int_DWM_ContStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ContStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_ContStates_Buf) )  DEALLOCATE(Re_DWM_ContStates_Buf)
  IF( ALLOCATED(Db_DWM_ContStates_Buf) )  DEALLOCATE(Db_DWM_ContStates_Buf)
  IF( ALLOCATED(Int_DWM_ContStates_Buf) ) DEALLOCATE(Int_DWM_ContStates_Buf)
 END SUBROUTINE AD_PackContState

 SUBROUTINE AD_UnPackContState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_ContStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_ContStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_ContStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackContState to get correctly sized buffers for unpacking
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    Re_IfW_ContStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    Db_IfW_ContStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    Int_IfW_ContStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  CALL IfW_UnPackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg ) ! IfW_ContStates 
 ! first call DWM_PackContState to get correctly sized buffers for unpacking
  CALL DWM_PackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, OutData%DWM_ContStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ContStates 
  IF(ALLOCATED(Re_DWM_ContStates_Buf)) THEN
    Re_DWM_ContStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ContStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ContStates_Buf)) THEN
    Db_DWM_ContStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ContStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ContStates_Buf)) THEN
    Int_DWM_ContStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ContStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ContStates_Buf)
  ENDIF
  CALL DWM_UnPackContState( Re_DWM_ContStates_Buf, Db_DWM_ContStates_Buf, Int_DWM_ContStates_Buf, OutData%DWM_ContStates, ErrStat, ErrMsg ) ! DWM_ContStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackContState

 SUBROUTINE AD_CopyDiscState( SrcDiscStateData, DstDiscStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_DiscreteStateType), INTENT(IN) :: SrcDiscStateData
   TYPE(AD_DiscreteStateType), INTENT(INOUT) :: DstDiscStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyDiscState( SrcDiscStateData%IfW_DiscStates, DstDiscStateData%IfW_DiscStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyDiscState:IfW_DiscStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyDiscState( SrcDiscStateData%DWM_DiscStates, DstDiscStateData%DWM_DiscStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyDiscState:DWM_DiscStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyDiscState

 SUBROUTINE AD_DestroyDiscState( DiscStateData, ErrStat, ErrMsg )
  TYPE(AD_DiscreteStateType), INTENT(INOUT) :: DiscStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyDiscState( DiscStateData%IfW_DiscStates, ErrStat, ErrMsg )
  CALL DWM_DestroyDiscState( DiscStateData%DWM_DiscStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyDiscState

 SUBROUTINE AD_PackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_DiscreteStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_DiscStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_DiscStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_DiscStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Int_IfW_DiscStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_DiscStates_Buf ) ! IfW_DiscStates
  IF(ALLOCATED(Re_IfW_DiscStates_Buf))  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF(ALLOCATED(Db_IfW_DiscStates_Buf))  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) DEALLOCATE(Int_IfW_DiscStates_Buf)
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, InData%DWM_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_DiscStates_Buf  ) ! DWM_DiscStates
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_DiscStates_Buf  ) ! DWM_DiscStates
  IF(ALLOCATED(Int_DWM_DiscStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_DiscStates_Buf ) ! DWM_DiscStates
  IF(ALLOCATED(Re_DWM_DiscStates_Buf))  DEALLOCATE(Re_DWM_DiscStates_Buf)
  IF(ALLOCATED(Db_DWM_DiscStates_Buf))  DEALLOCATE(Db_DWM_DiscStates_Buf)
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) DEALLOCATE(Int_DWM_DiscStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, OnlySize ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 ) = Re_IfW_DiscStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 ) = Db_IfW_DiscStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 ) = Int_IfW_DiscStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_DiscStates_Buf) )  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF( ALLOCATED(Db_IfW_DiscStates_Buf) )  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF( ALLOCATED(Int_IfW_DiscStates_Buf) ) DEALLOCATE(Int_IfW_DiscStates_Buf)
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, InData%DWM_DiscStates, ErrStat, ErrMsg, OnlySize ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_DiscStates_Buf)-1 ) = Re_DWM_DiscStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_DiscStates_Buf)-1 ) = Db_DWM_DiscStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_DiscStates_Buf)-1 ) = Int_DWM_DiscStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_DiscStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_DiscStates_Buf) )  DEALLOCATE(Re_DWM_DiscStates_Buf)
  IF( ALLOCATED(Db_DWM_DiscStates_Buf) )  DEALLOCATE(Db_DWM_DiscStates_Buf)
  IF( ALLOCATED(Int_DWM_DiscStates_Buf) ) DEALLOCATE(Int_DWM_DiscStates_Buf)
 END SUBROUTINE AD_PackDiscState

 SUBROUTINE AD_UnPackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_DiscreteStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_DiscStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_DiscStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_DiscStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackDiscState to get correctly sized buffers for unpacking
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    Re_IfW_DiscStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    Db_IfW_DiscStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    Int_IfW_DiscStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  CALL IfW_UnPackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg ) ! IfW_DiscStates 
 ! first call DWM_PackDiscState to get correctly sized buffers for unpacking
  CALL DWM_PackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, OutData%DWM_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_DiscStates 
  IF(ALLOCATED(Re_DWM_DiscStates_Buf)) THEN
    Re_DWM_DiscStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_DiscStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_DiscStates_Buf)) THEN
    Db_DWM_DiscStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_DiscStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_DiscStates_Buf)) THEN
    Int_DWM_DiscStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_DiscStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_DiscStates_Buf)
  ENDIF
  CALL DWM_UnPackDiscState( Re_DWM_DiscStates_Buf, Db_DWM_DiscStates_Buf, Int_DWM_DiscStates_Buf, OutData%DWM_DiscStates, ErrStat, ErrMsg ) ! DWM_DiscStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDiscState

 SUBROUTINE AD_CopyConstrState( SrcConstrStateData, DstConstrStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ConstraintStateType), INTENT(IN) :: SrcConstrStateData
   TYPE(AD_ConstraintStateType), INTENT(INOUT) :: DstConstrStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL IfW_CopyConstrState( SrcConstrStateData%IfW_ConstrStates, DstConstrStateData%IfW_ConstrStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyConstrState:IfW_ConstrStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyConstrState( SrcConstrStateData%DWM_ConstrStates, DstConstrStateData%DWM_ConstrStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyConstrState:DWM_ConstrStates')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyConstrState

 SUBROUTINE AD_DestroyConstrState( ConstrStateData, ErrStat, ErrMsg )
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyConstrState( ConstrStateData%IfW_ConstrStates, ErrStat, ErrMsg )
  CALL DWM_DestroyConstrState( ConstrStateData%DWM_ConstrStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyConstrState

 SUBROUTINE AD_PackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ConstraintStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_ConstrStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_ConstrStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_ConstrStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ConstrStates_Buf ) ! IfW_ConstrStates
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf))  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf))  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) DEALLOCATE(Int_IfW_ConstrStates_Buf)
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, InData%DWM_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_ConstrStates_Buf  ) ! DWM_ConstrStates
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_ConstrStates_Buf  ) ! DWM_ConstrStates
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_ConstrStates_Buf ) ! DWM_ConstrStates
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf))  DEALLOCATE(Re_DWM_ConstrStates_Buf)
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf))  DEALLOCATE(Db_DWM_ConstrStates_Buf)
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) DEALLOCATE(Int_DWM_ConstrStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 ) = Re_IfW_ConstrStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 ) = Db_IfW_ConstrStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 ) = Int_IfW_ConstrStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ConstrStates_Buf) )  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Db_IfW_ConstrStates_Buf) )  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Int_IfW_ConstrStates_Buf) ) DEALLOCATE(Int_IfW_ConstrStates_Buf)
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, InData%DWM_ConstrStates, ErrStat, ErrMsg, OnlySize ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ConstrStates_Buf)-1 ) = Re_DWM_ConstrStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ConstrStates_Buf)-1 ) = Db_DWM_ConstrStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ConstrStates_Buf)-1 ) = Int_DWM_ConstrStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ConstrStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_ConstrStates_Buf) )  DEALLOCATE(Re_DWM_ConstrStates_Buf)
  IF( ALLOCATED(Db_DWM_ConstrStates_Buf) )  DEALLOCATE(Db_DWM_ConstrStates_Buf)
  IF( ALLOCATED(Int_DWM_ConstrStates_Buf) ) DEALLOCATE(Int_DWM_ConstrStates_Buf)
 END SUBROUTINE AD_PackConstrState

 SUBROUTINE AD_UnPackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_ConstrStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_ConstrStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_ConstrStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call IfW_PackConstrState to get correctly sized buffers for unpacking
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    Re_IfW_ConstrStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    Db_IfW_ConstrStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    Int_IfW_ConstrStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  CALL IfW_UnPackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg ) ! IfW_ConstrStates 
 ! first call DWM_PackConstrState to get correctly sized buffers for unpacking
  CALL DWM_PackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, OutData%DWM_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_ConstrStates 
  IF(ALLOCATED(Re_DWM_ConstrStates_Buf)) THEN
    Re_DWM_ConstrStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_ConstrStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_ConstrStates_Buf)) THEN
    Db_DWM_ConstrStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_ConstrStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_ConstrStates_Buf)) THEN
    Int_DWM_ConstrStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_ConstrStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_ConstrStates_Buf)
  ENDIF
  CALL DWM_UnPackConstrState( Re_DWM_ConstrStates_Buf, Db_DWM_ConstrStates_Buf, Int_DWM_ConstrStates_Buf, OutData%DWM_ConstrStates, ErrStat, ErrMsg ) ! DWM_ConstrStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackConstrState

 SUBROUTINE AD_CopyOtherState( SrcOtherStateData, DstOtherStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_OtherStateType), INTENT(IN) :: SrcOtherStateData
   TYPE(AD_OtherStateType), INTENT(INOUT) :: DstOtherStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: i3, i3_l, i3_u  !  bounds (upper/lower) for an array dimension 3
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOtherStateData%DT = SrcOtherStateData%DT
IF (ALLOCATED(SrcOtherStateData%ElPrNum)) THEN
   i1_l = LBOUND(SrcOtherStateData%ElPrNum,1)
   i1_u = UBOUND(SrcOtherStateData%ElPrNum,1)
   IF (.NOT. ALLOCATED(DstOtherStateData%ElPrNum)) THEN 
      ALLOCATE(DstOtherStateData%ElPrNum(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%ElPrNum.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%ElPrNum = SrcOtherStateData%ElPrNum
ENDIF
   DstOtherStateData%OldTime = SrcOtherStateData%OldTime
   DstOtherStateData%HubLoss = SrcOtherStateData%HubLoss
   DstOtherStateData%Loss = SrcOtherStateData%Loss
   DstOtherStateData%TipLoss = SrcOtherStateData%TipLoss
   DstOtherStateData%TLpt7 = SrcOtherStateData%TLpt7
   DstOtherStateData%FirstPassGTL = SrcOtherStateData%FirstPassGTL
   DstOtherStateData%SuperSonic = SrcOtherStateData%SuperSonic
   DstOtherStateData%AFLAGVinderr = SrcOtherStateData%AFLAGVinderr
   DstOtherStateData%AFLAGTwrInflu = SrcOtherStateData%AFLAGTwrInflu
   DstOtherStateData%OnePassDynDbg = SrcOtherStateData%OnePassDynDbg
   DstOtherStateData%NoLoadsCalculated = SrcOtherStateData%NoLoadsCalculated
   DstOtherStateData%NERRORS = SrcOtherStateData%NERRORS
      CALL IfW_CopyOtherState( SrcOtherStateData%IfW_OtherStates, DstOtherStateData%IfW_OtherStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:IfW_OtherStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyOtherState( SrcOtherStateData%DWM_OtherStates, DstOtherStateData%DWM_OtherStates, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DWM_OtherStates')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyairfoil( SrcOtherStateData%AirFoil, DstOtherStateData%AirFoil, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:AirFoil')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybeddoes( SrcOtherStateData%Beddoes, DstOtherStateData%Beddoes, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Beddoes')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copydyninflow( SrcOtherStateData%DynInflow, DstOtherStateData%DynInflow, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DynInflow')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyelement( SrcOtherStateData%Element, DstOtherStateData%Element, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Element')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyrotor( SrcOtherStateData%Rotor, DstOtherStateData%Rotor, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Rotor')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copywind( SrcOtherStateData%Wind, DstOtherStateData%Wind, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:Wind')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyinducedvel( SrcOtherStateData%InducedVel, DstOtherStateData%InducedVel, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:InducedVel')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcOtherStateData%StoredForces)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredForces,1)
   i1_u = UBOUND(SrcOtherStateData%StoredForces,1)
   i2_l = LBOUND(SrcOtherStateData%StoredForces,2)
   i2_u = UBOUND(SrcOtherStateData%StoredForces,2)
   i3_l = LBOUND(SrcOtherStateData%StoredForces,3)
   i3_u = UBOUND(SrcOtherStateData%StoredForces,3)
   IF (.NOT. ALLOCATED(DstOtherStateData%StoredForces)) THEN 
      ALLOCATE(DstOtherStateData%StoredForces(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%StoredForces.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredForces = SrcOtherStateData%StoredForces
ENDIF
IF (ALLOCATED(SrcOtherStateData%StoredMoments)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredMoments,1)
   i1_u = UBOUND(SrcOtherStateData%StoredMoments,1)
   i2_l = LBOUND(SrcOtherStateData%StoredMoments,2)
   i2_u = UBOUND(SrcOtherStateData%StoredMoments,2)
   i3_l = LBOUND(SrcOtherStateData%StoredMoments,3)
   i3_u = UBOUND(SrcOtherStateData%StoredMoments,3)
   IF (.NOT. ALLOCATED(DstOtherStateData%StoredMoments)) THEN 
      ALLOCATE(DstOtherStateData%StoredMoments(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOtherStateData%StoredMoments.', ErrStat, ErrMsg,'AD_CopyOtherState')
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredMoments = SrcOtherStateData%StoredMoments
ENDIF
   DstOtherStateData%FirstWarn = SrcOtherStateData%FirstWarn
      CALL AD_Copyeloutparms( SrcOtherStateData%ElOut, DstOtherStateData%ElOut, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:ElOut')
         IF (ErrStat>=AbortErrLev) RETURN
   DstOtherStateData%Skew = SrcOtherStateData%Skew
   DstOtherStateData%DynInit = SrcOtherStateData%DynInit
      CALL IfW_CopyInput( SrcOtherStateData%IfW_Inputs, DstOtherStateData%IfW_Inputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:IfW_Inputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyInput( SrcOtherStateData%DWM_Inputs, DstOtherStateData%DWM_Inputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOtherState:DWM_Inputs')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyOtherState

 SUBROUTINE AD_DestroyOtherState( OtherStateData, ErrStat, ErrMsg )
  TYPE(AD_OtherStateType), INTENT(INOUT) :: OtherStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OtherStateData%ElPrNum)) THEN
   DEALLOCATE(OtherStateData%ElPrNum)
ENDIF
  CALL IfW_DestroyOtherState( OtherStateData%IfW_OtherStates, ErrStat, ErrMsg )
  CALL DWM_DestroyOtherState( OtherStateData%DWM_OtherStates, ErrStat, ErrMsg )
  CALL AD_Destroyairfoil( OtherStateData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybeddoes( OtherStateData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflow( OtherStateData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelement( OtherStateData%Element, ErrStat, ErrMsg )
  CALL AD_Destroyrotor( OtherStateData%Rotor, ErrStat, ErrMsg )
  CALL AD_Destroywind( OtherStateData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvel( OtherStateData%InducedVel, ErrStat, ErrMsg )
IF (ALLOCATED(OtherStateData%StoredForces)) THEN
   DEALLOCATE(OtherStateData%StoredForces)
ENDIF
IF (ALLOCATED(OtherStateData%StoredMoments)) THEN
   DEALLOCATE(OtherStateData%StoredMoments)
ENDIF
  CALL AD_Destroyeloutparms( OtherStateData%ElOut, ErrStat, ErrMsg )
  CALL IfW_DestroyInput( OtherStateData%IfW_Inputs, ErrStat, ErrMsg )
  CALL DWM_DestroyInput( OtherStateData%DWM_Inputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOtherState

 SUBROUTINE AD_PackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_OtherStateType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_OtherStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_OtherStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_OtherStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ElOut_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Inputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Inputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Inputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Db_BufSz   = Db_BufSz   + 1  ! DT
  IF ( ALLOCATED(InData%ElPrNum) )   Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Db_BufSz   = Db_BufSz   + 1  ! OldTime
  Re_BufSz   = Re_BufSz   + 1  ! HubLoss
  Re_BufSz   = Re_BufSz   + 1  ! Loss
  Re_BufSz   = Re_BufSz   + 1  ! TipLoss
  Re_BufSz   = Re_BufSz   + 1  ! TLpt7
  Int_BufSz  = Int_BufSz  + 1  ! FirstPassGTL
  Int_BufSz  = Int_BufSz  + 1  ! SuperSonic
  Int_BufSz  = Int_BufSz  + 1  ! AFLAGVinderr
  Int_BufSz  = Int_BufSz  + 1  ! AFLAGTwrInflu
  Int_BufSz  = Int_BufSz  + 1  ! OnePassDynDbg
  Int_BufSz  = Int_BufSz  + 1  ! NoLoadsCalculated
  Int_BufSz  = Int_BufSz  + 1  ! NERRORS
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Int_IfW_OtherStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_OtherStates_Buf ) ! IfW_OtherStates
  IF(ALLOCATED(Re_IfW_OtherStates_Buf))  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF(ALLOCATED(Db_IfW_OtherStates_Buf))  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, InData%DWM_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_OtherStates_Buf  ) ! DWM_OtherStates
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_OtherStates_Buf  ) ! DWM_OtherStates
  IF(ALLOCATED(Int_DWM_OtherStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_OtherStates_Buf ) ! DWM_OtherStates
  IF(ALLOCATED(Re_DWM_OtherStates_Buf))  DEALLOCATE(Re_DWM_OtherStates_Buf)
  IF(ALLOCATED(Db_DWM_OtherStates_Buf))  DEALLOCATE(Db_DWM_OtherStates_Buf)
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) DEALLOCATE(Int_DWM_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  IF ( ALLOCATED(InData%StoredForces) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StoredForces )  ! StoredForces 
  IF ( ALLOCATED(InData%StoredMoments) )   Re_BufSz    = Re_BufSz    + SIZE( InData%StoredMoments )  ! StoredMoments 
  Int_BufSz  = Int_BufSz  + 1  ! FirstWarn
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Db_ElOut_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Int_ElOut_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ElOut_Buf ) ! ElOut
  IF(ALLOCATED(Re_ElOut_Buf))  DEALLOCATE(Re_ElOut_Buf)
  IF(ALLOCATED(Db_ElOut_Buf))  DEALLOCATE(Db_ElOut_Buf)
  IF(ALLOCATED(Int_ElOut_Buf)) DEALLOCATE(Int_ElOut_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! Skew
  Int_BufSz  = Int_BufSz  + 1  ! DynInit
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Int_IfW_Inputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Inputs_Buf ) ! IfW_Inputs
  IF(ALLOCATED(Re_IfW_Inputs_Buf))  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF(ALLOCATED(Db_IfW_Inputs_Buf))  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) DEALLOCATE(Int_IfW_Inputs_Buf)
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, InData%DWM_Inputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Inputs_Buf  ) ! DWM_Inputs
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Inputs_Buf  ) ! DWM_Inputs
  IF(ALLOCATED(Int_DWM_Inputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Inputs_Buf ) ! DWM_Inputs
  IF(ALLOCATED(Re_DWM_Inputs_Buf))  DEALLOCATE(Re_DWM_Inputs_Buf)
  IF(ALLOCATED(Db_DWM_Inputs_Buf))  DEALLOCATE(Db_DWM_Inputs_Buf)
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) DEALLOCATE(Int_DWM_Inputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%OldTime )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Loss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TLpt7 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FirstPassGTL ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SuperSonic ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%AFLAGVinderr ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%AFLAGTwrInflu ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%OnePassDynDbg ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%NoLoadsCalculated ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NERRORS )
  Int_Xferred   = Int_Xferred   + 1
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, OnlySize ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 ) = Re_IfW_OtherStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 ) = Db_IfW_OtherStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 ) = Int_IfW_OtherStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_OtherStates_Buf) )  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF( ALLOCATED(Db_IfW_OtherStates_Buf) )  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF( ALLOCATED(Int_IfW_OtherStates_Buf) ) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, InData%DWM_OtherStates, ErrStat, ErrMsg, OnlySize ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_OtherStates_Buf)-1 ) = Re_DWM_OtherStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_OtherStates_Buf)-1 ) = Db_DWM_OtherStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_OtherStates_Buf)-1 ) = Int_DWM_OtherStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_OtherStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_OtherStates_Buf) )  DEALLOCATE(Re_DWM_OtherStates_Buf)
  IF( ALLOCATED(Db_DWM_OtherStates_Buf) )  DEALLOCATE(Db_DWM_OtherStates_Buf)
  IF( ALLOCATED(Int_DWM_OtherStates_Buf) ) DEALLOCATE(Int_DWM_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  IF ( ALLOCATED(InData%StoredForces) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredForces))-1 ) =  PACK(InData%StoredForces ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredForces)
  ENDIF
  IF ( ALLOCATED(InData%StoredMoments) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredMoments))-1 ) =  PACK(InData%StoredMoments ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredMoments)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%FirstWarn ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, OnlySize ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 ) = Re_ElOut_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 ) = Db_ElOut_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 ) = Int_ElOut_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  IF( ALLOCATED(Re_ElOut_Buf) )  DEALLOCATE(Re_ElOut_Buf)
  IF( ALLOCATED(Db_ElOut_Buf) )  DEALLOCATE(Db_ElOut_Buf)
  IF( ALLOCATED(Int_ElOut_Buf) ) DEALLOCATE(Int_ElOut_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Skew ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DynInit ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 ) = Re_IfW_Inputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 ) = Db_IfW_Inputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 ) = Int_IfW_Inputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Inputs_Buf) )  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF( ALLOCATED(Db_IfW_Inputs_Buf) )  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF( ALLOCATED(Int_IfW_Inputs_Buf) ) DEALLOCATE(Int_IfW_Inputs_Buf)
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, InData%DWM_Inputs, ErrStat, ErrMsg, OnlySize ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Inputs_Buf)-1 ) = Re_DWM_Inputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Inputs_Buf)-1 ) = Db_DWM_Inputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Inputs_Buf)-1 ) = Int_DWM_Inputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Inputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Inputs_Buf) )  DEALLOCATE(Re_DWM_Inputs_Buf)
  IF( ALLOCATED(Db_DWM_Inputs_Buf) )  DEALLOCATE(Db_DWM_Inputs_Buf)
  IF( ALLOCATED(Int_DWM_Inputs_Buf) ) DEALLOCATE(Int_DWM_Inputs_Buf)
 END SUBROUTINE AD_PackOtherState

 SUBROUTINE AD_UnPackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_OtherStateType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_OtherStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_OtherStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_OtherStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ElOut_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Inputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Inputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Inputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1)))
  mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%OldTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Loss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TLpt7 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NERRORS = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call IfW_PackOtherState to get correctly sized buffers for unpacking
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    Re_IfW_OtherStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    Db_IfW_OtherStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    Int_IfW_OtherStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  CALL IfW_UnPackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg ) ! IfW_OtherStates 
 ! first call DWM_PackOtherState to get correctly sized buffers for unpacking
  CALL DWM_PackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, OutData%DWM_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! DWM_OtherStates 
  IF(ALLOCATED(Re_DWM_OtherStates_Buf)) THEN
    Re_DWM_OtherStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_OtherStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_OtherStates_Buf)) THEN
    Db_DWM_OtherStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_OtherStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_OtherStates_Buf)) THEN
    Int_DWM_OtherStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_OtherStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_OtherStates_Buf)
  ENDIF
  CALL DWM_UnPackOtherState( Re_DWM_OtherStates_Buf, Db_DWM_OtherStates_Buf, Int_DWM_OtherStates_Buf, OutData%DWM_OtherStates, ErrStat, ErrMsg ) ! DWM_OtherStates 
 ! first call AD_Packairfoil to get correctly sized buffers for unpacking
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbeddoes to get correctly sized buffers for unpacking
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflow to get correctly sized buffers for unpacking
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelement to get correctly sized buffers for unpacking
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packrotor to get correctly sized buffers for unpacking
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call AD_Packwind to get correctly sized buffers for unpacking
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packinducedvel to get correctly sized buffers for unpacking
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
  IF ( ALLOCATED(OutData%StoredForces) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredForces,1),SIZE(OutData%StoredForces,2),SIZE(OutData%StoredForces,3)))
  mask3 = .TRUE.
    OutData%StoredForces = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredForces))-1 ),mask3,OutData%StoredForces)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredForces)
  ENDIF
  IF ( ALLOCATED(OutData%StoredMoments) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredMoments,1),SIZE(OutData%StoredMoments,2),SIZE(OutData%StoredMoments,3)))
  mask3 = .TRUE.
    OutData%StoredMoments = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredMoments))-1 ),mask3,OutData%StoredMoments)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredMoments)
  ENDIF
 ! first call AD_Packeloutparms to get correctly sized buffers for unpacking
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    Re_ElOut_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    Db_ElOut_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    Int_ElOut_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  CALL AD_UnPackeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg ) ! ElOut 
 ! first call IfW_PackInput to get correctly sized buffers for unpacking
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    Re_IfW_Inputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    Db_IfW_Inputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    Int_IfW_Inputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  CALL IfW_UnPackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg ) ! IfW_Inputs 
 ! first call DWM_PackInput to get correctly sized buffers for unpacking
  CALL DWM_PackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, OutData%DWM_Inputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Inputs 
  IF(ALLOCATED(Re_DWM_Inputs_Buf)) THEN
    Re_DWM_Inputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Inputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Inputs_Buf)) THEN
    Db_DWM_Inputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Inputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Inputs_Buf)) THEN
    Int_DWM_Inputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Inputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Inputs_Buf)
  ENDIF
  CALL DWM_UnPackInput( Re_DWM_Inputs_Buf, Db_DWM_Inputs_Buf, Int_DWM_Inputs_Buf, OutData%DWM_Inputs, ErrStat, ErrMsg ) ! DWM_Inputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOtherState

 SUBROUTINE AD_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_ParameterType), INTENT(IN) :: SrcParamData
   TYPE(AD_ParameterType), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%Title = SrcParamData%Title
   DstParamData%WindFileName = SrcParamData%WindFileName
   DstParamData%SIUnit = SrcParamData%SIUnit
   DstParamData%Echo = SrcParamData%Echo
   DstParamData%MultiTab = SrcParamData%MultiTab
   DstParamData%LinearizeFlag = SrcParamData%LinearizeFlag
   DstParamData%OutputPlottingInfo = SrcParamData%OutputPlottingInfo
   DstParamData%Initialized = SrcParamData%Initialized
   DstParamData%UseDWM = SrcParamData%UseDWM
   DstParamData%TwoPiNB = SrcParamData%TwoPiNB
   DstParamData%NumBl = SrcParamData%NumBl
   DstParamData%NBlInpSt = SrcParamData%NBlInpSt
   DstParamData%ElemPrn = SrcParamData%ElemPrn
   DstParamData%DStall = SrcParamData%DStall
   DstParamData%PMoment = SrcParamData%PMoment
   DstParamData%Reynolds = SrcParamData%Reynolds
   DstParamData%DynInfl = SrcParamData%DynInfl
   DstParamData%Wake = SrcParamData%Wake
   DstParamData%Swirl = SrcParamData%Swirl
   DstParamData%DtAero = SrcParamData%DtAero
   DstParamData%HubRad = SrcParamData%HubRad
   DstParamData%UnEc = SrcParamData%UnEc
   DstParamData%UnElem = SrcParamData%UnElem
   DstParamData%UnWndOut = SrcParamData%UnWndOut
   DstParamData%MAXICOUNT = SrcParamData%MAXICOUNT
   DstParamData%WrOptFile = SrcParamData%WrOptFile
   DstParamData%DEFAULT_Wind = SrcParamData%DEFAULT_Wind
      CALL AD_Copyairfoilparms( SrcParamData%AirFoil, DstParamData%AirFoil, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:AirFoil')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybladeparms( SrcParamData%Blade, DstParamData%Blade, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Blade')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copybeddoesparms( SrcParamData%Beddoes, DstParamData%Beddoes, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Beddoes')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copydyninflowparms( SrcParamData%DynInflow, DstParamData%DynInflow, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:DynInflow')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyelementparms( SrcParamData%Element, DstParamData%Element, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Element')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copytwrpropsparms( SrcParamData%TwrProps, DstParamData%TwrProps, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:TwrProps')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyinducedvelparms( SrcParamData%InducedVel, DstParamData%InducedVel, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:InducedVel')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copywindparms( SrcParamData%Wind, DstParamData%Wind, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Wind')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyrotorparms( SrcParamData%Rotor, DstParamData%Rotor, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:Rotor')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyParam( SrcParamData%IfW_Params, DstParamData%IfW_Params, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:IfW_Params')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyParam( SrcParamData%DWM_Params, DstParamData%DWM_Params, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyParam:DWM_Params')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyParam

 SUBROUTINE AD_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(AD_ParameterType), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyairfoilparms( ParamData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybladeparms( ParamData%Blade, ErrStat, ErrMsg )
  CALL AD_Destroybeddoesparms( ParamData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflowparms( ParamData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelementparms( ParamData%Element, ErrStat, ErrMsg )
  CALL AD_Destroytwrpropsparms( ParamData%TwrProps, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvelparms( ParamData%InducedVel, ErrStat, ErrMsg )
  CALL AD_Destroywindparms( ParamData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyrotorparms( ParamData%Rotor, ErrStat, ErrMsg )
  CALL IfW_DestroyParam( ParamData%IfW_Params, ErrStat, ErrMsg )
  CALL DWM_DestroyParam( ParamData%DWM_Params, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyParam

 SUBROUTINE AD_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_ParameterType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Params_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Params_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Params_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Params_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
!  missing buffer for Title
!  missing buffer for WindFileName
  Int_BufSz  = Int_BufSz  + 1  ! SIUnit
  Int_BufSz  = Int_BufSz  + 1  ! Echo
  Int_BufSz  = Int_BufSz  + 1  ! MultiTab
  Int_BufSz  = Int_BufSz  + 1  ! LinearizeFlag
  Int_BufSz  = Int_BufSz  + 1  ! OutputPlottingInfo
  Int_BufSz  = Int_BufSz  + 1  ! Initialized
  Int_BufSz  = Int_BufSz  + 1  ! UseDWM
  Re_BufSz   = Re_BufSz   + 1  ! TwoPiNB
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Int_BufSz  = Int_BufSz  + 1  ! NBlInpSt
  Int_BufSz  = Int_BufSz  + 1  ! ElemPrn
  Int_BufSz  = Int_BufSz  + 1  ! DStall
  Int_BufSz  = Int_BufSz  + 1  ! PMoment
  Int_BufSz  = Int_BufSz  + 1  ! Reynolds
  Int_BufSz  = Int_BufSz  + 1  ! DynInfl
  Int_BufSz  = Int_BufSz  + 1  ! Wake
  Int_BufSz  = Int_BufSz  + 1  ! Swirl
  Db_BufSz   = Db_BufSz   + 1  ! DtAero
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Int_BufSz  = Int_BufSz  + 1  ! UnEc
  Int_BufSz  = Int_BufSz  + 1  ! UnElem
  Int_BufSz  = Int_BufSz  + 1  ! UnWndOut
  Int_BufSz  = Int_BufSz  + 1  ! MAXICOUNT
  Int_BufSz  = Int_BufSz  + 1  ! WrOptFile
  Int_BufSz  = Int_BufSz  + 1  ! DEFAULT_Wind
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Db_TwrProps_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Int_TwrProps_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TwrProps_Buf ) ! TwrProps
  IF(ALLOCATED(Re_TwrProps_Buf))  DEALLOCATE(Re_TwrProps_Buf)
  IF(ALLOCATED(Db_TwrProps_Buf))  DEALLOCATE(Db_TwrProps_Buf)
  IF(ALLOCATED(Int_TwrProps_Buf)) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Db_IfW_Params_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Int_IfW_Params_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Params_Buf ) ! IfW_Params
  IF(ALLOCATED(Re_IfW_Params_Buf))  DEALLOCATE(Re_IfW_Params_Buf)
  IF(ALLOCATED(Db_IfW_Params_Buf))  DEALLOCATE(Db_IfW_Params_Buf)
  IF(ALLOCATED(Int_IfW_Params_Buf)) DEALLOCATE(Int_IfW_Params_Buf)
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, InData%DWM_Params, ErrStat, ErrMsg, .TRUE. ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Params_Buf  ) ! DWM_Params
  IF(ALLOCATED(Db_DWM_Params_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Params_Buf  ) ! DWM_Params
  IF(ALLOCATED(Int_DWM_Params_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Params_Buf ) ! DWM_Params
  IF(ALLOCATED(Re_DWM_Params_Buf))  DEALLOCATE(Re_DWM_Params_Buf)
  IF(ALLOCATED(Db_DWM_Params_Buf))  DEALLOCATE(Db_DWM_Params_Buf)
  IF(ALLOCATED(Int_DWM_Params_Buf)) DEALLOCATE(Int_DWM_Params_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%SIUnit ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Echo ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%MultiTab ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%LinearizeFlag ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%OutputPlottingInfo ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Initialized ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%UseDWM ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwoPiNB )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%ElemPrn ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DStall ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%PMoment ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Reynolds ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%DynInfl ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Wake ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%Swirl ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DtAero )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnEc )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnElem )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnWndOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXICOUNT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = TRANSFER( (InData%WrOptFile ), IntKiBuf(1), 1)
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DEFAULT_Wind )
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, OnlySize ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 ) = Re_TwrProps_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 ) = Db_TwrProps_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 ) = Int_TwrProps_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  IF( ALLOCATED(Re_TwrProps_Buf) )  DEALLOCATE(Re_TwrProps_Buf)
  IF( ALLOCATED(Db_TwrProps_Buf) )  DEALLOCATE(Db_TwrProps_Buf)
  IF( ALLOCATED(Int_TwrProps_Buf) ) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, OnlySize ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 ) = Re_IfW_Params_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 ) = Db_IfW_Params_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 ) = Int_IfW_Params_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Params_Buf) )  DEALLOCATE(Re_IfW_Params_Buf)
  IF( ALLOCATED(Db_IfW_Params_Buf) )  DEALLOCATE(Db_IfW_Params_Buf)
  IF( ALLOCATED(Int_IfW_Params_Buf) ) DEALLOCATE(Int_IfW_Params_Buf)
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, InData%DWM_Params, ErrStat, ErrMsg, OnlySize ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Params_Buf)-1 ) = Re_DWM_Params_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Params_Buf)-1 ) = Db_DWM_Params_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Params_Buf)-1 ) = Int_DWM_Params_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Params_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Params_Buf) )  DEALLOCATE(Re_DWM_Params_Buf)
  IF( ALLOCATED(Db_DWM_Params_Buf) )  DEALLOCATE(Db_DWM_Params_Buf)
  IF( ALLOCATED(Int_DWM_Params_Buf) ) DEALLOCATE(Int_DWM_Params_Buf)
 END SUBROUTINE AD_PackParam

 SUBROUTINE AD_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_ParameterType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Params_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Params_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Params_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Params_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TwoPiNB = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NBlInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DtAero = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UnEc = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnElem = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnWndOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%MAXICOUNT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DEFAULT_Wind = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packairfoilparms to get correctly sized buffers for unpacking
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbladeparms to get correctly sized buffers for unpacking
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg ) ! Blade 
 ! first call AD_Packbeddoesparms to get correctly sized buffers for unpacking
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflowparms to get correctly sized buffers for unpacking
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelementparms to get correctly sized buffers for unpacking
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packtwrpropsparms to get correctly sized buffers for unpacking
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    Re_TwrProps_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    Db_TwrProps_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    Int_TwrProps_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  CALL AD_UnPacktwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg ) ! TwrProps 
 ! first call AD_Packinducedvelparms to get correctly sized buffers for unpacking
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
 ! first call AD_Packwindparms to get correctly sized buffers for unpacking
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packrotorparms to get correctly sized buffers for unpacking
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call IfW_PackParam to get correctly sized buffers for unpacking
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    Re_IfW_Params_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    Db_IfW_Params_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    Int_IfW_Params_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  CALL IfW_UnPackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg ) ! IfW_Params 
 ! first call DWM_PackParam to get correctly sized buffers for unpacking
  CALL DWM_PackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, OutData%DWM_Params, ErrStat, ErrMsg, .TRUE. ) ! DWM_Params 
  IF(ALLOCATED(Re_DWM_Params_Buf)) THEN
    Re_DWM_Params_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Params_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Params_Buf)) THEN
    Db_DWM_Params_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Params_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Params_Buf)) THEN
    Int_DWM_Params_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Params_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Params_Buf)
  ENDIF
  CALL DWM_UnPackParam( Re_DWM_Params_Buf, Db_DWM_Params_Buf, Int_DWM_Params_Buf, OutData%DWM_Params, ErrStat, ErrMsg ) ! DWM_Params 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackParam

 SUBROUTINE AD_CopyInput( SrcInputData, DstInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_InputType), INTENT(INOUT) :: SrcInputData
   TYPE(AD_InputType), INTENT(INOUT) :: DstInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: i2, i2_l, i2_u  !  bounds (upper/lower) for an array dimension 2
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInputData%InputMarkers)) THEN
   i1_l = LBOUND(SrcInputData%InputMarkers,1)
   i1_u = UBOUND(SrcInputData%InputMarkers,1)
   IF (.NOT. ALLOCATED(DstInputData%InputMarkers)) THEN 
      ALLOCATE(DstInputData%InputMarkers(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%InputMarkers.', ErrStat, ErrMsg,'AD_CopyInput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputData%InputMarkers,1), UBOUND(SrcInputData%InputMarkers,1)
     CALL MeshCopy( SrcInputData%InputMarkers(i1), DstInputData%InputMarkers(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:InputMarkers(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcInputData%Twr_InputMarkers, DstInputData%Twr_InputMarkers, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL AD_Copyaeroconfig( SrcInputData%TurbineComponents, DstInputData%TurbineComponents, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyInput:TurbineComponents')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(SrcInputData%MulTabLoc)) THEN
   i1_l = LBOUND(SrcInputData%MulTabLoc,1)
   i1_u = UBOUND(SrcInputData%MulTabLoc,1)
   i2_l = LBOUND(SrcInputData%MulTabLoc,2)
   i2_u = UBOUND(SrcInputData%MulTabLoc,2)
   IF (.NOT. ALLOCATED(DstInputData%MulTabLoc)) THEN 
      ALLOCATE(DstInputData%MulTabLoc(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstInputData%MulTabLoc.', ErrStat, ErrMsg,'AD_CopyInput')
         RETURN
      END IF
   END IF
   DstInputData%MulTabLoc = SrcInputData%MulTabLoc
ENDIF
 END SUBROUTINE AD_CopyInput

 SUBROUTINE AD_DestroyInput( InputData, ErrStat, ErrMsg )
  TYPE(AD_InputType), INTENT(INOUT) :: InputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InputData%InputMarkers)) THEN
DO i1 = LBOUND(InputData%InputMarkers,1), UBOUND(InputData%InputMarkers,1)
  CALL MeshDestroy( InputData%InputMarkers(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputData%InputMarkers)
ENDIF
  CALL MeshDestroy( InputData%Twr_InputMarkers, ErrStat, ErrMsg )
  CALL AD_Destroyaeroconfig( InputData%TurbineComponents, ErrStat, ErrMsg )
IF (ALLOCATED(InputData%MulTabLoc)) THEN
   DEALLOCATE(InputData%MulTabLoc)
ENDIF
 END SUBROUTINE AD_DestroyInput

 SUBROUTINE AD_PackInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_InputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Db_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Int_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InputMarkers_Buf ) ! InputMarkers
  IF(ALLOCATED(Re_InputMarkers_Buf))  DEALLOCATE(Re_InputMarkers_Buf)
  IF(ALLOCATED(Db_InputMarkers_Buf))  DEALLOCATE(Db_InputMarkers_Buf)
  IF(ALLOCATED(Int_InputMarkers_Buf)) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_InputMarkers_Buf ) ! Twr_InputMarkers
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf))  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf))  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( ALLOCATED(InData%MulTabLoc) )   Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabLoc )  ! MulTabLoc 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 ) = Re_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 ) = Db_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 ) = Int_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 ) = Re_Twr_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 ) = Db_Twr_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 ) = Int_Twr_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( ALLOCATED(InData%MulTabLoc) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabLoc))-1 ) =  PACK(InData%MulTabLoc ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabLoc)
  ENDIF
 END SUBROUTINE AD_PackInput

 SUBROUTINE AD_UnPackInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_InputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%InputMarkers,1), UBOUND(OutData%InputMarkers,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    Re_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    Db_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    Int_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg ) ! InputMarkers 
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    Re_Twr_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    Db_Twr_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    Int_Twr_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg ) ! Twr_InputMarkers 
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
  IF ( ALLOCATED(OutData%MulTabLoc) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabLoc,1),SIZE(OutData%MulTabLoc,2)))
  mask2 = .TRUE.
    OutData%MulTabLoc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabLoc))-1 ),mask2,OutData%MulTabLoc)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabLoc)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInput

 SUBROUTINE AD_CopyOutput( SrcOutputData, DstOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_OutputType), INTENT(INOUT) :: SrcOutputData
   TYPE(AD_OutputType), INTENT(INOUT) :: DstOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,j,k
   INTEGER(IntKi)                 :: i1, i1_l, i1_u  !  bounds (upper/lower) for an array dimension 1
   INTEGER(IntKi)                 :: ErrStat2
   CHARACTER(1024)                :: ErrMsg2
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcOutputData%OutputLoads)) THEN
   i1_l = LBOUND(SrcOutputData%OutputLoads,1)
   i1_u = UBOUND(SrcOutputData%OutputLoads,1)
   IF (.NOT. ALLOCATED(DstOutputData%OutputLoads)) THEN 
      ALLOCATE(DstOutputData%OutputLoads(i1_l:i1_u),STAT=ErrStat2)
      IF (ErrStat2 /= 0) THEN 
         CALL SetErrStat(ErrID_Fatal, 'Error allocating DstOutputData%OutputLoads.', ErrStat, ErrMsg,'AD_CopyOutput')
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcOutputData%OutputLoads,1), UBOUND(SrcOutputData%OutputLoads,1)
     CALL MeshCopy( SrcOutputData%OutputLoads(i1), DstOutputData%OutputLoads(i1), CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:OutputLoads(i1)')
         IF (ErrStat>=AbortErrLev) RETURN
   ENDDO
ENDIF
     CALL MeshCopy( SrcOutputData%Twr_OutputLoads, DstOutputData%Twr_OutputLoads, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_CopyOutput( SrcOutputData%IfW_Outputs, DstOutputData%IfW_Outputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:IfW_Outputs')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_CopyOutput( SrcOutputData%DWM_Outputs, DstOutputData%DWM_Outputs, CtrlCode, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_CopyOutput:DWM_Outputs')
         IF (ErrStat>=AbortErrLev) RETURN
 END SUBROUTINE AD_CopyOutput

 SUBROUTINE AD_DestroyOutput( OutputData, ErrStat, ErrMsg )
  TYPE(AD_OutputType), INTENT(INOUT) :: OutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OutputData%OutputLoads)) THEN
DO i1 = LBOUND(OutputData%OutputLoads,1), UBOUND(OutputData%OutputLoads,1)
  CALL MeshDestroy( OutputData%OutputLoads(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(OutputData%OutputLoads)
ENDIF
  CALL MeshDestroy( OutputData%Twr_OutputLoads, ErrStat, ErrMsg )
  CALL IfW_DestroyOutput( OutputData%IfW_Outputs, ErrStat, ErrMsg )
  CALL DWM_DestroyOutput( OutputData%DWM_Outputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOutput

 SUBROUTINE AD_PackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_OutputType),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DWM_Outputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DWM_Outputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DWM_Outputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Db_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Int_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OutputLoads_Buf ) ! OutputLoads
  IF(ALLOCATED(Re_OutputLoads_Buf))  DEALLOCATE(Re_OutputLoads_Buf)
  IF(ALLOCATED(Db_OutputLoads_Buf))  DEALLOCATE(Db_OutputLoads_Buf)
  IF(ALLOCATED(Int_OutputLoads_Buf)) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_OutputLoads_Buf ) ! Twr_OutputLoads
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf))  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf))  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Int_IfW_Outputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Outputs_Buf ) ! IfW_Outputs
  IF(ALLOCATED(Re_IfW_Outputs_Buf))  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF(ALLOCATED(Db_IfW_Outputs_Buf))  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) DEALLOCATE(Int_IfW_Outputs_Buf)
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, InData%DWM_Outputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DWM_Outputs_Buf  ) ! DWM_Outputs
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DWM_Outputs_Buf  ) ! DWM_Outputs
  IF(ALLOCATED(Int_DWM_Outputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DWM_Outputs_Buf ) ! DWM_Outputs
  IF(ALLOCATED(Re_DWM_Outputs_Buf))  DEALLOCATE(Re_DWM_Outputs_Buf)
  IF(ALLOCATED(Db_DWM_Outputs_Buf))  DEALLOCATE(Db_DWM_Outputs_Buf)
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) DEALLOCATE(Int_DWM_Outputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 ) = Re_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 ) = Db_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 ) = Int_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 ) = Re_Twr_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 ) = Db_Twr_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 ) = Int_Twr_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 ) = Re_IfW_Outputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 ) = Db_IfW_Outputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 ) = Int_IfW_Outputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Outputs_Buf) )  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF( ALLOCATED(Db_IfW_Outputs_Buf) )  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF( ALLOCATED(Int_IfW_Outputs_Buf) ) DEALLOCATE(Int_IfW_Outputs_Buf)
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, InData%DWM_Outputs, ErrStat, ErrMsg, OnlySize ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Outputs_Buf)-1 ) = Re_DWM_Outputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Outputs_Buf)-1 ) = Db_DWM_Outputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Outputs_Buf)-1 ) = Int_DWM_Outputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Outputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_DWM_Outputs_Buf) )  DEALLOCATE(Re_DWM_Outputs_Buf)
  IF( ALLOCATED(Db_DWM_Outputs_Buf) )  DEALLOCATE(Db_DWM_Outputs_Buf)
  IF( ALLOCATED(Int_DWM_Outputs_Buf) ) DEALLOCATE(Int_DWM_Outputs_Buf)
 END SUBROUTINE AD_PackOutput

 SUBROUTINE AD_UnPackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_OutputType), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DWM_Outputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DWM_Outputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DWM_Outputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%OutputLoads,1), UBOUND(OutData%OutputLoads,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    Re_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    Db_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    Int_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg ) ! OutputLoads 
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    Re_Twr_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    Db_Twr_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    Int_Twr_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg ) ! Twr_OutputLoads 
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
 ! first call IfW_PackOutput to get correctly sized buffers for unpacking
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    Re_IfW_Outputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    Db_IfW_Outputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    Int_IfW_Outputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  CALL IfW_UnPackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg ) ! IfW_Outputs 
 ! first call DWM_PackOutput to get correctly sized buffers for unpacking
  CALL DWM_PackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, OutData%DWM_Outputs, ErrStat, ErrMsg, .TRUE. ) ! DWM_Outputs 
  IF(ALLOCATED(Re_DWM_Outputs_Buf)) THEN
    Re_DWM_Outputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DWM_Outputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_DWM_Outputs_Buf)) THEN
    Db_DWM_Outputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DWM_Outputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DWM_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_DWM_Outputs_Buf)) THEN
    Int_DWM_Outputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DWM_Outputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DWM_Outputs_Buf)
  ENDIF
  CALL DWM_UnPackOutput( Re_DWM_Outputs_Buf, Db_DWM_Outputs_Buf, Int_DWM_Outputs_Buf, OutData%DWM_Outputs, ErrStat, ErrMsg ) ! DWM_Outputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOutput


 SUBROUTINE AD_Input_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_inputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_inputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Input_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshCopy(u(1)%InputMarkers(i01), u_out%InputMarkers(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_InputMarkers, u_out%Twr_InputMarkers, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel
  ENDDO
END IF ! check if allocated
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  u_out%MulTabLoc = u(1)%MulTabLoc
END IF ! check if allocated
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp1(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position)/t(2)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation)/t(2)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = -(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position)/t(2)
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation)/t(2)
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel)/t(2)
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel)/t(2)
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position)/t(2)
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation)/t(2)
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position)/t(2)
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation)/t(2)
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel)/t(2)
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel)/t(2)
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position)/t(2)
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation)/t(2)
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel)/t(2)
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel)/t(2)
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = -(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position)/t(2)
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation)/t(2)
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel)/t(2)
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel)/t(2)
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position)/t(2)
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation)/t(2)
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel)/t(2)
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel)/t(2)
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position)/t(2)
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation)/t(2)
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel)/t(2)
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel)/t(2)
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength)/t(2)
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = -(u(1)%MulTabLoc - u(2)%MulTabLoc)/t(2)
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp2(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), u(3)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%InputMarkers(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, u(3)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Input_ExtrapInterp:%Twr_InputMarkers')
         IF (ErrStat>=AbortErrLev) RETURN
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Position + u(3)%TurbineComponents%Blade(i11)%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Position + t(3)*u(2)%TurbineComponents%Blade(i11)%Position - t(2)*u(3)%TurbineComponents%Blade(i11)%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Orientation + u(3)%TurbineComponents%Blade(i11)%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Orientation + t(3)*u(2)%TurbineComponents%Blade(i11)%Orientation - t(2)*u(3)%TurbineComponents%Blade(i11)%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%TranslationVel + u(3)%TurbineComponents%Blade(i11)%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%TranslationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%TranslationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%RotationVel + u(3)%TurbineComponents%Blade(i11)%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%RotationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%RotationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position) + t(2)**2*(-u(1)%TurbineComponents%Hub%Position + u(3)%TurbineComponents%Hub%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Position + t(3)*u(2)%TurbineComponents%Hub%Position - t(2)*u(3)%TurbineComponents%Hub%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Hub%Orientation + u(3)%TurbineComponents%Hub%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Orientation + t(3)*u(2)%TurbineComponents%Hub%Orientation - t(2)*u(3)%TurbineComponents%Hub%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%TranslationVel + u(3)%TurbineComponents%Hub%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%TranslationVel + t(3)*u(2)%TurbineComponents%Hub%TranslationVel - t(2)*u(3)%TurbineComponents%Hub%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%RotationVel + u(3)%TurbineComponents%Hub%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%RotationVel + t(3)*u(2)%TurbineComponents%Hub%RotationVel - t(2)*u(3)%TurbineComponents%Hub%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Position + u(3)%TurbineComponents%RotorFurl%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Position + t(3)*u(2)%TurbineComponents%RotorFurl%Position - t(2)*u(3)%TurbineComponents%RotorFurl%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Orientation + u(3)%TurbineComponents%RotorFurl%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Orientation + t(3)*u(2)%TurbineComponents%RotorFurl%Orientation - t(2)*u(3)%TurbineComponents%RotorFurl%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%TranslationVel + u(3)%TurbineComponents%RotorFurl%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%TranslationVel + t(3)*u(2)%TurbineComponents%RotorFurl%TranslationVel - t(2)*u(3)%TurbineComponents%RotorFurl%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%RotationVel + u(3)%TurbineComponents%RotorFurl%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%RotationVel + t(3)*u(2)%TurbineComponents%RotorFurl%RotationVel - t(2)*u(3)%TurbineComponents%RotorFurl%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Position + u(3)%TurbineComponents%Nacelle%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Position + t(3)*u(2)%TurbineComponents%Nacelle%Position - t(2)*u(3)%TurbineComponents%Nacelle%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Orientation + u(3)%TurbineComponents%Nacelle%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Orientation + t(3)*u(2)%TurbineComponents%Nacelle%Orientation - t(2)*u(3)%TurbineComponents%Nacelle%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%TranslationVel + u(3)%TurbineComponents%Nacelle%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%TranslationVel + t(3)*u(2)%TurbineComponents%Nacelle%TranslationVel - t(2)*u(3)%TurbineComponents%Nacelle%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%RotationVel + u(3)%TurbineComponents%Nacelle%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%RotationVel + t(3)*u(2)%TurbineComponents%Nacelle%RotationVel - t(2)*u(3)%TurbineComponents%Nacelle%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Position + u(3)%TurbineComponents%TailFin%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Position + t(3)*u(2)%TurbineComponents%TailFin%Position - t(2)*u(3)%TurbineComponents%TailFin%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Orientation + u(3)%TurbineComponents%TailFin%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Orientation + t(3)*u(2)%TurbineComponents%TailFin%Orientation - t(2)*u(3)%TurbineComponents%TailFin%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%TranslationVel + u(3)%TurbineComponents%TailFin%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%TranslationVel + t(3)*u(2)%TurbineComponents%TailFin%TranslationVel - t(2)*u(3)%TurbineComponents%TailFin%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%RotationVel + u(3)%TurbineComponents%TailFin%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%RotationVel + t(3)*u(2)%TurbineComponents%TailFin%RotationVel - t(2)*u(3)%TurbineComponents%TailFin%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position) + t(2)**2*(-u(1)%TurbineComponents%Tower%Position + u(3)%TurbineComponents%Tower%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Position + t(3)*u(2)%TurbineComponents%Tower%Position - t(2)*u(3)%TurbineComponents%Tower%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Tower%Orientation + u(3)%TurbineComponents%Tower%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Orientation + t(3)*u(2)%TurbineComponents%Tower%Orientation - t(2)*u(3)%TurbineComponents%Tower%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%TranslationVel + u(3)%TurbineComponents%Tower%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%TranslationVel + t(3)*u(2)%TurbineComponents%Tower%TranslationVel - t(2)*u(3)%TurbineComponents%Tower%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%RotationVel + u(3)%TurbineComponents%Tower%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%RotationVel + t(3)*u(2)%TurbineComponents%Tower%RotationVel - t(2)*u(3)%TurbineComponents%Tower%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Position + u(3)%TurbineComponents%SubStructure%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Position + t(3)*u(2)%TurbineComponents%SubStructure%Position - t(2)*u(3)%TurbineComponents%SubStructure%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Orientation + u(3)%TurbineComponents%SubStructure%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Orientation + t(3)*u(2)%TurbineComponents%SubStructure%Orientation - t(2)*u(3)%TurbineComponents%SubStructure%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%TranslationVel + u(3)%TurbineComponents%SubStructure%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%TranslationVel + t(3)*u(2)%TurbineComponents%SubStructure%TranslationVel - t(2)*u(3)%TurbineComponents%SubStructure%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%RotationVel + u(3)%TurbineComponents%SubStructure%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%RotationVel + t(3)*u(2)%TurbineComponents%SubStructure%RotationVel - t(2)*u(3)%TurbineComponents%SubStructure%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Position + u(3)%TurbineComponents%Foundation%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Position + t(3)*u(2)%TurbineComponents%Foundation%Position - t(2)*u(3)%TurbineComponents%Foundation%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Orientation + u(3)%TurbineComponents%Foundation%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Orientation + t(3)*u(2)%TurbineComponents%Foundation%Orientation - t(2)*u(3)%TurbineComponents%Foundation%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%TranslationVel + u(3)%TurbineComponents%Foundation%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%TranslationVel + t(3)*u(2)%TurbineComponents%Foundation%TranslationVel - t(2)*u(3)%TurbineComponents%Foundation%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%RotationVel + u(3)%TurbineComponents%Foundation%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%RotationVel + t(3)*u(2)%TurbineComponents%Foundation%RotationVel - t(2)*u(3)%TurbineComponents%Foundation%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength) + t(2)**2*(-u(1)%TurbineComponents%BladeLength + u(3)%TurbineComponents%BladeLength))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%TurbineComponents%BladeLength + t(3)*u(2)%TurbineComponents%BladeLength - t(2)*u(3)%TurbineComponents%BladeLength ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out + c0 * t_out**2
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = (t(3)**2*(u(1)%MulTabLoc - u(2)%MulTabLoc) + t(2)**2*(-u(1)%MulTabLoc + u(3)%MulTabLoc))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%MulTabLoc + t(3)*u(2)%MulTabLoc - t(2)*u(3)%MulTabLoc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Input_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Input_ExtrapInterp


 SUBROUTINE AD_Output_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_outputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_outputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 INTEGER(IntKi)                             :: ErrStat2 ! local errors
 CHARACTER(1024)                            :: ErrMsg2  ! local errors
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Output_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshCopy(u(1)%OutputLoads(i01), u_out%OutputLoads(i01), MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_OutputLoads, u_out%Twr_OutputLoads, MESH_UPDATECOPY, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp1(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp2(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), u(3)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%OutputLoads(i01)')
         IF (ErrStat>=AbortErrLev) RETURN
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, u(3)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp:%Twr_OutputLoads')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
      CALL DWM_Output_ExtrapInterp( u%DWM_Outputs, tin, u_out%DWM_Outputs, tin_out, ErrStat2, ErrMsg2 )
         CALL SetErrStat(ErrStat2, ErrMsg2, ErrStat, ErrMsg,'AD_Output_ExtrapInterp')
         IF (ErrStat>=AbortErrLev) RETURN
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Output_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Output_ExtrapInterp

END MODULE AeroDyn_Types
!ENDOFREGISTRYGENERATEDFILE
